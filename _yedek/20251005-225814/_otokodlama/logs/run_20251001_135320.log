**********************
Windows PowerShell transcript start
Start time: 20251001135320
Username: LAPTOP-BJ5VB4RI\HP
RunAs User: LAPTOP-BJ5VB4RI\HP
Configuration Name: 
Machine: LAPTOP-BJ5VB4RI (Microsoft Windows NT 10.0.19045.0)
Host Application: C:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell.exe -noe -c &{Import-Module "C:\Program Files (x86)\Microsoft Visual Studio\2019\BuildTools\Common7\Tools\Microsoft.VisualStudio.DevShell.dll"; Enter-VsDevShell b8aaed61}
Process ID: 27052
PSVersion: 5.1.19041.6328
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.6328
BuildVersion: 10.0.19041.6328
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
=== OTOKODLAMA PIPELINE ===
Repo : C:\dev\bakim_kalibrasyon
Backlog : ops\backlog.json
Tasks   : todolist\tasks_template.csv
BaseUrl : http://127.0.0.1:8010
(venv) TerminatingError(): "At C:\dev\bakim_kalibrasyon\ops\merge_visual_from_tasks.ps1:49 char:60
+     $type  = $r.PSObject.Properties.Name -contains 'type'  ? $r.type  ...
+                                                            ~
Unexpected token '?' in expression or statement.

At C:\dev\bakim_kalibrasyon\ops\merge_visual_from_tasks.ps1:50 char:60
+     $title = $r.PSObject.Properties.Name -contains 'title' ? $r.title ...
+                                                            ~
Unexpected token '?' in expression or statement."
At C:\dev\bakim_kalibrasyon\ops\merge_visual_from_tasks.ps1:49 char:60
+     $type  = $r.PSObject.Properties.Name -contains 'type'  ? $r.type  ...
+                                                            ~
Unexpected token '?' in expression or statement.

At C:\dev\bakim_kalibrasyon\ops\merge_visual_from_tasks.ps1:50 char:60
+     $title = $r.PSObject.Properties.Name -contains 'title' ? $r.title ...
+                                                            ~
Unexpected token '?' in expression or statement.
At C:\dev\bakim_kalibrasyon\ops\merge_visual_from_tasks.ps1:49 char:60
+     $type  = $r.PSObject.Properties.Name -contains 'type'  ? $r.type  ...
+                                                            ~
Unexpected token '?' in expression or statement.

At C:\dev\bakim_kalibrasyon\ops\merge_visual_from_tasks.ps1:50 char:60
+     $title = $r.PSObject.Properties.Name -contains 'title' ? $r.title ...
+                                                            ~
Unexpected token '?' in expression or statement.
    + CategoryInfo          : ParserError: (:) [], ParseException
    + FullyQualifiedErrorId : UnexpectedToken

PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # PS 5.1 uyumlu — tasks_template.csv içinden design_ref + visual_threshold alanlarını backlog'a merge eder
[CmdletBinding()]
param(
  [string]$Backlog  = "ops\backlog.json",
  [string]$TasksCsv = "todolist\tasks_template.csv",
  [switch]$Backup,
  [switch]$CreateMissing   # ID backlog'da yoksa basit stub ekler (istenirse)
)
$ErrorActionPreference = "Stop"

if (-not (Test-Path $Backlog)) { throw "Backlog yok: $Backlog" }
if (-not (Test-Path $TasksCsv)) { throw "CSV yok: $TasksCsv" }

# JSON'u oku (root veya root.items desteği)
$root = Get-Content $Backlog -Raw | ConvertFrom-Json
$hasItems = $false
$items = $root
if ($root -and ($root.PSObject.Properties.Name -contains 'items')) {
  $items = $root.items
  $hasItems = $true
}

function Normalize-Threshold([string]$raw) {
  if ([string]::IsNullOrWhiteSpace($raw)) { return $null }
  $t = $raw.Trim()
  if ($t.EndsWith("%")) { $t = $t.TrimEnd("%") }
  [double]$n = 0
  if (-not [double]::TryParse($t, [ref]$n)) { throw "Geçersiz visual_threshold: '$raw'" }
  if ($n -gt 1) { $n = $n / 100.0 }
  if ($n -lt 0 -or $n -gt 1) { throw "visual_threshold aralık dışı (0..1): $n" }
  [Math]::Round($n, 2)
}

$rows = Import-Csv -Path $TasksCsv
$changed = 0

foreach ($r in $rows) {
  # id kontrol
  $hasIdProp = $r.PSObject.Properties.Name -contains 'id'
  if (-not $hasIdProp) { Write-Warning "Satırda id yok, atlandı."; continue }
  $id = $r.id
  if (-not $id -or $id.Trim() -eq "") { Write-Warning "Satırda id boş, atlandı."; continue }

  # Backlog'da ara
  $item = $items | Where-Object { $_.id -eq $id } | Select-Object -First 1

  # Gerekirse stub ekle
  if (-not $item) {
    if (-not $CreateMissing) {
      Write-Warning "Backlog'da yok: $id (CreateMissing olmadan atlandı)"
      continue
    }
    $type = "screen"
    if ($r.PSObject.Properties.Name -contains 'type') {
      $tmp = $r.type
      if ($tmp) { $type = $tmp }
    }
    $title = $id
    if ($r.PSObject.Properties.Name -contains 'title') {
      $tmp = $r.title
      if ($tmp) { $title = $tmp }
    }
    $stub = [pscustomobject]@{
      id    = $id
      type  = $type
      title = $title
      url   = "/admin/login/"
    }
    if ($hasItems) {
      $list = New-Object System.Collections.ArrayList
      [void]$list.AddRange($items)
      [void]$list.Add($stub)
      $root.items = $list
      $items = $root.items
    } else {
      $list = New-Object System.Collections.ArrayList
      [void]$list.AddRange($items)
      [void]$list.Add($stub)
      $items = $list
      $root  = $items
    }
    $item = $stub
    Write-Host "[info] Stub eklendi: $id" -ForegroundColor Yellow
  }

  # CSV -> alanlar
  $refPath = $null
  if ($r.PSObject.Properties.Name -contains 'design_ref') {
    $refPath = $r.design_ref
  }

  $thr = $null
  if ($r.PSObject.Properties.Name -contains 'visual_threshold') {
    $thrRaw = $r.visual_threshold
    if ($thrRaw) { try { $thr = Normalize-Threshold $thrRaw } catch { throw "id=$id -> $_" } }
  }

  if ($refPath) {
    if (-not (Test-Path $refPath)) {
      Write-Warning "design_ref bulunamadı: $refPath (id=$id) — yine de yazılıyor."
    }
    $item | Add-Member -NotePropertyName design_ref -NotePropertyValue $refPath -Force
  }
  if ($thr -ne $null) {
    $item | Add-Member -NotePropertyName visual_threshold -NotePropertyValue $thr -Force
  }

  $changed++
  Write-Host "[ok] $id -> design_ref='${refPath}', visual_threshold=$thr" -ForegroundColor Green
}

if ($changed -gt 0) {
  if ($Backup) { Copy-Item $Backlog "$Backlog.bak" -Force }
  $json = $root | ConvertTo-Json -Depth 100
  # UTF-8 (BOM'suz) yaz
  [IO.File]::WriteAllText((Resolve-Path $Backlog), $json, (New-Object System.Text.UTF8Encoding($false)))
  Write-Host "[ok] backlog güncellendi: $Backlog ($changed item)" -ForegroundColor Green
} else {
  Write-Host "[info] CSV ile eşleşen değişiklik yok." -ForegroundColor Yellow
}

WARNING: design_ref bulunamadı: targets/reference/admin_login.png (id=login_smoke) — yine de yazılıyor.
[ok] login_smoke -> design_ref='targets/reference/admin_login.png', visual_threshold=0.85
WARNING: design_ref bulunamadı: targets/reference/equipment_list.png (id=equipment_ui) — yine de yazılıyor.
[ok] equipment_ui -> design_ref='targets/reference/equipment_list.png', visual_threshold=0.9
[ok] backlog güncellendi: ops\backlog.json (2 item)
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # repo kökünde
powershell -ExecutionPolicy Bypass -File ops\merge_visual_from_tasks.ps1 `
  -Backlog ops\backlog.json `
  -TasksCsv todolist\tasks_template.csv `
  -Backup

At C:\dev\bakim_kalibrasyon\ops\merge_visual_from_tasks.ps1:49 char:60
+     $type  = $r.PSObject.Properties.Name -contains 'type'  ? $r.type  ...
+                                                            ~
Unexpected token '?' in expression or statement.
At C:\dev\bakim_kalibrasyon\ops\merge_visual_from_tasks.ps1:50 char:60
+     $title = $r.PSObject.Properties.Name -contains 'title' ? $r.title ...
+                                                            ~
Unexpected token '?' in expression or statement.
    + CategoryInfo          : ParserError: (:) [], ParentContainsErrorRecordException
    + FullyQualifiedErrorId : UnexpectedToken
PS C:\dev\bakim_kalibrasyon>
(venv) cs
>> TerminatingError(): "The term 'cs' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again."
The term 'cs' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
cs : The term 'cs' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the
spelling of the name, or if a path was included, verify that the path is correct and try again.
At line:1 char:1
+ cs
+ ~~
    + CategoryInfo          : ObjectNotFound: (cs:String) [], ParentContainsErrorRecordException
    + FullyQualifiedErrorId : CommandNotFoundException

PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) powershell -ExecutionPolicy Bypass -File ops\gen_from_backlog.ps1
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "*" -BaseUrl "http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"

[gen] Flow üretimi tamam
==> Running: __make_baseline_admin_app_index.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_app_index.flow
--out _otokodlama\out\__make_baseline_admin_app_index.json
[PW-FLOW] PASSED
[guard] wrote: _otokodlama\out\__make_baseline_admin_app_index.json
[ok] __make_baseline_admin_app_index.flow
==> Running: __make_baseline_admin_equipment_add.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_add.f
low --out _otokodlama\out\__make_baseline_admin_equipment_add.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_add.json
[err] __make_baseline_admin_equipment_add.flow exit=1
The argument 'ops\report_console.ps1' to the -File parameter does not exist. Provide the path to an existing '.ps1' file
 as an argument to the -File parameter.
Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

Try the new cross-platform PowerShell https://aka.ms/pscore6
PS C:\dev\bakim_kalibrasyon>
(venv) cs
>> TerminatingError(): "The term 'cs' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again."
The term 'cs' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
cs : The term 'cs' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the
spelling of the name, or if a path was included, verify that the path is correct and try again.
At line:1 char:1
+ cs
+ ~~
    + CategoryInfo          : ObjectNotFound: (cs:String) [], ParentContainsErrorRecordException
    + FullyQualifiedErrorId : CommandNotFoundException

PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # PS 5.1 uyumlu — tasks_template.csv içinden design_ref + visual_threshold alanlarını backlog'a merge eder
[CmdletBinding()]
param(
  [string]$Backlog  = "ops\backlog.json",
  [string]$TasksCsv = "todolist\tasks_template.csv",
  [switch]$Backup,
  [switch]$CreateMissing   # ID backlog'da yoksa basit stub ekler (istenirse)
)
$ErrorActionPreference = "Stop"

if (-not (Test-Path $Backlog)) { throw "Backlog yok: $Backlog" }
if (-not (Test-Path $TasksCsv)) { throw "CSV yok: $TasksCsv" }

# JSON'u oku (root veya root.items desteği)
$root = Get-Content $Backlog -Raw | ConvertFrom-Json
$hasItems = $false
$items = $root
if ($root -and ($root.PSObject.Properties.Name -contains 'items')) {
  $items = $root.items
  $hasItems = $true
}

function Normalize-Threshold([string]$raw) {
  if ([string]::IsNullOrWhiteSpace($raw)) { return $null }
  $t = $raw.Trim()
  if ($t.EndsWith("%")) { $t = $t.TrimEnd("%") }
  [double]$n = 0
  if (-not [double]::TryParse($t, [ref]$n)) { throw "Geçersiz visual_threshold: '$raw'" }
  if ($n -gt 1) { $n = $n / 100.0 }
  if ($n -lt 0 -or $n -gt 1) { throw "visual_threshold aralık dışı (0..1): $n" }
  [Math]::Round($n, 2)
}

$rows = Import-Csv -Path $TasksCsv
$changed = 0

foreach ($r in $rows) {
  # id kontrol
  $hasIdProp = $r.PSObject.Properties.Name -contains 'id'
  if (-not $hasIdProp) { Write-Warning "Satırda id yok, atlandı."; continue }
  $id = $r.id
  if (-not $id -or $id.Trim() -eq "") { Write-Warning "Satırda id boş, atlandı."; continue }

  # Backlog'da ara
  $item = $items | Where-Object { $_.id -eq $id } | Select-Object -First 1

  # Gerekirse stub ekle
  if (-not $item) {
    if (-not $CreateMissing) {
      Write-Warning "Backlog'da yok: $id (CreateMissing olmadan atlandı)"
      continue
    }

    # type/title güvenli okuma (ternary YOK)
    $type = "screen"
    if ($r.PSObject.Properties.Name -contains 'type') {
      if ($r.type) { $type = $r.type }
    }
    $title = $id
    if ($r.PSObject.Properties.Name -contains 'title') {
      if ($r.title) { $title = $r.title }
    }

    $stub = [pscustomobject]@{
      id    = $id
      type  = $type
      title = $title
      url   = "/admin/login/"
    }

    if ($hasItems) {
      $list = New-Object System.Collections.ArrayList
      [void]$list.AddRange($items)
      [void]$list.Add($stub)
      $root.items = $list
      $items = $root.items
    } else {
      $list = New-Object System.Collections.ArrayList
      [void]$list.AddRange($items)
      [void]$list.Add($stub)
      $items = $list
      $root  = $items
    }

    $item = $stub
    Write-Host "[info] Stub eklendi: $id" -ForegroundColor Yellow
  }

  # CSV -> alanlar
  $refPath = $null
  if ($r.PSObject.Properties.Name -contains 'design_ref') {
    $refPath = $r.design_ref
  }

  $thr = $null
  if ($r.PSObject.Properties.Name -contains 'visual_threshold') {
    $thrRaw = $r.visual_threshold
    if ($thrRaw) { try { $thr = Normalize-Threshold $thrRaw } catch { throw "id=$id -> $_" } }
  }

  if ($refPath) {
    if (-not (Test-Path $refPath)) {
      Write-Warning "design_ref bulunamadı: $refPath (id=$id) — yine de yazılıyor."
    }
    $item | Add-Member -NotePropertyName design_ref -NotePropertyValue $refPath -Force
  }
  if ($thr -ne $null) {
    $item | Add-Member -NotePropertyName visual_threshold -NotePropertyValue $thr -Force
  }

  $changed++
  Write-Host "[ok] $id -> design_ref='${refPath}', visual_threshold=$thr" -ForegroundColor Green
}

if ($changed -gt 0) {
  if ($Backup) { Copy-Item $Backlog "$Backlog.bak" -Force }
  $json = $root | ConvertTo-Json -Depth 100
  # UTF-8 (BOM'suz) yaz
  [IO.File]::WriteAllText((Resolve-Path $Backlog), $json, (New-Object System.Text.UTF8Encoding($false)))
  Write-Host "[ok] backlog güncellendi: $Backlog ($changed item)" -ForegroundColor Green
} else {
  Write-Host "[info] CSV ile eşleşen değişiklik yok." -ForegroundColor Yellow
}

WARNING: design_ref bulunamadı: targets/reference/admin_login.png (id=login_smoke) — yine de yazılıyor.
[ok] login_smoke -> design_ref='targets/reference/admin_login.png', visual_threshold=0.85
WARNING: design_ref bulunamadı: targets/reference/equipment_list.png (id=equipment_ui) — yine de yazılıyor.
[ok] equipment_ui -> design_ref='targets/reference/equipment_list.png', visual_threshold=0.9
[ok] backlog güncellendi: ops\backlog.json (2 item)
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # PS 5.1 — _otokodlama\out altındaki *.json sonuçları özetler
[CmdletBinding()]
param(
  [string]$OutDir = "_otokodlama\out"
)
$ErrorActionPreference = "Stop"
if (-not (Test-Path $OutDir)) { throw "OutDir yok: $OutDir" }

$files = Get-ChildItem -Path $OutDir -Filter *.json -File | Sort-Object Name
$okCount=0; $failCount=0; $errCount=0

Write-Host ""
Write-Host "==================== PIPELINE ÖZET RAPORU ====================" -ForegroundColor Cyan
Write-Host ("Dosya".PadRight(42) + "Sonuç   Detay")
Write-Host "--------------------------------------------------------------" -ForegroundColor DarkGray

foreach ($f in $files) {
  $status="ERROR"; $detail=""
  try {
    $j = Get-Content $f.FullName -Raw | ConvertFrom-Json
    if ($j.ok -eq $true) {
      $status = "PASS"; $okCount++
    } else {
      $status = "FAIL"; $failCount++
      if ($j.results) {
        $bad = $j.results | Where-Object { -not $_.ok } | Select-Object -First 1
        if ($bad) {
          $detail = ($bad.error -replace "\r?\n"," ") 
          if ($detail.Length -gt 80) { $detail = $detail.Substring(0,80) + "..." }
        }
      }
    }
  } catch {
    $status = "ERROR"; $errCount++
    $detail = $_.Exception.Message
  }

  $namePad = $f.Name.PadRight(42)
  if ($status -eq "PASS") {
    Write-Host ("{0}  {1}    {2}" -f $namePad, $status.PadRight(5), $detail) -ForegroundColor Green
  } elseif ($status -eq "FAIL") {
    Write-Host ("{0}  {1}    {2}" -f $namePad, $status.PadRight(5), $detail) -ForegroundColor Red
  } else {
    Write-Host ("{0}  {1}    {2}" -f $namePad, $status.PadRight(5), $detail) -ForegroundColor Yellow
  }
}

Write-Host "--------------------------------------------------------------" -ForegroundColor DarkGray
Write-Host ("PASS: {0}   FAIL: {1}   ERROR: {2}" -f $okCount,$failCount,$errCount) -ForegroundColor Cyan
Write-Host "==============================================================" -ForegroundColor Cyan
Write-Host ""


==================== PIPELINE ÖZET RAPORU ====================
Dosya                                     Sonuç   Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Call log:   - wa...
__make_baseline_admin_equipment_change.json  FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Call log:   - wa...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has been closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     Error: navigation-error
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 12   FAIL: 4   ERROR: 0
==============================================================

PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # PS 5.1 — equipment baselines + validate için hızlı düzeltme
[CmdletBinding()]
param([string]$FlowsDir="ops\flows")
$ErrorActionPreference="Stop"

function Prepend-IfMissing([string]$path, [string]$needle, [string]$block) {
  if (-not (Test-Path $path)) { return }
  $txt = Get-Content -LiteralPath $path -Raw
  if ($txt -like ('*'+$needle+'*')) { return }
  $new = $block + "`r`n" + $txt
  Set-Content -LiteralPath $path -Value $new -Encoding ASCII
  Write-Host "[ok] patched: $([IO.Path]::GetFileName($path))" -ForegroundColor Green
}

$login = @(
  'GOTO  /admin/login/',
  'WAIT  SELECTOR input[name=username]',
  'FILL  input[name=username]  admin',
  'FILL  input[name=password]  Admin!2345',
  'CLICK input[type=submit]',
  'WAIT  SELECTOR #content-main'
) -join "`r`n"

$addNav    = "GOTO  /admin/maintenance/equipment/add/`r`nWAIT  SELECTOR form"
$listNav   = "GOTO  /admin/maintenance/equipment/`r`nWAIT  SELECTOR table#result_list"

$addFlow = Join-Path $FlowsDir "__make_baseline_admin_equipment_add.flow"
$chgFlow = Join-Path $FlowsDir "__make_baseline_admin_equipment_change.flow"

Prepend-IfMissing $addFlow "/admin/maintenance/equipment/add/" ($login + "`r`n" + $addNav)
Prepend-IfMissing $chgFlow "/admin/maintenance/equipment/"     ($login + "`r`n" + $listNav)

# Validate akışını net ve sade yaz
$validate = Join-Path $FlowsDir "equipment_ui_create_validate.flow"
if (Test-Path $validate) {
  $lines = @()
  $lines += 'GOTO  /admin/login/?next=/admin/maintenance/equipment/'
  $lines += 'WAIT  SELECTOR input[name=username]'
  $lines += 'FILL  input[name=username]  admin'
  $lines += 'FILL  input[name=password]  Admin!2345'
  $lines += 'CLICK input[type=submit]'
  $lines += 'WAIT  SELECTOR table#result_list'
  $lines += 'WAIT  SELECTOR table#result_list tbody tr'
  Set-Content -LiteralPath $validate -Value ($lines -join "`r`n") -Encoding ASCII
  Write-Host "[ok] rewrote: equipment_ui_create_validate.flow" -ForegroundColor Green
}

Write-Host "[done] quick fixes applied." -ForegroundColor Cyan

[ok] rewrote: equipment_ui_create_validate.flow
[done] quick fixes applied.
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # 1) Flow üret
powershell -ExecutionPolicy Bypass -File ops\gen_from_backlog.ps1

# 2) Hızlı düzeltmeleri uygula
powershell -ExecutionPolicy Bypass -File ops\quick_fix_failures.ps1

# 3) Koş ve özet al
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "*" -BaseUrl "http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"

[gen] Flow üretimi tamam
The argument 'ops\quick_fix_failures.ps1' to the -File parameter does not exist. Provide the path to an existing '.ps1'
file as an argument to the -File parameter.
Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

Try the new cross-platform PowerShell https://aka.ms/pscore6
==> Running: __make_baseline_admin_app_index.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_app_index.flow
--out _otokodlama\out\__make_baseline_admin_app_index.json
[PW-FLOW] PASSED
[guard] wrote: _otokodlama\out\__make_baseline_admin_app_index.json
[ok] __make_baseline_admin_app_index.flow
==> Running: __make_baseline_admin_equipment_add.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_add.f
low --out _otokodlama\out\__make_baseline_admin_equipment_add.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_add.json
[err] __make_baseline_admin_equipment_add.flow exit=1
The argument 'ops\report_console.ps1' to the -File parameter does not exist. Provide the path to an existing '.ps1' file
 as an argument to the -File parameter.
Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

Try the new cross-platform PowerShell https://aka.ms/pscore6
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # === write: ops\quick_fix_failures.ps1 (PS 5.1) ===
$code = @'
[CmdletBinding()]
param([string]$FlowsDir="ops\flows")
$ErrorActionPreference="Stop"

function Prepend-IfMissing([string]$path, [string]$needle, [string]$block) {
  if (-not (Test-Path $path)) { return }
  $txt = Get-Content -LiteralPath $path -Raw
  if ($txt -like ('*'+$needle+'*')) { return }
  $new = $block + "`r`n" + $txt
  Set-Content -LiteralPath $path -Value $new -Encoding ASCII
  Write-Host "[ok] patched: $([IO.Path]::GetFileName($path))" -ForegroundColor Green
}

# Ortak login
$login = @(
  'GOTO  /admin/login/',
  'WAIT  SELECTOR input[name=username]',
  'FILL  input[name=username]  admin',
  'FILL  input[name=password]  Admin!2345',
  'CLICK input[type=submit]',
  'WAIT  SELECTOR #content-main'
) -join "`r`n"

# Hedef header’lar
$addNav  = "GOTO  /admin/maintenance/equipment/add/`r`nWAIT  SELECTOR form"
$listNav = "GOTO  /admin/maintenance/equipment/`r`nWAIT  SELECTOR table#result_list"

$addFlow = Join-Path $FlowsDir "__make_baseline_admin_equipment_add.flow"
$chgFlow = Join-Path $FlowsDir "__make_baseline_admin_equipment_change.flow"

Prepend-IfMissing $addFlow "/admin/maintenance/equipment/add/" ($login + "`r`n" + $addNav)
Prepend-IfMissing $chgFlow "/admin/maintenance/equipment/"     ($login + "`r`n" + $listNav)

# Validate akışını net yaz (liste sayfasını doğrula)
$validate = Join-Path $FlowsDir "equipment_ui_create_validate.flow"
if (Test-Path $validate) {
  $lines = @()
  $lines += 'GOTO  /admin/login/?next=/admin/maintenance/equipment/'
  $lines += 'WAIT  SELECTOR input[name=username]'
  $lines += 'FILL  input[name=username]  admin'
  $lines += 'FILL  input[name=password]  Admin!2345'
  $lines += 'CLICK input[type=submit]'
  $lines += 'WAIT  SELECTOR table#result_list'
  $lines += 'WAIT  SELECTOR table#result_list tbody tr'
  Set-Content -LiteralPath $validate -Value ($lines -join "`r`n") -Encoding ASCII
  Write-Host "[ok] rewrote: equipment_ui_create_validate.flow" -ForegroundColor Green
}

Write-Host "[done] quick fixes applied." -ForegroundColor Cyan
'@
Set-Content -Path ops\quick_fix_failures.ps1 -Value $code -Encoding ASCII
Write-Host "[ok] wrote ops\quick_fix_failures.ps1" -ForegroundColor Green

[ok] wrote ops\quick_fix_failures.ps1
PS C:\dev\bakim_kalibrasyon>
(venv) # === write: ops\report_console.ps1 (PS 5.1) ===
$code = @'
[CmdletBinding()]
param([string]$OutDir="_otokodlama\out")
$ErrorActionPreference="Stop"

if (-not (Test-Path $OutDir)) { throw "Out dir yok: $OutDir" }
$files = Get-ChildItem -Path $OutDir -Filter *.json -File | Sort-Object Name
if (-not $files) { Write-Host "[info] JSON sonuç dosyası yok: $OutDir" -ForegroundColor Yellow; exit 0 }

Write-Host ""
Write-Host "==================== PIPELINE ÖZET RAPORU ====================" -ForegroundColor Cyan
Write-Host ("{0,-42}  {1,-5}    {2}" -f "Dosya","Sonuç","Detay") -ForegroundColor Gray
Write-Host "--------------------------------------------------------------" -ForegroundColor DarkGray

$okCount=0; $failCount=0; $errCount=0

foreach ($f in $files) {
  try {
    $j = Get-Content -LiteralPath $f.FullName -Raw | ConvertFrom-Json
    $status = "PASS"
    $detail = ""

    if ($j -and $j.PSObject.Properties.Name -contains 'ok') {
      if (-not $j.ok) { $status = "FAIL" }
    } elseif ($j -and $j.PSObject.Properties.Name -contains 'results') {
      $bad = $j.results | Where-Object { $_.ok -ne $true } | Select-Object -First 1
      if ($bad) { $status = "FAIL"; $detail = $bad.error }
    } else {
      $status = "ERROR"
      $detail = "Beklenmedik JSON formatı"
    }

    if ($status -eq "FAIL" -and -not $detail) {
      $bad2 = $j.results | Where-Object { $_.error } | Select-Object -First 1
      if ($bad2) { $detail = $bad2.error }
    }

    if ($detail) {
      $detail = $detail -replace "`r?`n"," "
      if ($detail.Length -gt 80) { $detail = $detail.Substring(0,80) + "..." }
    }

    $namePad = $f.Name.PadRight(42)
    if ($status -eq "PASS") { $okCount++ ; Write-Host ("{0}  {1}    {2}" -f $namePad, $status.PadRight(5), $detail) -ForegroundColor Green }
    elseif ($status -eq "FAIL") { $failCount++; Write-Host ("{0}  {1}    {2}" -f $namePad, $status.PadRight(5), $detail) -ForegroundColor Red }
    else { $errCount++; Write-Host ("{0}  {1}    {2}" -f $namePad, $status.PadRight(5), $detail) -ForegroundColor Yellow }
  }
  catch {
    $errCount++
    $namePad = $f.Name.PadRight(42)
    Write-Host ("{0}  {1}    {2}" -f $namePad, "ERROR".PadRight(5), $_.Exception.Message) -ForegroundColor Yellow
  }
}

Write-Host "--------------------------------------------------------------" -ForegroundColor DarkGray
Write-Host ("PASS: {0}   FAIL: {1}   ERROR: {2}" -f $okCount,$failCount,$errCount) -ForegroundColor Cyan
Write-Host "==============================================================" -ForegroundColor Cyan
Write-Host ""
'@
Set-Content -Path ops\report_console.ps1 -Value $code -Encoding ASCII
Write-Host "[ok] wrote ops\report_console.ps1" -ForegroundColor Green

[ok] wrote ops\report_console.ps1
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # 1) Flow üret
powershell -ExecutionPolicy Bypass -File ops\gen_from_backlog.ps1

# 2) Hızlı düzeltmeleri uygula (az önce yazdığımız dosya)
powershell -ExecutionPolicy Bypass -File ops\quick_fix_failures.ps1

# 3) Koş
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "*" -BaseUrl "http://127.0.0.1:8010"

# 4) Konsol özeti
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"

[gen] Flow üretimi tamam
[ok] rewrote: equipment_ui_create_validate.flow
[done] quick fixes applied.
==> Running: __make_baseline_admin_app_index.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_app_index.flow
--out _otokodlama\out\__make_baseline_admin_app_index.json
[PW-FLOW] PASSED
[guard] wrote: _otokodlama\out\__make_baseline_admin_app_index.json
[ok] __make_baseline_admin_app_index.flow
==> Running: __make_baseline_admin_equipment_add.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_add.f
low --out _otokodlama\out\__make_baseline_admin_equipment_add.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_add.json
[err] __make_baseline_admin_equipment_add.flow exit=1

==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Cal
l log:   - wa...
__make_baseline_admin_equipment_change.json  FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Ca
ll log:   - wa...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     Error: navigation-error
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 12   FAIL: 4   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # === write: ops\patch_admin_equipment_baselines.ps1 (PS 5.1) ===
[CmdletBinding()]
param(
  [string]$FlowsDir = "ops\flows",
  [string]$User = "admin",
  [string]$Pass = "Admin!2345"
)
$ErrorActionPreference = "Stop"

function Read-Text([string]$p){ Get-Content -LiteralPath $p -Raw }
function Write-Text([string]$p,[string]$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }
function Strip-Lines([string]$txt,[string]$pat){
  [regex]::Replace($txt,$pat,"",[System.Text.RegularExpressions.RegexOptions]::Multiline)
}
function Prepend([string]$txt,[string]$block){ $block + "`r`n" + $txt }

# Sağlam login bloğu
$login  = "GOTO  /admin/login/`r`n"
$login += "WAIT  SELECTOR input[name=username]`r`n"
$login += ("FILL  input[name=username]  {0}`r`n" -f $User)
$login += ("FILL  input[name=password]  {0}`r`n" -f $Pass)
$login += "CLICK input[type=submit]`r`n"
$login += "WAIT  SELECTOR #content-main"

# Hedef dosyalar
$addFlow = Join-Path $FlowsDir "__make_baseline_admin_equipment_add.flow"
$chgFlow = Join-Path $FlowsDir "__make_baseline_admin_equipment_change.flow"
$dbgFlow = Join-Path $FlowsDir "debug_equipment_change.flow"
$valFlow = Join-Path $FlowsDir "equipment_ui_create_validate.flow"

# Ortak temizleyici: eski login/unsupported/yanlış URL bekleri
function Clean-Body([string]$body){
  $b = $body
  $b = Strip-Lines $b '^\s*GOTO\s+/admin/login/.*\r?$'
  $b = Strip-Lines $b '^\s*FILL\s+input\[name=username\].*\r?$'
  $b = Strip-Lines $b '^\s*FILL\s+input\[name=password\].*\r?$'
  $b = Strip-Lines $b '^\s*CLICK\s+input\[type=submit\].*\r?$'
  $b = Strip-Lines $b '^\s*WAIT\s+SELECTOR-OR[^\r\n]*\r?$'
  $b = Strip-Lines $b '^\s*WAIT\s+URL\s+CONTAINS[^\r\n]*\r?$'
  $b
}

# 1) ADD baseline: add formunu bekle (tablo değil)
if (Test-Path $addFlow) {
  $t = Read-Text $addFlow
  $t = Clean-Body $t
  # Başlık
  $hdr  = $login + "`r`n"
  $hdr += "GOTO  /admin/maintenance/equipment/add/`r`n"
  $hdr += "WAIT  SELECTOR form"
  # ADD akışlarında yanlış beklemeyi düzelt
  $t = [regex]::Replace($t,'(?m)^\s*WAIT\s+SELECTOR\s+table#result_list\s*$','WAIT  SELECTOR form')
  $t = Prepend $t $hdr
  Write-Text $addFlow $t
  Write-Host "[ok] patched: $(Split-Path $addFlow -Leaf)" -ForegroundColor Green
}

# 2) CHANGE baseline: liste tablosunu bekle
if (Test-Path $chgFlow) {
  $t = Read-Text $chgFlow
  $t = Clean-Body $t
  $hdr  = $login + "`r`n"
  $hdr += "GOTO  /admin/maintenance/equipment/`r`n"
  $hdr += "WAIT  SELECTOR #content-main`r`n"
  $hdr += "WAIT  SELECTOR table#result_list"
  $t = Prepend $t $hdr
  Write-Text $chgFlow $t
  Write-Host "[ok] patched: $(Split-Path $chgFlow -Leaf)" -ForegroundColor Green
}

# 3) DEBUG flow (varsa): CHANGE ile aynı giriş
if (Test-Path $dbgFlow) {
  $t = Read-Text $dbgFlow
  $t = Clean-Body $t
  $hdr  = $login + "`r`n"
  $hdr += "GOTO  /admin/maintenance/equipment/`r`n"
  $hdr += "WAIT  SELECTOR #content-main`r`n"
  $hdr += "WAIT  SELECTOR table#result_list"
  $t = Prepend $t $hdr
  Write-Text $dbgFlow $t
  Write-Host "[ok] patched: $(Split-Path $dbgFlow -Leaf)" -ForegroundColor Green
}

# 4) VALIDATE flow’u sade ve sağlam yaz
if (Test-Path $valFlow) {
  $lines = @()
  $lines += 'GOTO  /admin/login/?next=/admin/maintenance/equipment/'
  $lines += 'WAIT  SELECTOR input[name=username]'
  $lines += ("FILL  input[name=username]  {0}" -f $User)
  $lines += ("FILL  input[name=password]  {0}" -f $Pass)
  $lines += 'CLICK input[type=submit]'
  $lines += 'WAIT  SELECTOR #content-main'
  $lines += 'WAIT  SELECTOR table#result_list'
  $lines += 'WAIT  SELECTOR table#result_list tbody tr'
  Write-Text $valFlow ($lines -join "`r`n")
  Write-Host "[ok] rewrote: $(Split-Path $valFlow -Leaf)" -ForegroundColor Green
}

Write-Host "[done] admin equipment baselineleri stabilize edildi." -ForegroundColor Cyan

[ok] patched: __make_baseline_admin_equipment_add.flow
[ok] patched: __make_baseline_admin_equipment_change.flow
[ok] rewrote: equipment_ui_create_validate.flow
[done] admin equipment baselineleri stabilize edildi.
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # 0) (Gerekirse) server: python manage.py runserver 127.0.0.1:8010 --settings=core.settings_maintenance --noreload

# 1) Flow üret
powershell -ExecutionPolicy Bypass -File ops\gen_from_backlog.ps1

# 2) Patch uygula
powershell -ExecutionPolicy Bypass -File ops\patch_admin_equipment_baselines.ps1

# 3) Sadece ilgili akışları koş
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_*;equipment_ui_create_validate*;debug_equipment_change*" -BaseUrl "http://127.0.0.1:8010"

# 4) Özet rapor
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"

[gen] Flow üretimi tamam
The argument 'ops\patch_admin_equipment_baselines.ps1' to the -File parameter does not exist. Provide the path to an exi
sting '.ps1' file as an argument to the -File parameter.
Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

Try the new cross-platform PowerShell https://aka.ms/pscore6
[warn] No matching flows for filter: __make_baseline_admin_equipment_*;equipment_ui_create_validate*;debug_equipment_cha
nge*

==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Cal
l log:   - wa...
__make_baseline_admin_equipment_change.json  FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Ca
ll log:   - wa...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     Error: navigation-error
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 12   FAIL: 4   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # === write: ops\patch_admin_equipment_baselines.ps1 (PS 5.1) ===
[CmdletBinding()]
param(
  [string]$FlowsDir = "ops\flows",
  [string]$User = "admin",
  [string]$Pass = "Admin!2345"
)
$ErrorActionPreference = "Stop"

function Read-Text([string]$p){ Get-Content -LiteralPath $p -Raw }
function Write-Text([string]$p,[string]$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }
function Strip-Lines([string]$txt,[string]$pat){
  [regex]::Replace($txt,$pat,"",[System.Text.RegularExpressions.RegexOptions]::Multiline)
}
function Prepend([string]$txt,[string]$block){ $block + "`r`n" + $txt }

# Sağlam login bloğu
$login  = "GOTO  /admin/login/`r`n"
$login += "WAIT  SELECTOR input[name=username]`r`n"
$login += ("FILL  input[name=username]  {0}`r`n" -f $User)
$login += ("FILL  input[name=password]  {0}`r`n" -f $Pass)
$login += "CLICK input[type=submit]`r`n"
$login += "WAIT  SELECTOR #content-main"

# Hedef dosyalar
$addFlow = Join-Path $FlowsDir "__make_baseline_admin_equipment_add.flow"
$chgFlow = Join-Path $FlowsDir "__make_baseline_admin_equipment_change.flow"
$dbgFlow = Join-Path $FlowsDir "debug_equipment_change.flow"
$valFlow = Join-Path $FlowsDir "equipment_ui_create_validate.flow"

# Ortak temizleyici
function Clean-Body([string]$body){
  $b = $body
  $b = Strip-Lines $b '^\s*GOTO\s+/admin/login/.*\r?$'
  $b = Strip-Lines $b '^\s*FILL\s+input\[name=username\].*\r?$'
  $b = Strip-Lines $b '^\s*FILL\s+input\[name=password\].*\r?$'
  $b = Strip-Lines $b '^\s*CLICK\s+input\[type=submit\].*\r?$'
  $b = Strip-Lines $b '^\s*WAIT\s+SELECTOR-OR[^\r\n]*\r?$'
  $b = Strip-Lines $b '^\s*WAIT\s+URL\s+CONTAINS[^\r\n]*\r?$'
  $b
}

# 1) ADD baseline: add formunu bekle
if (Test-Path $addFlow) {
  $t = Read-Text $addFlow
  $t = Clean-Body $t
  $hdr  = $login + "`r`n"
  $hdr += "GOTO  /admin/maintenance/equipment/add/`r`n"
  $hdr += "WAIT  SELECTOR form"
  # yanlış tablo bekleyen satırı form ile değiştir
  $t = [regex]::Replace($t,'(?m)^\s*WAIT\s+SELECTOR\s+table#result_list\s*$','WAIT  SELECTOR form')
  $t = Prepend $t $hdr
  Write-Text $addFlow $t
  Write-Host "[ok] patched: $(Split-Path $addFlow -Leaf)" -ForegroundColor Green
}

# 2) CHANGE baseline: liste tablosunu bekle
if (Test-Path $chgFlow) {
  $t = Read-Text $chgFlow
  $t = Clean-Body $t
  $hdr  = $login + "`r`n"
  $hdr += "GOTO  /admin/maintenance/equipment/`r`n"
  $hdr += "WAIT  SELECTOR #content-main`r`n"
  $hdr += "WAIT  SELECTOR table#result_list"
  $t = Prepend $t $hdr
  Write-Text $chgFlow $t
  Write-Host "[ok] patched: $(Split-Path $chgFlow -Leaf)" -ForegroundColor Green
}

# 3) DEBUG flow: CHANGE ile aynı giriş
if (Test-Path $dbgFlow) {
  $t = Read-Text $dbgFlow
  $t = Clean-Body $t
  $hdr  = $login + "`r`n"
  $hdr += "GOTO  /admin/maintenance/equipment/`r`n"
  $hdr += "WAIT  SELECTOR #content-main`r`n"
  $hdr += "WAIT  SELECTOR table#result_list"
  $t = Prepend $t $hdr
  Write-Text $dbgFlow $t
  Write-Host "[ok] patched: $(Split-Path $dbgFlow -Leaf)" -ForegroundColor Green
}

# 4) VALIDATE: sade ve sağlam
if (Test-Path $valFlow) {
  $lines = @()
  $lines += 'GOTO  /admin/login/?next=/admin/maintenance/equipment/'
  $lines += 'WAIT  SELECTOR input[name=username]'
  $lines += ("FILL  input[name=username]  {0}" -f $User)
  $lines += ("FILL  input[name=password]  {0}" -f $Pass)
  $lines += 'CLICK input[type=submit]'
  $lines += 'WAIT  SELECTOR #content-main'
  $lines += 'WAIT  SELECTOR table#result_list'
  $lines += 'WAIT  SELECTOR table#result_list tbody tr'
  Write-Text $valFlow ($lines -join "`r`n")
  Write-Host "[ok] rewrote: $(Split-Path $valFlow -Leaf)" -ForegroundColor Green
}

Write-Host "[done] admin equipment baselineleri stabilize edildi." -ForegroundColor Cyan

[ok] patched: __make_baseline_admin_equipment_add.flow
[ok] patched: __make_baseline_admin_equipment_change.flow
[ok] rewrote: equipment_ui_create_validate.flow
[done] admin equipment baselineleri stabilize edildi.
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) powershell -ExecutionPolicy Bypass -File ops\gen_from_backlog.ps1
powershell -ExecutionPolicy Bypass -File ops\patch_admin_equipment_baselines.ps1

[gen] Flow üretimi tamam
The argument 'ops\patch_admin_equipment_baselines.ps1' to the -File parameter does not exist. Provide the path to an exi
sting '.ps1' file as an argument to the -File parameter.
Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

Try the new cross-platform PowerShell https://aka.ms/pscore6
PS C:\dev\bakim_kalibrasyon>
(venv) Get-Item ops\patch_admin_equipment_baselines.ps1

>> TerminatingError(Get-Item): "The running command stopped because the preference variable "ErrorActionPreference" or common parameter is set to Stop: Cannot find path 'C:\dev\bakim_kalibrasyon\ops\patch_admin_equipment_baselines.ps1' because it does not exist."
>> TerminatingError(Get-Item): "The running command stopped because the preference variable "ErrorActionPreference" or common parameter is set to Stop: Cannot find path 'C:\dev\bakim_kalibrasyon\ops\patch_admin_equipment_baselines.ps1' because it does not exist."
The running command stopped because the preference variable "ErrorActionPreference" or common parameter is set to Stop: Cannot find path 'C:\dev\bakim_kalibrasyon\ops\patch_admin_equipment_baselines.ps1' because it does not exist.
Get-Item : Cannot find path 'C:\dev\bakim_kalibrasyon\ops\patch_admin_equipment_baselines.ps1' because it does not
exist.
At line:1 char:1
+ Get-Item ops\patch_admin_equipment_baselines.ps1
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (C:\dev\bakim_ka...t_baselines.ps1:String) [Get-Item], ItemNotFoundExcep
   tion
    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.GetItemCommand

PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) (venv) PS C:\dev\bakim_kalibrasyon> Get-Item ops\patch_admin_equipment_baselines.ps1
>>
Get-Item : Cannot find path 'C:\dev\bakim_kalibrasyon\ops\patch_admin_equipment_baselines.ps1' because it does not
exist.
At line:1 char:1
+ Get-Item ops\patch_admin_equipment_baselines.ps1
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (C:\dev\bakim_ka...t_baselines.ps1:String) [Get-Item], ItemNotFoundExcep
   tion
    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.GetItemCommand

(venv) PS C:\dev\bakim_kalibrasyon>
cls
At line:1 char:8
+ (venv) PS C:\dev\bakim_kalibrasyon> Get-Item ops\patch_admin_equipmen ...
+        ~~
Unexpected token 'PS' in expression or statement.

At line:6 char:2
+ + Get-Item ops\patch_admin_equipment_baselines.ps1
+  ~
Missing expression after unary operator '+'.

At line:6 char:3
+ + Get-Item ops\patch_admin_equipment_baselines.ps1
+   ~~~~~~~~
Unexpected token 'Get-Item' in expression or statement.

At line:7 char:2
+ + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+  ~
Missing expression after unary operator '+'.

At line:7 char:3
+ + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Unexpected token '~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~' in expression or statement.

At line:8 char:6
+     + CategoryInfo          : ObjectNotFound: (C:\dev\bakim_ka...t_ba ...
+      ~
Missing expression after unary operator '+'.

At line:8 char:7
+     + CategoryInfo          : ObjectNotFound: (C:\dev\bakim_ka...t_ba ...
+       ~~~~~~~~~~~~
Unexpected token 'CategoryInfo' in expression or statement.

At line:10 char:6
+     + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Comma ...
+      ~
Missing expression after unary operator '+'.

At line:10 char:7
+     + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Comma ...
+       ~~~~~~~~~~~~~~~~~~~~~
Unexpected token 'FullyQualifiedErrorId' in expression or statement.

At line:12 char:8
+ (venv) PS C:\dev\bakim_kalibrasyon>
+        ~~
Unexpected token 'PS' in expression or statement.
At line:1 char:8
+ (venv) PS C:\dev\bakim_kalibrasyon> Get-Item ops\patch_admin_equipmen ...
+        ~~
Unexpected token 'PS' in expression or statement.

At line:6 char:2
+ + Get-Item ops\patch_admin_equipment_baselines.ps1
+  ~
Missing expression after unary operator '+'.

At line:6 char:3
+ + Get-Item ops\patch_admin_equipment_baselines.ps1
+   ~~~~~~~~
Unexpected token 'Get-Item' in expression or statement.

At line:7 char:2
+ + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+  ~
Missing expression after unary operator '+'.

At line:7 char:3
+ + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Unexpected token '~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~' in expression or statement.

At line:8 char:6
+     + CategoryInfo          : ObjectNotFound: (C:\dev\bakim_ka...t_ba ...
+      ~
Missing expression after unary operator '+'.

At line:8 char:7
+     + CategoryInfo          : ObjectNotFound: (C:\dev\bakim_ka...t_ba ...
+       ~~~~~~~~~~~~
Unexpected token 'CategoryInfo' in expression or statement.

At line:10 char:6
+     + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Comma ...
+      ~
Missing expression after unary operator '+'.

At line:10 char:7
+     + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Comma ...
+       ~~~~~~~~~~~~~~~~~~~~~
Unexpected token 'FullyQualifiedErrorId' in expression or statement.

At line:12 char:8
+ (venv) PS C:\dev\bakim_kalibrasyon>
+        ~~
Unexpected token 'PS' in expression or statement.
    + CategoryInfo          : ParserError: (:) [], ParentContainsErrorRecordException
    + FullyQualifiedErrorId : UnexpectedToken

PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # === create: ops\patch_admin_equipment_baselines.ps1 (PS 5.1) ===
New-Item -ItemType Directory -Force ops | Out-Null
Set-Content -Path ops\patch_admin_equipment_baselines.ps1 -Encoding ASCII -Value @'
[CmdletBinding()]
param(
  [string]$FlowsDir = "ops\flows",
  [string]$User     = "admin",
  [string]$Pass     = "Admin!2345"
)
$ErrorActionPreference = "Stop"

function Read-Text([string]$p){ Get-Content -LiteralPath $p -Raw }
function Write-Text([string]$p,[string]$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }
function Strip-Lines([string]$txt,[string]$pat){
  [regex]::Replace($txt,$pat,"",[System.Text.RegularExpressions.RegexOptions]::Multiline)
}
function Prepend([string]$txt,[string]$block){ $block + "`r`n" + $txt }

# Sağlam login bloğu
$login  = "GOTO  /admin/login/`r`n"
$login += "WAIT  SELECTOR input[name=username]`r`n"
$login += ("FILL  input[name=username]  {0}`r`n" -f $User)
$login += ("FILL  input[name=password]  {0}`r`n" -f $Pass)
$login += "CLICK input[type=submit]`r`n"
$login += "WAIT  SELECTOR #content-main"

# Hedef dosyalar
$addFlow = Join-Path $FlowsDir "__make_baseline_admin_equipment_add.flow"
$chgFlow = Join-Path $FlowsDir "__make_baseline_admin_equipment_change.flow"
$dbgFlow = Join-Path $FlowsDir "debug_equipment_change.flow"
$valFlow = Join-Path $FlowsDir "equipment_ui_create_validate.flow"

# Ortak temizleyici
function Clean-Body([string]$body){
  $b = $body
  $b = Strip-Lines $b '^\s*GOTO\s+/admin/login/.*\r?$'
  $b = Strip-Lines $b '^\s*FILL\s+input\[name=username\].*\r?$'
  $b = Strip-Lines $b '^\s*FILL\s+input\[name=password\].*\r?$'
  $b = Strip-Lines $b '^\s*CLICK\s+input\[type=submit\].*\r?$'
  $b = Strip-Lines $b '^\s*WAIT\s+SELECTOR-OR[^\r\n]*\r?$'
  $b = Strip-Lines $b '^\s*WAIT\s+URL\s+CONTAINS[^\r\n]*\r?$'
  $b
}

# 1) ADD baseline: add formunu bekle
if (Test-Path $addFlow) {
  $t = Read-Text $addFlow
  $t = Clean-Body $t
  $hdr  = $login + "`r`n"
  $hdr += "GOTO  /admin/maintenance/equipment/add/`r`n"
  $hdr += "WAIT  SELECTOR form"
  # yanlış tablo bekleyen satırı form ile değiştir
  $t = [regex]::Replace($t,'(?m)^\s*WAIT\s+SELECTOR\s+table#result_list\s*$','WAIT  SELECTOR form')
  $t = Prepend $t $hdr
  Write-Text $addFlow $t
  Write-Host "[ok] patched: $(Split-Path $addFlow -Leaf)" -ForegroundColor Green
}

# 2) CHANGE baseline: liste tablosunu bekle
if (Test-Path $chgFlow) {
  $t = Read-Text $chgFlow
  $t = Clean-Body $t
  $hdr  = $login + "`r`n"
  $hdr += "GOTO  /admin/maintenance/equipment/`r`n"
  $hdr += "WAIT  SELECTOR #content-main`r`n"
  $hdr += "WAIT  SELECTOR table#result_list"
  $t = Prepend $t $hdr
  Write-Text $chgFlow $t
  Write-Host "[ok] patched: $(Split-Path $chgFlow -Leaf)" -ForegroundColor Green
}

# 3) DEBUG flow: CHANGE ile aynı giriş
if (Test-Path $dbgFlow) {
  $t = Read-Text $dbgFlow
  $t = Clean-Body $t
  $hdr  = $login + "`r`n"
  $hdr += "GOTO  /admin/maintenance/equipment/`r`n"
  $hdr += "WAIT  SELECTOR #content-main`r`n"
  $hdr += "WAIT  SELECTOR table#result_list"
  $t = Prepend $t $hdr
  Write-Text $dbgFlow $t
  Write-Host "[ok] patched: $(Split-Path $dbgFlow -Leaf)" -ForegroundColor Green
}

# 4) VALIDATE: sade ve sağlam
if (Test-Path $valFlow) {
  $lines = @()
  $lines += 'GOTO  /admin/login/?next=/admin/maintenance/equipment/'
  $lines += 'WAIT  SELECTOR input[name=username]'
  $lines += ("FILL  input[name=username]  {0}" -f $User)
  $lines += ("FILL  input[name=password]  {0}" -f $Pass)
  $lines += 'CLICK input[type=submit]'
  $lines += 'WAIT  SELECTOR #content-main'
  $lines += 'WAIT  SELECTOR table#result_list'
  $lines += 'WAIT  SELECTOR table#result_list tbody tr'
  Write-Text $valFlow ($lines -join "`r`n")
  Write-Host "[ok] rewrote: $(Split-Path $valFlow -Leaf)" -ForegroundColor Green
}

Write-Host "[done] admin equipment baselineleri stabilize edildi." -ForegroundColor Cyan
'@

PS C:\dev\bakim_kalibrasyon>
(venv) Get-Item ops\patch_admin_equipment_baselines.ps1



    Directory: C:\dev\bakim_kalibrasyon\ops


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
-a----        01/10/2025     15:22           3636 patch_admin_equipment_baselines.ps1


PS C:\dev\bakim_kalibrasyon>
(venv) powershell -ExecutionPolicy Bypass -File ops\gen_from_backlog.ps1
powershell -ExecutionPolicy Bypass -File ops\patch_admin_equipment_baselines.ps1

[gen] Flow üretimi tamam
[ok] patched: __make_baseline_admin_equipment_add.flow
[ok] patched: __make_baseline_admin_equipment_change.flow
[ok] rewrote: equipment_ui_create_validate.flow
[done] admin equipment baselineleri stabilize edildi.
PS C:\dev\bakim_kalibrasyon>
(venv) powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_*" -BaseUrl "http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*" -BaseUrl "http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "debug_equipment_change*" -BaseUrl "http://127.0.0.1:8010"

==> Running: __make_baseline_admin_equipment_add.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_add.f
low --out _otokodlama\out\__make_baseline_admin_equipment_add.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_add.json
[err] __make_baseline_admin_equipment_add.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1
[warn] No matching flows for filter: debug_equipment_change*
PS C:\dev\bakim_kalibrasyon>
(venv) powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"


==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Cal
l log:   - wa...
__make_baseline_admin_equipment_change.json  FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Ca
ll log:   - wa...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Cal
l log:   - wa...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 12   FAIL: 4   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) $failJsons = @(
  "_otokodlama\out\__make_baseline_admin_equipment_add.json",
  "_otokodlama\out\__make_baseline_admin_equipment_change.json",
  "_otokodlama\out\equipment_ui_create_validate.json"
) | Where-Object { Test-Path $_ }

foreach($j in $failJsons){
  "`n=== $j ==="
  (Get-Content $j -Raw | ConvertFrom-Json).results | ?{ -not $_.ok } |
    Select-Object i,cmd,arg,error,url
}


=== _otokodlama\out\__make_baseline_admin_equipment_add.json ===


i     : 10
cmd   : WAIT
arg   : SELECTOR input[name=username]
error : TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded.
        Call log:
          - waiting for locator("input[name=username]") to be visible

url   : http://127.0.0.1:8010/admin/maintenance/equipment/add/


=== _otokodlama\out\__make_baseline_admin_equipment_change.json ===
i     : 8
cmd   : WAIT
arg   : SELECTOR table#result_list tbody tr:first-child th > a
error : TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded.
        Call log:
          - waiting for locator("table#result_list tbody tr:first-child th > a") to be visible

url   : http://127.0.0.1:8010/admin/


=== _otokodlama\out\equipment_ui_create_validate.json ===
i     : 6
cmd   : WAIT
arg   : SELECTOR #content-main
error : TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded.
        Call log:
          - waiting for locator("#content-main") to be visible

url   : chrome-error://chromewebdata/



PS C:\dev\bakim_kalibrasyon>
(venv) Get-Content ops\flows\__make_baseline_admin_equipment_add.flow -TotalCount 30
Get-Content ops\flows\__make_baseline_admin_equipment_change.flow -TotalCount 30
Get-Content ops\flows\equipment_ui_create_validate.flow -TotalCount 30

GOTO  /admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  admin
FILL  input[name=password]  Admin!2345
CLICK input[type=submit]
WAIT  SELECTOR #content-main
GOTO  /admin/maintenance/equipment/add/
WAIT  SELECTOR form

WAIT  SELECTOR input[name=username]

WAIT  SELECTOR #content-main
GOTO  /admin/maintenance/equipment/add/
WAIT  SELECTOR form

WAIT  SELECTOR input[name=username]

WAIT  SELECTOR #content-main
GOTO  /admin/maintenance/equipment/add/
WAIT  SELECTOR form

WAIT  SELECTOR input[name=username]

GOTO  /admin/maintenance/equipment/_direct/
WAIT  SELECTOR form
GOTO  /admin/maintenance/equipment/_direct/
WAIT  SELECTOR form
GOTO  /admin/maintenance/equipment/_direct/
WAIT  SELECTOR form
GOTO  /admin/maintenance/equipment/_direct/
GOTO  /admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  admin
FILL  input[name=password]  Admin!2345
CLICK input[type=submit]
WAIT  SELECTOR #content-main
GOTO  /admin/maintenance/equipment/
WAIT  SELECTOR #content-main
WAIT  SELECTOR table#result_list

WAIT  SELECTOR input[name=username]

WAIT  SELECTOR #content-main
GOTO  /admin/maintenance/equipment/
WAIT  SELECTOR #content-main
WAIT  SELECTOR table#result_list

WAIT  SELECTOR input[name=username]

WAIT  SELECTOR #content-main
GOTO  /admin/maintenance/equipment/
WAIT  SELECTOR #content-main
WAIT  SELECTOR table#result_list

WAIT  SELECTOR input[name=username]

GOTO  /admin/maintenance/equipment/_direct/
WAIT  SELECTOR table#result_list
GOTO  /admin/maintenance/equipment/_direct/
WAIT  SELECTOR table#result_list
GOTO  /admin/login/?next=/admin/maintenance/equipment/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  admin
FILL  input[name=password]  Admin!2345
CLICK input[type=submit]
WAIT  SELECTOR #content-main
WAIT  SELECTOR table#result_list
WAIT  SELECTOR table#result_list tbody tr
PS C:\dev\bakim_kalibrasyon>
(venv) GOTO  /admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  admin
FILL  input[name=password]  Admin!2345
CLICK input[type=submit]
WAIT  SELECTOR #content-main
GOTO  /admin/maintenance/equipment/add/
WAIT  SELECTOR form

>> TerminatingError(): "The term 'GOTO' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again."
The term 'GOTO' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
GOTO : The term 'GOTO' is not recognized as the name of a cmdlet, function, script file, or operable program. Check
the spelling of the name, or if a path was included, verify that the path is correct and try again.
At line:1 char:1
+ GOTO  /admin/login/
+ ~~~~
    + CategoryInfo          : ObjectNotFound: (GOTO:String) [], ParentContainsErrorRecordException
    + FullyQualifiedErrorId : CommandNotFoundException

PS C:\dev\bakim_kalibrasyon>
(venv) $ErrorActionPreference="Stop"

function Write-Ascii($p,$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }

# 1) ADD baseline -> form bekle
$add = "ops\flows\__make_baseline_admin_equipment_add.flow"
if (Test-Path $add){
  $t = @'
GOTO  /admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  admin
FILL  input[name=password]  Admin!2345
CLICK input[type=submit]
WAIT  SELECTOR #content-main
GOTO  /admin/maintenance/equipment/add/
WAIT  SELECTOR form
'@
  # var olan gövdenin başına ekle (gövdeyi olduğu gibi koruyoruz)
  $body = Get-Content $add -Raw
  Write-Ascii $add ($t + "`r`n" + $body -replace '(?m)^\s*WAIT\s+SELECTOR-OR.*$','' -replace '(?m)^\s*WAIT\s+URL\s+CONTAINS.*$','')
  Write-Host "[fix] add baseline başlık yenilendi" -Foreground Green
}

# 2) CHANGE baseline -> liste tablosu bekle
$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
if (Test-Path $chg){
  $t = @'
GOTO  /admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  admin
FILL  input[name=password]  Admin!2345
CLICK input[type=submit]
WAIT  SELECTOR #content-main
GOTO  /admin/maintenance/equipment/
WAIT  SELECTOR #content-main
WAIT  SELECTOR table#result_list
'@
  $body = Get-Content $chg -Raw
  Write-Ascii $chg ($t + "`r`n" + $body -replace '(?m)^\s*WAIT\s+SELECTOR-OR.*$','' -replace '(?m)^\s*WAIT\s+URL\s+CONTAINS.*$','')
  Write-Host "[fix] change baseline başlık yenilendi" -Foreground Green
}

# 3) CREATE_VALIDATE -> link tıklayarak listeye geç
$val = "ops\flows\equipment_ui_create_validate.flow"
if (Test-Path $val){
  $t = @'
GOTO  /admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  admin
FILL  input[name=password]  Admin!2345
CLICK input[type=submit]
WAIT  SELECTOR #content-main
WAIT  SELECTOR a[href*="/maintenance/equipment/"]
CLICK a[href*="/maintenance/equipment/"]
WAIT  SELECTOR table#result_list
WAIT  SELECTOR table#result_list tbody tr
'@
  Write-Ascii $val $t
  Write-Host "[fix] create_validate baştan yazıldı" -Foreground Green
}

# Çalıştır ve raporla
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_*;equipment_ui_create_validate*" -BaseUrl "http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"

[fix] add baseline başlık yenilendi
[fix] change baseline başlık yenilendi
[fix] create_validate baştan yazıldı
[warn] No matching flows for filter: __make_baseline_admin_equipment_*;equipment_ui_create_validate*

==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Cal
l log:   - wa...
__make_baseline_admin_equipment_change.json  FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Ca
ll log:   - wa...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Cal
l log:   - wa...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 12   FAIL: 4   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) $ErrorActionPreference="Stop"

function Write-Ascii($p,$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }

# A) ADD baseline — login -> add form
$add = "ops\flows\__make_baseline_admin_equipment_add.flow"
if (Test-Path $add){
  $t = @'
GOTO  /admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  admin
FILL  input[name=password]  Admin!2345
CLICK input[type=submit]
WAIT  SELECTOR #content-main
GOTO  /admin/maintenance/equipment/add/
WAIT  SELECTOR form
'@
  Write-Ascii $add $t
  Write-Host "[reset] add baseline yazıldı" -Foreground Green
}

# B) CHANGE baseline — login -> equipment list (tablo bekle)
$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
if (Test-Path $chg){
  $t = @'
GOTO  /admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  admin
FILL  input[name=password]  Admin!2345
CLICK input[type=submit]
WAIT  SELECTOR #content-main
GOTO  /admin/maintenance/equipment/
WAIT  SELECTOR #content-main
WAIT  SELECTOR table#result_list
'@
  Write-Ascii $chg $t
  Write-Host "[reset] change baseline yazıldı" -Foreground Green
}

# C) VALIDATE — login -> direkt liste (_direct en kararlı yol)
$val = "ops\flows\equipment_ui_create_validate.flow"
if (Test-Path $val){
  $t = @'
GOTO  /admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  admin
FILL  input[name=password]  Admin!2345
CLICK input[type=submit]
WAIT  SELECTOR #content-main
GOTO  /admin/maintenance/equipment/_direct/
WAIT  SELECTOR table#result_list
WAIT  SELECTOR table#result_list tbody tr
'@
  Write-Ascii $val $t
  Write-Host "[reset] create_validate yazıldı" -Foreground Green
}

[reset] add baseline yazıldı
[reset] change baseline yazıldı
[reset] create_validate yazıldı
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) $base="http://127.0.0.1:8010"

powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_add*"    -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*"           -BaseUrl $base

==> Running: __make_baseline_admin_equipment_add.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_add.f
low --out _otokodlama\out\__make_baseline_admin_equipment_add.json
[PW-FLOW] PASSED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_add.json
[ok] __make_baseline_admin_equipment_add.flow
[ok] All flows passed.
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1
PS C:\dev\bakim_kalibrasyon>
(venv) powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"


==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     Error: Page.goto: net::ERR_TOO_MANY_REDIRECTS at http://127.0.0.1:
8010/admin/mai...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Cal
l log:   - wa...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) $failJsons = @(
  "_otokodlama\out\__make_baseline_admin_equipment_add.json",
  "_otokodlama\out\__make_baseline_admin_equipment_change.json",
  "_otokodlama\out\equipment_ui_create_validate.json"
) | ?{ Test-Path $_ }

foreach($j in $failJsons){
  "`n=== $j ==="
  (Get-Content $j -Raw | ConvertFrom-Json).results | ?{ -not $_.ok } |
    Select-Object i,cmd,arg,error,url
}


=== _otokodlama\out\__make_baseline_admin_equipment_add.json ===

=== _otokodlama\out\__make_baseline_admin_equipment_change.json ===


i     : 7
cmd   : GOTO
arg   : /admin/maintenance/equipment/
error : Error: Page.goto: net::ERR_TOO_MANY_REDIRECTS at http://127.0.0.1:8010/admin/maintenance/equipment/
        Call log:
          - navigating to "http://127.0.0.1:8010/admin/maintenance/equipment/", waiting until "domcontentloaded"

url   : http://127.0.0.1:8010/admin/


=== _otokodlama\out\equipment_ui_create_validate.json ===
i     : 8
cmd   : WAIT
arg   : SELECTOR table#result_list
error : TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded.
        Call log:
          - waiting for locator("table#result_list") to be visible

url   : http://127.0.0.1:8010/admin/



PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # ops\flows\__make_baseline_admin_equipment_change.flow -> TAMAMEN SIFIRLA
Set-Content -LiteralPath ops\flows\__make_baseline_admin_equipment_change.flow -Encoding ASCII -Value @'
GOTO  /admin/login/?next=/admin/maintenance/equipment/_direct/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  admin
FILL  input[name=password]  Admin!2345
CLICK input[type=submit]
WAIT  SELECTOR table#result_list
'@
Write-Host "[reset] change baseline -> login(next=_direct) + tablo bekle" -ForegroundColor Green

[reset] change baseline -> login(next=_direct) + tablo bekle
PS C:\dev\bakim_kalibrasyon>
(venv) # ops\flows\equipment_ui_create_validate.flow -> TAMAMEN SIFIRLA
Set-Content -LiteralPath ops\flows\equipment_ui_create_validate.flow -Encoding ASCII -Value @'
GOTO  /admin/login/?next=/admin/maintenance/equipment/_direct/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  admin
FILL  input[name=password]  Admin!2345
CLICK input[type=submit]
WAIT  SELECTOR table#result_list
WAIT  SELECTOR table#result_list tbody tr
'@
Write-Host "[reset] create_validate -> login(next=_direct) + tablo+satır bekle" -ForegroundColor Green

[reset] create_validate -> login(next=_direct) + tablo+satır bekle
PS C:\dev\bakim_kalibrasyon>
(venv) $base="http://127.0.0.1:8010"

powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*"          -BaseUrl $base

powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"

==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1

==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Ca
ll log:   - wa...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Cal
l log:   - wa...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) $J="_otokodlama\out\__make_baseline_admin_equipment_change.json"; if(Test-Path $J){(gc $J -Raw|ConvertFrom-Json).results|?{-not $_.ok}|select i,cmd,arg,error,url}
$J="_otokodlama\out\equipment_ui_create_validate.json"; if(Test-Path $J){(gc $J -Raw|ConvertFrom-Json).results|?{-not $_.ok}|select i,cmd,arg,error,url}



i     : 6
cmd   : WAIT
arg   : SELECTOR table#result_list
error : TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded.
        Call log:
          - waiting for locator("table#result_list") to be visible

url   : http://127.0.0.1:8010/admin/

i     : 6
cmd   : WAIT
arg   : SELECTOR table#result_list
error : TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded.
        Call log:
          - waiting for locator("table#result_list") to be visible

url   : http://127.0.0.1:8010/admin/



PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # ops\flows\__make_baseline_admin_equipment_change.flow -> TAMAMEN SIFIRLA
Set-Content -LiteralPath ops\flows\__make_baseline_admin_equipment_change.flow -Encoding ASCII -Value @'
GOTO  /admin/login/?next=/admin/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  admin
FILL  input[name=password]  Admin!2345
CLICK input[type=submit]
WAIT  SELECTOR #content-main
GOTO  /admin/maintenance/equipment/
WAIT  SELECTOR #content-main
WAIT  SELECTOR table#result_list
'@

PS C:\dev\bakim_kalibrasyon>
(venv) # ops\flows\equipment_ui_create_validate.flow -> TAMAMEN SIFIRLA
Set-Content -LiteralPath ops\flows\equipment_ui_create_validate.flow -Encoding ASCII -Value @'
GOTO  /admin/login/?next=/admin/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  admin
FILL  input[name=password]  Admin!2345
CLICK input[type=submit]
WAIT  SELECTOR #content-main
GOTO  /admin/maintenance/equipment/
WAIT  SELECTOR #content-main
WAIT  SELECTOR table#result_list
WAIT  SELECTOR table#result_list tbody tr
'@

PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) $base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*"          -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"

==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1

==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     Error: Page.goto: net::ERR_TOO_MANY_REDIRECTS at http://127.0.0.1:
8010/admin/mai...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     Error: Page.goto: net::ERR_TOO_MANY_REDIRECTS at http://127.0.0.1:8
010/admin/mai...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) $J="_otokodlama\out\__make_baseline_admin_equipment_change.json"; if(Test-Path $J){(gc $J -Raw|ConvertFrom-Json).results|?{-not $_.ok}|select i,cmd,arg,error,url}
$J="_otokodlama\out\equipment_ui_create_validate.json"; if(Test-Path $J){(gc $J -Raw|ConvertFrom-Json).results|?{-not $_.ok}|select i,cmd,arg,error,url}



i     : 7
cmd   : GOTO
arg   : /admin/maintenance/equipment/
error : Error: Page.goto: net::ERR_TOO_MANY_REDIRECTS at http://127.0.0.1:8010/admin/maintenance/equipment/
        Call log:
          - navigating to "http://127.0.0.1:8010/admin/maintenance/equipment/", waiting until "domcontentloaded"

url   : http://127.0.0.1:8010/admin/

i     : 7
cmd   : GOTO
arg   : /admin/maintenance/equipment/
error : Error: Page.goto: net::ERR_TOO_MANY_REDIRECTS at http://127.0.0.1:8010/admin/maintenance/equipment/
        Call log:
          - navigating to "http://127.0.0.1:8010/admin/maintenance/equipment/", waiting until "domcontentloaded"

url   : http://127.0.0.1:8010/admin/



PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # ops\flows\__make_baseline_admin_equipment_change.flow -> TAMAMEN SIFIRLA
Set-Content -LiteralPath ops\flows\__make_baseline_admin_equipment_change.flow -Encoding ASCII -Value @'
GOTO  /admin/login/?next=/admin/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  admin
FILL  input[name=password]  Admin!2345
CLICK input[type=submit]
WAIT  SELECTOR #content-main
WAIT  SELECTOR a[href*="/maintenance/equipment/"]
CLICK a[href*="/maintenance/equipment/"]
WAIT  SELECTOR #content-main
WAIT  SELECTOR table#result_list
'@

PS C:\dev\bakim_kalibrasyon>
(venv)  # ops\flows\equipment_ui_create_validate.flow -> TAMAMEN SIFIRLA
Set-Content -LiteralPath ops\flows\equipment_ui_create_validate.flow -Encoding ASCII -Value @'
GOTO  /admin/login/?next=/admin/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  admin
FILL  input[name=password]  Admin!2345
CLICK input[type=submit]
WAIT  SELECTOR #content-main
WAIT  SELECTOR a[href*="/maintenance/equipment/"]
CLICK a[href*="/maintenance/equipment/"]
WAIT  SELECTOR #content-main
WAIT  SELECTOR table#result_list
WAIT  SELECTOR table#result_list tbody tr
'@

PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) $base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*"          -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"

==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1

==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     Error: navigation-error
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     Error: navigation-error
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) $J="_otokodlama\out\__make_baseline_admin_equipment_change.json"; if(Test-Path $J){(gc $J -Raw|ConvertFrom-Json).results|?{-not $_.ok}|select i,cmd,arg,error,url}
$J="_otokodlama\out\equipment_ui_create_validate.json"; if(Test-Path $J){(gc $J -Raw|ConvertFrom-Json).results|?{-not $_.ok}|select i,cmd,arg,error,url}



i     : 8
cmd   : CLICK
arg   : a[href*="/maintenance/equipment/"]
error : Error: navigation-error
url   : chrome-error://chromewebdata/

i     : 8
cmd   : CLICK
arg   : a[href*="/maintenance/equipment/"]
error : Error: navigation-error
url   : chrome-error://chromewebdata/



PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # ops\flows\__make_baseline_admin_equipment_change.flow  -> TAMAMEN SIFIRLA
GOTO  /admin/login/?next=/admin/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  admin
FILL  input[name=password]  Admin!2345
CLICK input[type=submit]
WAIT  SELECTOR #content-main
GOTO  /admin/maintenance/equipment/_direct/
WAIT  SELECTOR #content-main
WAIT  SELECTOR table#result_list

>> TerminatingError(): "The term 'GOTO' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again."
The term 'GOTO' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
GOTO : The term 'GOTO' is not recognized as the name of a cmdlet, function, script file, or operable program. Check
the spelling of the name, or if a path was included, verify that the path is correct and try again.
At line:2 char:1
+ GOTO  /admin/login/?next=/admin/
+ ~~~~
    + CategoryInfo          : ObjectNotFound: (GOTO:String) [], ParentContainsErrorRecordException
    + FullyQualifiedErrorId : CommandNotFoundException

PS C:\dev\bakim_kalibrasyon>
(venv) # ops\flows\equipment_ui_create_validate.flow  -> TAMAMEN SIFIRLA
GOTO  /admin/login/?next=/admin/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  admin
FILL  input[name=password]  Admin!2345
CLICK input[type=submit]
WAIT  SELECTOR #content-main
GOTO  /admin/maintenance/equipment/_direct/
WAIT  SELECTOR #content-main
WAIT  SELECTOR table#result_list
WAIT  SELECTOR table#result_list tbody tr

>> TerminatingError(): "The term 'GOTO' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again."
The term 'GOTO' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
GOTO : The term 'GOTO' is not recognized as the name of a cmdlet, function, script file, or operable program. Check
the spelling of the name, or if a path was included, verify that the path is correct and try again.
At line:2 char:1
+ GOTO  /admin/login/?next=/admin/
+ ~~~~
    + CategoryInfo          : ObjectNotFound: (GOTO:String) [], ParentContainsErrorRecordException
    + FullyQualifiedErrorId : CommandNotFoundException

PS C:\dev\bakim_kalibrasyon>
(venv) $base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*"          -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"

==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1

==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     Error: navigation-error
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     Error: navigation-error
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # __make_baseline_admin_equipment_change.flow -> TAMAMEN SIFIRLA
Set-Content -LiteralPath ops\flows\__make_baseline_admin_equipment_change.flow -Encoding ASCII -Value @'
GOTO  /admin/login/?next=/admin/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  admin
FILL  input[name=password]  Admin!2345
CLICK input[type=submit]
WAIT  SELECTOR #content-main
GOTO  /admin/maintenance/equipment/_direct/
WAIT  SELECTOR #content-main
WAIT  SELECTOR table#result_list
'@

# equipment_ui_create_validate.flow -> TAMAMEN SIFIRLA
Set-Content -LiteralPath ops\flows\equipment_ui_create_validate.flow -Encoding ASCII -Value @'
GOTO  /admin/login/?next=/admin/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  admin
FILL  input[name=password]  Admin!2345
CLICK input[type=submit]
WAIT  SELECTOR #content-main
GOTO  /admin/maintenance/equipment/_direct/
WAIT  SELECTOR #content-main
WAIT  SELECTOR table#result_list
WAIT  SELECTOR table#result_list tbody tr
'@

PS C:\dev\bakim_kalibrasyon>
(venv) Get-Content ops\flows\__make_baseline_admin_equipment_change.flow -TotalCount 30
Get-Content ops\flows\equipment_ui_create_validate.flow -TotalCount 30

GOTO  /admin/login/?next=/admin/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  admin
FILL  input[name=password]  Admin!2345
CLICK input[type=submit]
WAIT  SELECTOR #content-main
GOTO  /admin/maintenance/equipment/_direct/
WAIT  SELECTOR #content-main
WAIT  SELECTOR table#result_list
GOTO  /admin/login/?next=/admin/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  admin
FILL  input[name=password]  Admin!2345
CLICK input[type=submit]
WAIT  SELECTOR #content-main
GOTO  /admin/maintenance/equipment/_direct/
WAIT  SELECTOR #content-main
WAIT  SELECTOR table#result_list
WAIT  SELECTOR table#result_list tbody tr
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) $base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*"          -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"

==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1

==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Ca
ll log:   - wa...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Cal
l log:   - wa...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force

PS C:\dev\bakim_kalibrasyon>
(venv) $J="_otokodlama\out\__make_baseline_admin_equipment_change.json"; if(Test-Path $J){ (gc $J -Raw|ConvertFrom-Json).results | ?{ -not $_.ok } | select i,cmd,arg,error,url }
$J="_otokodlama\out\equipment_ui_create_validate.json"; if(Test-Path $J){ (gc $J -Raw|ConvertFrom-Json).results | ?{ -not $_.ok } | select i,cmd,arg,error,url }



i     : 9
cmd   : WAIT
arg   : SELECTOR table#result_list
error : TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded.
        Call log:
          - waiting for locator("table#result_list") to be visible

url   : http://127.0.0.1:8010/admin/

i     : 9
cmd   : WAIT
arg   : SELECTOR table#result_list
error : TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded.
        Call log:
          - waiting for locator("table#result_list") to be visible

url   : http://127.0.0.1:8010/admin/



PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # __make_baseline_admin_equipment_change.flow -> SIFIRLA
Set-Content -LiteralPath ops\flows\__make_baseline_admin_equipment_change.flow -Encoding ASCII -Value @'
GOTO  /admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  admin
FILL  input[name=password]  Admin!2345
CLICK input[type=submit]
WAIT  SELECTOR #content-main
WAIT  SELECTOR #content-main a[href$="/maintenance/equipment/"], a[href="/admin/maintenance/equipment/"], a:has-text("Equipment")
CLICK  #content-main a[href$="/maintenance/equipment/"], a[href="/admin/maintenance/equipment/"], a:has-text("Equipment")
WAIT  URL CONTAINS /admin/maintenance/equipment/
WAIT  SELECTOR #content-main
WAIT  SELECTOR table#result_list
'@

# equipment_ui_create_validate.flow -> SIFIRLA
Set-Content -LiteralPath ops\flows\equipment_ui_create_validate.flow -Encoding ASCII -Value @'
GOTO  /admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  admin
FILL  input[name=password]  Admin!2345
CLICK input[type=submit]
WAIT  SELECTOR #content-main
WAIT  SELECTOR #content-main a[href$="/maintenance/equipment/"], a[href="/admin/maintenance/equipment/"], a:has-text("Equipment")
CLICK  #content-main a[href$="/maintenance/equipment/"], a[href="/admin/maintenance/equipment/"], a:has-text("Equipment")
WAIT  URL CONTAINS /admin/maintenance/equipment/
WAIT  SELECTOR #content-main
WAIT  SELECTOR table#result_list
WAIT  SELECTOR table#result_list tbody tr
'@

PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) $base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*"          -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"

==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1

==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     Error: navigation-error
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     Error: navigation-error
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force

PS C:\dev\bakim_kalibrasyon>
(venv) $base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*"          -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"

==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1

==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     Error: navigation-error
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     Error: navigation-error
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # === create: ops\fix_equipment_change_validate.ps1 (PS 5.1, ASCII) ===
$new = @'
# Rev: stable – absolute URL + login(next) -> _direct
param(
  [string]$Base = "http://127.0.0.1:8010",
  [string]$User = "admin",
  [string]$Pass = "Admin!2345"
)
$ErrorActionPreference="Stop"

function W($p,$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }

$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
$val = "ops\flows\equipment_ui_create_validate.flow"

$loginNext = "$Base/admin/login/?next=/admin/maintenance/equipment/_direct/"

$CHANGE = @"
GOTO  $loginNext
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  $User
FILL  input[name=password]  $Pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main          # login finalize
GOTO  $Base/admin/maintenance/equipment/_direct/
WAIT  SELECTOR #content-main
WAIT  SELECTOR table#result_list
"@

$VALIDATE = @"
GOTO  $loginNext
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  $User
FILL  input[name=password]  $Pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main
GOTO  $Base/admin/maintenance/equipment/_direct/
WAIT  SELECTOR #content-main
WAIT  SELECTOR table#result_list
WAIT  SELECTOR table#result_list tbody tr
"@

if (Test-Path $chg) { W $chg $CHANGE; Write-Host "[ok] rewrote: $(Split-Path $chg -Leaf)" -ForegroundColor Green }
if (Test-Path $val) { W $val $VALIDATE; Write-Host "[ok] rewrote: $(Split-Path $val -Leaf)" -ForegroundColor Green }
'@
Set-Content -Path ops\fix_equipment_change_validate.ps1 -Value $new -Encoding ASCII
Write-Host "[ok] wrote ops\fix_equipment_change_validate.ps1" -ForegroundColor Green

[ok] wrote ops\fix_equipment_change_validate.ps1
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # 1) Yama
powershell -ExecutionPolicy Bypass -File ops\fix_equipment_change_validate.ps1

# 2) (Gerekirse) tarayıcı süreçlerini temizle
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force

# 3) Koş
$base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*"          -BaseUrl $base

# 4) Özet
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"

[ok] rewrote: __make_baseline_admin_equipment_change.flow
[ok] rewrote: equipment_ui_create_validate.flow
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1

==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     Error: Page.wait_for_selector: Unexpected token "#" while parsing
css selector "...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Cal
l log:   - wa...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # === create: ops\fix_change_validate_r2.ps1 (PS 5.1, ASCII) ===
$new = @'
# Rev: r2 – inline yorumları kaldır, robust selector beklemeleri ekle
param(
  [string]$Base = "http://127.0.0.1:8010",
  [string]$User = "admin",
  [string]$Pass = "Admin!2345"
)
$ErrorActionPreference="Stop"

function W($p,$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }

$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
$val = "ops\flows\equipment_ui_create_validate.flow"

# Tek satırlık bekleme hedefleri (OR için virgül kullanıyoruz)
$LIST_ANY = " #changelist,form#changelist-form,table#result_list "
$TABLE_OR = " table#result_list,form#changelist-form table "

$loginNext = "$Base/admin/login/?next=/admin/maintenance/equipment/_direct/"

$CHANGE = @"
GOTO  $loginNext
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  $User
FILL  input[name=password]  $Pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main
GOTO  $Base/admin/maintenance/equipment/_direct/
WAIT  SELECTOR #content-main
WAIT  SELECTOR$LIST_ANY
WAIT  SELECTOR$TABLE_OR
"@

$VALIDATE = @"
GOTO  $loginNext
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  $User
FILL  input[name=password]  $Pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main
GOTO  $Base/admin/maintenance/equipment/_direct/
WAIT  SELECTOR #content-main
WAIT  SELECTOR$LIST_ANY
WAIT  SELECTOR$TABLE_OR
"@

if (Test-Path $chg) { W $chg $CHANGE; Write-Host "[ok] rewrote: $(Split-Path $chg -Leaf)" -ForegroundColor Green }
if (Test-Path $val) { W $val $VALIDATE; Write-Host "[ok] rewrote: $(Split-Path $val -Leaf)" -ForegroundColor Green }
'@
Set-Content -Path ops\fix_change_validate_r2.ps1 -Value $new -Encoding ASCII
Write-Host "[ok] wrote ops\fix_change_validate_r2.ps1" -ForegroundColor Green

[ok] wrote ops\fix_change_validate_r2.ps1
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # 1) Yama
powershell -ExecutionPolicy Bypass -File ops\fix_change_validate_r2.ps1

# 2) Olası takılı browser süreçlerini temizle (opsiyonel ama iyi gelir)
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force

# 3) Sadece iki akışı dene
$base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*"          -BaseUrl $base

# 4) Özet
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"

[ok] rewrote: __make_baseline_admin_equipment_change.flow
[ok] rewrote: equipment_ui_create_validate.flow
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1

==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Ca
ll log:   - wa...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Cal
l log:   - wa...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # === create: ops\fix_equipment_list_r3.ps1  (PS 5.1, ASCII) ===
$new = @'
[CmdletBinding()]
param(
  [string]$Base = "http://127.0.0.1:8010",
  [string]$User = "admin",
  [string]$Pass = "Admin!2345"
)
$ErrorActionPreference = "Stop"

function W([string]$p,[string]$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }

$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
$val = "ops\flows\equipment_ui_create_validate.flow"

$LOGIN = @"
GOTO  $Base/admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  $User
FILL  input[name=password]  $Pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main
"@

# Admin index'e gidip linkten listeye geç – direkt GOTO yerine link tıklama güvenli
$TO_LIST = @"
GOTO  $Base/admin/
WAIT  SELECTOR a[href*="/maintenance/equipment/"]
CLICK a[href*="/maintenance/equipment/"]
WAIT  SELECTOR #content-main
WAIT  SELECTOR #changelist,form#changelist-form,#content-main .object-tools
WAIT  SELECTOR a[href$="/add/"]
WAIT  SELECTOR table#result_list, p.no-results, .paginator
"@

if (Test-Path $chg) {
  W $chg ($LOGIN + $TO_LIST)
  Write-Host "[ok] rewrote: $(Split-Path $chg -Leaf)" -ForegroundColor Green
}
if (Test-Path $val) {
  W $val ($LOGIN + $TO_LIST)
  Write-Host "[ok] rewrote: $(Split-Path $val -Leaf)" -ForegroundColor Green
}
'@
Set-Content -Path ops\fix_equipment_list_r3.ps1 -Value $new -Encoding ASCII
Write-Host "[ok] wrote ops\fix_equipment_list_r3.ps1" -ForegroundColor Green

# --- ÇALIŞTIRMA ---
# 1) Yama
powershell -ExecutionPolicy Bypass -File ops\fix_equipment_list_r3.ps1

# 2) Tıkalı browser varsa temizle (opsiyonel ama iyi)
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force

# 3) Sadece iki akışı dene
$base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*"          -BaseUrl $base

# 4) Özet
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"

[ok] wrote ops\fix_equipment_list_r3.ps1
[ok] rewrote: __make_baseline_admin_equipment_change.flow
[ok] rewrote: equipment_ui_create_validate.flow
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1

==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     Error: Page.wait_for_selector: Unexpected token "/" while parsing
css selector "...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     Error: Page.wait_for_selector: Unexpected token "/" while parsing c
ss selector "...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # === create: ops\fix_equipment_list_r4.ps1  (PS 5.1, ASCII) ===
$new = @'
[CmdletBinding()]
param(
  [string]$Base = "http://127.0.0.1:8010",
  [string]$User = "admin",
  [string]$Pass = "Admin!2345"
)
$ErrorActionPreference = "Stop"

function W([string]$p,[string]$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }

$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
$val = "ops\flows\equipment_ui_create_validate.flow"

$LOGIN = @"
GOTO  $Base/admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  $User
FILL  input[name=password]  $Pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main
"@

# Admin index -> Maintenance -> Equipment linkini sınıfla bul (attribute yok, '/' yok)
# Django admin: <tr class="model-equipment"> içinde link bulunur
$TO_LIST = @"
GOTO  $Base/admin/
WAIT  SELECTOR #content-main
WAIT  SELECTOR .model-equipment a
CLICK .model-equipment a
WAIT  SELECTOR #changelist
WAIT  SELECTOR .object-tools a.addlink
"@

if (Test-Path $chg) {
  W $chg ($LOGIN + $TO_LIST)
  Write-Host "[ok] rewrote: $(Split-Path $chg -Leaf)" -ForegroundColor Green
}
if (Test-Path $val) {
  W $val ($LOGIN + $TO_LIST)
  Write-Host "[ok] rewrote: $(Split-Path $val -Leaf)" -ForegroundColor Green
}
'@
Set-Content -Path ops\fix_equipment_list_r4.ps1 -Value $new -Encoding ASCII
Write-Host "[ok] wrote ops\fix_equipment_list_r4.ps1" -ForegroundColor Green

# --- ÇALIŞTIR ---
# 1) Yama
powershell -ExecutionPolicy Bypass -File ops\fix_equipment_list_r4.ps1

# 2) Tıkalı browser süreçleri (opsiyonel temizlik)
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force

# 3) Sadece iki akışı dene
$base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*"          -BaseUrl $base

# 4) Özet
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"

[ok] wrote ops\fix_equipment_list_r4.ps1
[ok] rewrote: __make_baseline_admin_equipment_change.flow
[ok] rewrote: equipment_ui_create_validate.flow
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1

==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     Error: Page.wait_for_selector: Unexpected token "/" while parsing
css selector "...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     Error: Page.wait_for_selector: Unexpected token "/" while parsing c
ss selector "...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) $J="_otokodlama\out\__make_baseline_admin_equipment_change.json"; if(Test-Path $J){ (gc $J -Raw|ConvertFrom-Json).results | ?{ -not $_.ok } | select i,cmd,arg,error,url }
$J="_otokodlama\out\equipment_ui_create_validate.json"; if(Test-Path $J){ (gc $J -Raw|ConvertFrom-Json).results | ?{ -not $_.ok } | select i,cmd,arg,error,url }



i     : 6
cmd   : WAIT
arg   : SELECTOR #content-mainGOTO  http://127.0.0.1:8010/admin/
error : Error: Page.wait_for_selector: Unexpected token "/" while parsing css selector "#content-mainGOTO
        http://127.0.0.1:8010/admin/". Did you mean to CSS.escape it?
        Call log:
          - waiting for #content-mainGOTO  http://127.0.0.1:8010/admin/ to be visible

url   : http://127.0.0.1:8010/admin/

i     : 6
cmd   : WAIT
arg   : SELECTOR #content-mainGOTO  http://127.0.0.1:8010/admin/
error : Error: Page.wait_for_selector: Unexpected token "/" while parsing css selector "#content-mainGOTO
        http://127.0.0.1:8010/admin/". Did you mean to CSS.escape it?
        Call log:
          - waiting for #content-mainGOTO  http://127.0.0.1:8010/admin/ to be visible

url   : http://127.0.0.1:8010/admin/



PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # === create & run: ops\fix_equipment_list_r4_hotfix.ps1 (PS 5.1) ===
$ErrorActionPreference="Stop"

function W([string]$p,[string]$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }

$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
$val = "ops\flows\equipment_ui_create_validate.flow"

$base="http://127.0.0.1:8010"
$user="admin"
$pass="Admin!2345"

$LOGIN = @"
GOTO  $base/admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  $user
FILL  input[name=password]  $pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main
"@

# Attribute selector yok, sadece sınıf/id
$TO_LIST = @"
GOTO  $base/admin/
WAIT  SELECTOR #content-main
WAIT  SELECTOR .model-equipment a
CLICK .model-equipment a
WAIT  SELECTOR #changelist
WAIT  SELECTOR .object-tools a.addlink
"@

# --- Satır sonu garanti: LOGIN + newline + TO_LIST ---
$txt = ($LOGIN.TrimEnd("`r","`n") + "`r`n" + $TO_LIST.TrimStart("`r","`n"))

if (Test-Path $chg){ W $chg $txt; Write-Host "[ok] rewrote: $(Split-Path $chg -Leaf)" -ForegroundColor Green }
if (Test-Path $val){ W $val $txt; Write-Host "[ok] rewrote: $(Split-Path $val -Leaf)" -ForegroundColor Green }

[ok] rewrote: __make_baseline_admin_equipment_change.flow
[ok] rewrote: equipment_ui_create_validate.flow
PS C:\dev\bakim_kalibrasyon>
(venv) powershell -ExecutionPolicy Bypass -File ops\fix_equipment_list_r4_hotfix.ps1

The argument 'ops\fix_equipment_list_r4_hotfix.ps1' to the -File parameter does not exist. Provide the path to an existi
ng '.ps1' file as an argument to the -File parameter.
Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

Try the new cross-platform PowerShell https://aka.ms/pscore6
PS C:\dev\bakim_kalibrasyon>
(venv) $base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*"          -BaseUrl $base

==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1
PS C:\dev\bakim_kalibrasyon>
(venv) $J="_otokodlama\out\__make_baseline_admin_equipment_change.json"; if(Test-Path $J){ (gc $J -Raw|ConvertFrom-Json).results | ?{ -not $_.ok } | select i,cmd,arg,error,url }
$J="_otokodlama\out\equipment_ui_create_validate.json"; if(Test-Path $J){ (gc $J -Raw|ConvertFrom-Json).results | ?{ -not $_.ok } | select i,cmd,arg,error,url }



i     : 10
cmd   : CLICK
arg   : .model-equipment a
error : Error: navigation-error
url   : chrome-error://chromewebdata/

i     : 10
cmd   : CLICK
arg   : .model-equipment a
error : Error: navigation-error
url   : chrome-error://chromewebdata/



PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # === create: ops\fix_equipment_list_r5.ps1 (PS 5.1, ASCII) ===
$ErrorActionPreference="Stop"

function W([string]$p,[string]$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }

$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
$val = "ops\flows\equipment_ui_create_validate.flow"

$base="http://127.0.0.1:8010"
$user="admin"
$pass="Admin!2345"

# Güvenli login (absolute URL + net bir bekleme)
$LOGIN = @"
GOTO  $base/admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  $user
FILL  input[name=password]  $pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main
"@

# Admin index yerine: direkt ADD sayfasına git -> breadcrumb ile listeye dön
# (Sadece class/id ve nth-child kullandık; attribute/yol yok)
$TO_LIST_FROM_ADD = @"
GOTO  $base/admin/maintenance/equipment/add/
WAIT  SELECTOR form
WAIT  SELECTOR .breadcrumbs
WAIT  SELECTOR .breadcrumbs li:nth-child(2) a
CLICK .breadcrumbs li:nth-child(2) a
WAIT  SELECTOR #changelist
WAIT  SELECTOR table#result_list, .paginator, p.no-results
"@

# Satır sonları net olsun diye trim + araya CRLF
$txt = ($LOGIN.TrimEnd("`r","`n") + "`r`n" + $TO_LIST_FROM_ADD.TrimStart("`r","`n"))

if (Test-Path $chg){ W $chg $txt; Write-Host "[ok] rewrote: $(Split-Path $chg -Leaf)" -ForegroundColor Green }
if (Test-Path $val){ W $val $txt; Write-Host "[ok] rewrote: $(Split-Path $val -Leaf)" -ForegroundColor Green }

[ok] rewrote: __make_baseline_admin_equipment_change.flow
[ok] rewrote: equipment_ui_create_validate.flow
PS C:\dev\bakim_kalibrasyon>
(venv) powershell -ExecutionPolicy Bypass -File ops\fix_equipment_list_r5.ps1

# (takılı süreç varsa temizlemek istersen)
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force

$base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*"          -BaseUrl $base

The argument 'ops\fix_equipment_list_r5.ps1' to the -File parameter does not exist. Provide the path to an existing '.ps
1' file as an argument to the -File parameter.
Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

Try the new cross-platform PowerShell https://aka.ms/pscore6
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1
PS C:\dev\bakim_kalibrasyon>
(venv) $J="_otokodlama\out\__make_baseline_admin_equipment_change.json"; if(Test-Path $J){ (gc $J -Raw|ConvertFrom-Json).results | ?{ -not $_.ok } | select i,cmd,arg,error,url }
$J="_otokodlama\out\equipment_ui_create_validate.json"; if(Test-Path $J){ (gc $J -Raw|ConvertFrom-Json).results | ?{ -not $_.ok } | select i,cmd,arg,error,url }



i     : 10
cmd   : WAIT
arg   : SELECTOR .breadcrumbs li:nth-child(2) a
error : TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded.
        Call log:
          - waiting for locator(".breadcrumbs li:nth-child(2) a") to be visible

url   : http://127.0.0.1:8010/admin/maintenance/equipment/add/

i     : 10
cmd   : WAIT
arg   : SELECTOR .breadcrumbs li:nth-child(2) a
error : TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded.
        Call log:
          - waiting for locator(".breadcrumbs li:nth-child(2) a") to be visible

url   : http://127.0.0.1:8010/admin/maintenance/equipment/add/



PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # === create & run: ops\fix_equipment_list_r6.ps1 (PS 5.1, ASCII) ===
$ErrorActionPreference="Stop"

function W([string]$p,[string]$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }

$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
$val = "ops\flows\equipment_ui_create_validate.flow"

$base="http://127.0.0.1:8010"
$user="admin"
$pass="Admin!2345"

# Güvenli login (absolute URL + net bekleme)
$LOGIN = @"
GOTO  $base/admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  $user
FILL  input[name=password]  $pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main
"@

# ADD → breadcrumb son link (Equipment) → liste
$TO_LIST_FROM_ADD = @"
GOTO  $base/admin/maintenance/equipment/add/
WAIT  SELECTOR form
WAIT  SELECTOR .breadcrumbs
WAIT  SELECTOR .breadcrumbs a:last-of-type
CLICK .breadcrumbs a:last-of-type
WAIT  SELECTOR #changelist
WAIT  SELECTOR table#result_list, .paginator, p.no-results
"@

# Satır sonlarını garanti et (CRLF)
$txt = ($LOGIN.TrimEnd("`r","`n") + "`r`n" + $TO_LIST_FROM_ADD.TrimStart("`r","`n"))

if (Test-Path $chg){ W $chg $txt; Write-Host "[ok] rewrote: $(Split-Path $chg -Leaf)" -ForegroundColor Green }
if (Test-Path $val){ W $val $txt; Write-Host "[ok] rewrote: $(Split-Path $val -Leaf)" -ForegroundColor Green }

[ok] rewrote: __make_baseline_admin_equipment_change.flow
[ok] rewrote: equipment_ui_create_validate.flow
PS C:\dev\bakim_kalibrasyon>
(venv) cs
>> TerminatingError(): "The term 'cs' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again."
The term 'cs' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
cs : The term 'cs' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the
spelling of the name, or if a path was included, verify that the path is correct and try again.
At line:1 char:1
+ cs
+ ~~
    + CategoryInfo          : ObjectNotFound: (cs:String) [], ParentContainsErrorRecordException
    + FullyQualifiedErrorId : CommandNotFoundException

PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # takılı browser'ları kapatmak istersen
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force

$base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*"          -BaseUrl $base

==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1
PS C:\dev\bakim_kalibrasyon>
(venv) $J="_otokodlama\out\__make_baseline_admin_equipment_change.json"; if(Test-Path $J){ (gc $J -Raw|ConvertFrom-Json).results | ?{ -not $_.ok } | select i,cmd,arg,error,url }
$J="_otokodlama\out\equipment_ui_create_validate.json"; if(Test-Path $J){ (gc $J -Raw|ConvertFrom-Json).results | ?{ -not $_.ok } | select i,cmd,arg,error,url }



i     : 11
cmd   : CLICK
arg   : .breadcrumbs a:last-of-type
error : Error: navigation-error
url   : chrome-error://chromewebdata/

i     : 11
cmd   : CLICK
arg   : .breadcrumbs a:last-of-type
error : Error: navigation-error
url   : chrome-error://chromewebdata/



PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # === create & run: ops\fix_equipment_list_r7.ps1 (PS 5.1, ASCII) ===
$ErrorActionPreference="Stop"

function W([string]$p,[string]$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }

$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
$val = "ops\flows\equipment_ui_create_validate.flow"

$base="http://127.0.0.1:8010"
$user="admin"
$pass="Admin!2345"

# Güvenli login (absolute URL + net bekleme)
$LOGIN = @"
GOTO  $base/admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  $user
FILL  input[name=password]  $pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main
"@

# EN KRİTİK KISIM: Direkt listeye git (_direct/) — klik yok
$TO_DIRECT = @"
GOTO  $base/admin/maintenance/equipment/_direct/
WAIT  SELECTOR #content-main
WAIT  SELECTOR table#result_list
"@

# VALIDATE için: içerik geldi mi? (satır varsa yakala; yoksa no-results/paginator)
$VALIDATE_TAIL = @"
WAIT  SELECTOR table#result_list tbody tr, p.no-results, .paginator
"@

# Satır sonlarını garanti et (CRLF)
$head = ($LOGIN.TrimEnd("`r","`n") + "`r`n" + $TO_DIRECT.TrimStart("`r","`n"))

if (Test-Path $chg) {
  W $chg $head
  Write-Host "[ok] rewrote: $(Split-Path $chg -Leaf)" -ForegroundColor Green
}

if (Test-Path $val) {
  W $val ($head + $VALIDATE_TAIL)
  Write-Host "[ok] rewrote: $(Split-Path $val -Leaf)" -ForegroundColor Green
}

[ok] rewrote: __make_baseline_admin_equipment_change.flow
[ok] rewrote: equipment_ui_create_validate.flow
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # Düzeltmeyi çalıştır
powershell -ExecutionPolicy Bypass -File ops\fix_equipment_list_r7.ps1

# (İstersen) takılı browser süreçleri
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force

# Sadece iki akış
$base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*"          -BaseUrl $base

# Özet
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"

The argument 'ops\fix_equipment_list_r7.ps1' to the -File parameter does not exist. Provide the path to an existing '.ps
1' file as an argument to the -File parameter.
Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

Try the new cross-platform PowerShell https://aka.ms/pscore6
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1

==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Ca
ll log:   - wa...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Cal
l log:   - wa...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) $J="_otokodlama\out\__make_baseline_admin_equipment_change.json"; if(Test-Path $J){ (gc $J -Raw|ConvertFrom-Json).results | ?{ -not $_.ok } | select i,cmd,arg,error,url }
$J="_otokodlama\out\equipment_ui_create_validate.json"; if(Test-Path $J){ (gc $J -Raw|ConvertFrom-Json).results | ?{ -not $_.ok } | select i,cmd,arg,error,url }



i     : 9
cmd   : WAIT
arg   : SELECTOR table#result_list
error : TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded.
        Call log:
          - waiting for locator("table#result_list") to be visible

url   : http://127.0.0.1:8010/admin/

i     : 9
cmd   : WAIT
arg   : SELECTOR table#result_listWAIT  SELECTOR table#result_list tbody tr, p.no-results, .paginator
error : TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded.
        Call log:
          - waiting for locator("table#result_listWAIT  SELECTOR table#result_list tbody tr, p.no-results,
        .paginator") to be visible

url   : http://127.0.0.1:8010/admin/



PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # === create & run: ops\fix_equipment_list_r7.ps1 (PS 5.1, ASCII) ===
$ErrorActionPreference="Stop"

function W([string]$p,[string]$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }

$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
$val = "ops\flows\equipment_ui_create_validate.flow"

$base="http://127.0.0.1:8010"
$user="admin"
$pass="Admin!2345"

# Güvenli login (absolute URL + net bekleme)
$LOGIN = @"
GOTO  $base/admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  $user
FILL  input[name=password]  $pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main
"@

# EN KRİTİK KISIM: Direkt listeye git (_direct/) — klik yok
$TO_DIRECT = @"
GOTO  $base/admin/maintenance/equipment/_direct/
WAIT  SELECTOR #content-main
WAIT  SELECTOR table#result_list
"@

# VALIDATE için: içerik geldi mi? (satır varsa yakala; yoksa no-results/paginator)
$VALIDATE_TAIL = @"
WAIT  SELECTOR table#result_list tbody tr, p.no-results, .paginator
"@

# Satır sonlarını garanti et (CRLF)
$head = ($LOGIN.TrimEnd("`r","`n") + "`r`n" + $TO_DIRECT.TrimStart("`r","`n"))

if (Test-Path $chg) {
  W $chg $head
  Write-Host "[ok] rewrote: $(Split-Path $chg -Leaf)" -ForegroundColor Green
}

if (Test-Path $val) {
  W $val ($head + $VALIDATE_TAIL)
  Write-Host "[ok] rewrote: $(Split-Path $val -Leaf)" -ForegroundColor Green
}

[ok] rewrote: __make_baseline_admin_equipment_change.flow
[ok] rewrote: equipment_ui_create_validate.flow
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # Düzeltmeyi çalıştır
powershell -ExecutionPolicy Bypass -File ops\fix_equipment_list_r7.ps1

# (İstersen) takılı browser süreçleri
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force

# Sadece iki akış
$base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*"          -BaseUrl $base

# Özet
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"

The argument 'ops\fix_equipment_list_r7.ps1' to the -File parameter does not exist. Provide the path to an existing '.ps
1' file as an argument to the -File parameter.
Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

Try the new cross-platform PowerShell https://aka.ms/pscore6
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1

==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Ca
ll log:   - wa...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Cal
l log:   - wa...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) $J="_otokodlama\out\__make_baseline_admin_equipment_change.json"; if(Test-Path $J){ (gc $J -Raw|ConvertFrom-Json).results | ?{ -not $_.ok } | select i,cmd,arg,error,url }
$J="_otokodlama\out\equipment_ui_create_validate.json"; if(Test-Path $J){ (gc $J -Raw|ConvertFrom-Json).results | ?{ -not $_.ok } | select i,cmd,arg,error,url }



i     : 9
cmd   : WAIT
arg   : SELECTOR table#result_list
error : TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded.
        Call log:
          - waiting for locator("table#result_list") to be visible

url   : http://127.0.0.1:8010/admin/

i     : 9
cmd   : WAIT
arg   : SELECTOR table#result_listWAIT  SELECTOR table#result_list tbody tr, p.no-results, .paginator
error : TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded.
        Call log:
          - waiting for locator("table#result_listWAIT  SELECTOR table#result_list tbody tr, p.no-results,
        .paginator") to be visible

url   : http://127.0.0.1:8010/admin/



PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # Başlangıçta eski süreçleri kapatın
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force

# Düzeltmeyi çalıştır (varsa ve git pull yaptıysanız)
powershell -ExecutionPolicy Bypass -File ops\fix_equipment_list_r7.ps1

# Sadece iki akış (tarayıcı kapatma komutları bu aradan kaldırıldı)
$base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*" -BaseUrl $base

# Özet
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"

# İşiniz bitince tarayıcı süreçlerini kapatabilirsiniz
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force
The argument 'ops\fix_equipment_list_r7.ps1' to the -File parameter does not exist. Provide the path to an existing '.ps
1' file as an argument to the -File parameter.
Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

Try the new cross-platform PowerShell https://aka.ms/pscore6
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1

==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Ca
ll log:   - wa...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Cal
l log:   - wa...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # === create & run: ops\fix_equipment_list_r7.ps1 (PS 5.1, ASCII) ===
$ErrorActionPreference="Stop"

function W([string]$p,[string]$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }

$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
$val = "ops\flows\equipment_ui_create_validate.flow"

$base="http://127.0.0.1:8010"
$user="admin"
$pass="Admin!2345"

# Güvenli login (absolute URL + net bekleme)
$LOGIN = @"
GOTO  $base/admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  $user
FILL  input[name=password]  $pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main
"@

# EN KRİTİK KISIM: Direkt listeye git (_direct/) — klik yok
$TO_DIRECT = @"
GOTO  $base/admin/maintenance/equipment/_direct/
WAIT  SELECTOR #content-main
WAIT  SELECTOR table#result_list
"@

# VALIDATE için: içerik geldi mi? (satır varsa yakala; yoksa no-results/paginator)
$VALIDATE_TAIL = @"
WAIT  SELECTOR table#result_list tbody tr, p.no-results, .paginator
"@

# Satır sonlarını garanti et (CRLF)
$head = ($LOGIN.TrimEnd("`r","`n") + "`r`n" + $TO_DIRECT.TrimStart("`r","`n"))

if (Test-Path $chg) {
  W $chg $head
  Write-Host "[ok] rewrote: $(Split-Path $chg -Leaf)" -ForegroundColor Green
}

if (Test-Path $val) {
  W $val ($head + $VALIDATE_TAIL)
  Write-Host "[ok] rewrote: $(Split-Path $val -Leaf)" -ForegroundColor Green
}

[ok] rewrote: __make_baseline_admin_equipment_change.flow
[ok] rewrote: equipment_ui_create_validate.flow
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # === create & run: ops\fix_equipment_list_r7.ps1 (PS 5.1, ASCII) ===
$ErrorActionPreference="Stop"

function W([string]$p,[string]$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }

$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
$val = "ops\flows\equipment_ui_create_validate.flow"

$base="http://127.0.0.1:8010"
$user="admin"
$pass="Admin!2345"

# Güvenli login (absolute URL + net bekleme)
$LOGIN = @"
GOTO  $base/admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  $user
FILL  input[name=password]  $pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main
"@

# EN KRİTİK KISIM: Direkt listeye git (_direct/) — klik yok
$TO_DIRECT = @"
GOTO  $base/admin/maintenance/equipment/_direct/
WAIT  SELECTOR #content-main
WAIT  SELECTOR table#result_list
"@

# VALIDATE için: içerik geldi mi? (satır varsa yakala; yoksa no-results/paginator)
$VALIDATE_TAIL = @"
WAIT  SELECTOR table#result_list tbody tr, p.no-results, .paginator
"@

# Satır sonlarını garanti et (CRLF)
$head = ($LOGIN.TrimEnd("`r","`n") + "`r`n" + $TO_DIRECT.TrimStart("`r","`n"))

if (Test-Path $chg) {
  W $chg $head
  Write-Host "[ok] rewrote: $(Split-Path $chg -Leaf)" -ForegroundColor Green
}

if (Test-Path $val) {
  W $val ($head + $VALIDATE_TAIL)
  Write-Host "[ok] rewrote: $(Split-Path $val -Leaf)" -ForegroundColor Green
}

[ok] rewrote: __make_baseline_admin_equipment_change.flow
[ok] rewrote: equipment_ui_create_validate.flow
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # 1. 'ops' klasörünün varlığını kontrol et ve yoksa oluştur
if (-not (Test-Path -Path '.\ops' -PathType Container)) {
    New-Item -Path '.\ops' -ItemType Directory -Force | Out-Null
}

# 2. Betik içeriğini bir değişkene atama
$scriptContent = @'
# === create & run: ops\fix_equipment_list_r7.ps1 (PS 5.1, ASCII) ===
$ErrorActionPreference="Stop"

function W([string]$p,[string]$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }

$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
$val = "ops\flows\equipment_ui_create_validate.flow"

$base="http://127.0.0.1:8010"
$user="admin"
$pass="Admin!2345"

# Güvenli login (absolute URL + net bekleme)
$LOGIN = @"
GOTO  $base/admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  $user
FILL  input[name=password]  $pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main
"@

# EN KRİTİK KISIM: Direkt listeye git (_direct/) — klik yok
$TO_DIRECT = @"
GOTO  $base/admin/maintenance/equipment/_direct/
WAIT  SELECTOR #content-main
WAIT  SELECTOR table#result_list
"@

# VALIDATE için: içerik geldi mi? (satır varsa yakala; yoksa no-results/paginator)
# BU DÜZELTME, ÖNCEKİ HATALI WAIT KOMUTUNU (table#result_listWAIT SELECTOR...) TEMİZLEYECEKTİR
$VALIDATE_TAIL = @"
WAIT  SELECTOR table#result_list tbody tr, p.no-results, .paginator
"@

# Satır sonlarını garanti et (CRLF)
$head = ($LOGIN.TrimEnd("`r","`n") + "`r`n" + $TO_DIRECT.TrimStart("`r","`n"))

if (Test-Path $chg) {
  W $chg $head
  Write-Host "[ok] rewrote: $(Split-Path $chg -Leaf)" -ForegroundColor Green
}

if (Test-Path $val) {
  W $val ($head + $VALIDATE_TAIL)
  Write-Host "[ok] rewrote: $(Split-Path $val -Leaf)" -ForegroundColor Green
}
'@

# 3. Betiği dosyaya yazma
Set-Content -Path '.\ops\fix_equipment_list_r7.ps1' -Value $scriptContent -Encoding ASCII

# 4. Onay mesajı
Write-Host "[OK] 'ops\fix_equipment_list_r7.ps1' dosyası başarıyla oluşturuldu." -ForegroundColor Cyan
[OK] 'ops\fix_equipment_list_r7.ps1' dosyası başarıyla oluşturuldu.
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # (venv) PS C:\dev\bakim_kalibrasyon> # Düzeltmeyi çalıştır
powershell -ExecutionPolicy Bypass -File ops\fix_equipment_list_r7.ps1

# (venv) PS C:\dev\bakim_kalibrasyon> # Diğer akışları çalıştırmaya devam et
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force
$base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*" -BaseUrl $base

# Özet
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"
[ok] rewrote: __make_baseline_admin_equipment_change.flow
[ok] rewrote: equipment_ui_create_validate.flow
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1

==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Ca
ll log:   - wa...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Cal
l log:   - wa...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # 1. 'ops\fix_equipment_list_r7.ps1' içeriğini 30 saniyelik TIMEOUT eklenmiş haliyle yeniden tanımlama
$scriptContent_30s = @'
# === fix_equipment_list_r7.ps1: 30s TIMEOUT (PS 5.1, ASCII) ===
$ErrorActionPreference="Stop"

function W([string]$p,[string]$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }

$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
$val = "ops\flows\equipment_ui_create_validate.flow"

$base="http://127.0.0.1:8010"
$user="admin"
$pass="Admin!2345"

# 30 saniyelik zaman aşımı komutunu ekleme
$TIMEOUT_30S = "TIMEOUT 30000`r`n"

# Güvenli login (absolute URL + net bekleme)
$LOGIN = @"
GOTO  $base/admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  $user
FILL  input[name=password]  $pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main
"@

# EN KRİTİK KISIM: Direkt listeye git (_direct/) — klik yok
$TO_DIRECT = @"
GOTO  $base/admin/maintenance/equipment/_direct/
WAIT  SELECTOR #content-main
WAIT  SELECTOR table#result_list
"@

# VALIDATE için: içerik geldi mi?
$VALIDATE_TAIL = @"
WAIT  SELECTOR table#result_list tbody tr, p.no-results, .paginator
"@

# Satır sonlarını garanti et (CRLF) ve TIMEOUT ekle
$head = ($TIMEOUT_30S + $LOGIN.TrimEnd("`r","`n") + "`r`n" + $TIMEOUT_30S + $TO_DIRECT.TrimStart("`r","`n"))

if (Test-Path $chg) {
  W $chg $head
  Write-Host "[ok] rewrote: $(Split-Path $chg -Leaf) with 30s timeout" -ForegroundColor Green
}

if (Test-Path $val) {
  W $val ($head + $TIMEOUT_30S + $VALIDATE_TAIL)
  Write-Host "[ok] rewrote: $(Split-Path $val -Leaf) with 30s timeout" -ForegroundColor Green
}
'@

# 2. Betiği dosyaya yazma
Set-Content -Path '.\ops\fix_equipment_list_r7.ps1' -Value $scriptContent_30s -Encoding ASCII

# 3. Güncellenen düzeltme betiğini çalıştır
powershell -ExecutionPolicy Bypass -File ops\fix_equipment_list_r7.ps1

# 4. Akışları tekrar çalıştır
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force
$base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*" -BaseUrl $base

# 5. Özet
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"
[ok] rewrote: __make_baseline_admin_equipment_change.flow with 30s timeout
[ok] rewrote: equipment_ui_create_validate.flow with 30s timeout
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1

==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     Error: Unknown cmd: TIMEOUT
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     Error: Unknown cmd: TIMEOUT
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # 1. 'ops\fix_equipment_list_r7.ps1' içeriğini temizleme ve 30s'yi WAIT komutlarına ekleme (deneme)
$scriptContent_wait_timeout = @'
# === fix_equipment_list_r7.ps1: WAIT Timeout 30000 (PS 5.1, ASCII) ===
$ErrorActionPreference="Stop"

function W([string]$p,[string]$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }

$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
$val = "ops\flows\equipment_ui_create_validate.flow"

$base="http://127.0.0.1:8010"
$user="admin"
$pass="Admin!2345"

# Güvenli login (absolute URL + net bekleme) - WAIT komutlarına 30000ms ekleme
$LOGIN = @"
GOTO  $base/admin/login/
WAIT  SELECTOR input[name=username] 30000
FILL  input[name=username]  $user
FILL  input[name=password]  $pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main 30000
"@

# EN KRİTİK KISIM: Direkt listeye git (_direct/)
$TO_DIRECT = @"
GOTO  $base/admin/maintenance/equipment/_direct/
WAIT  SELECTOR #content-main 30000
WAIT  SELECTOR table#result_list 30000
"@

# VALIDATE için: içerik geldi mi?
$VALIDATE_TAIL = @"
WAIT  SELECTOR table#result_list tbody tr, p.no-results, .paginator 30000
"@

# Satır sonlarını garanti et (CRLF). TIMEOUT komutu YOK.
$head = ($LOGIN.TrimEnd("`r","`n") + "`r`n" + $TO_DIRECT.TrimStart("`r","`n"))

if (Test-Path $chg) {
  W $chg $head
  Write-Host "[ok] rewrote: $(Split-Path $chg -Leaf) with 30s wait timeouts" -ForegroundColor Green
}

if (Test-Path $val) {
  W $val ($head + $VALIDATE_TAIL)
  Write-Host "[ok] rewrote: $(Split-Path $val -Leaf) with 30s wait timeouts" -ForegroundColor Green
}
'@

# 2. Betiği dosyaya yazma
Set-Content -Path '.\ops\fix_equipment_list_r7.ps1' -Value $scriptContent_wait_timeout -Encoding ASCII

# 3. Güncellenen düzeltme betiğini çalıştır
powershell -ExecutionPolicy Bypass -File ops\fix_equipment_list_r7.ps1

# 4. Akışları tekrar çalıştır
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force
$base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*" -BaseUrl $base

# 5. Özet
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"
[ok] rewrote: __make_baseline_admin_equipment_change.flow with 30s wait timeouts
[ok] rewrote: equipment_ui_create_validate.flow with 30s wait timeouts
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1

==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     Error: Page.wait_for_selector: Unexpected token "30000" while pars
ing css select...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     Error: Page.wait_for_selector: Unexpected token "30000" while parsi
ng css select...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # 1. Flow dosyalarını, hatalı 30000 argümanlarından kurtarmak için SIFIRLAMA (default 10s'ye dönüş)
$scriptContent_cleanup = @'
# === fix_equipment_list_r7.ps1: CLEANUP (PS 5.1, ASCII) ===
$ErrorActionPreference="Stop"

function W([string]$p,[string]$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }

$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
$val = "ops\flows\equipment_ui_create_validate.flow"

$base="http://127.0.0.1:8010"
$user="admin"
$pass="Admin!2345"

# Güvenli login (absolute URL + net bekleme) - Zaman aşımı parametresi YOK.
$LOGIN = @"
GOTO  $base/admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  $user
FILL  input[name=password]  $pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main
"@

# EN KRİTİK KISIM: Direkt listeye git (_direct/)
$TO_DIRECT = @"
GOTO  $base/admin/maintenance/equipment/_direct/
WAIT  SELECTOR #content-main
WAIT  SELECTOR table#result_list
"@

# VALIDATE için: içerik geldi mi?
$VALIDATE_TAIL = @"
WAIT  SELECTOR table#result_list tbody tr, p.no-results, .paginator
"@

# Satır sonlarını garanti et (CRLF)
$head = ($LOGIN.TrimEnd("`r","`n") + "`r`n" + $TO_DIRECT.TrimStart("`r","`n"))

if (Test-Path $chg) {
  W $chg $head
  Write-Host "[ok] rewrote: $(Split-Path $chg -Leaf) (CLEANUP)" -ForegroundColor Yellow
}

if (Test-Path $val) {
  W $val ($head + $VALIDATE_TAIL)
  Write-Host "[ok] rewrote: $(Split-Path $val -Leaf) (CLEANUP)" -ForegroundColor Yellow
}
'@

# 2. Betiği dosyaya yazma
Set-Content -Path '.\ops\fix_equipment_list_r7.ps1' -Value $scriptContent_cleanup -Encoding ASCII

# 3. Temizleme düzeltmesini çalıştır
powershell -ExecutionPolicy Bypass -File ops\fix_equipment_list_r7.ps1
[ok] rewrote: __make_baseline_admin_equipment_change.flow (CLEANUP)
[ok] rewrote: equipment_ui_create_validate.flow (CLEANUP)
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # 1. Tarayıcıları kapat
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force

# 2. Akışları 30 saniyelik zaman aşımı ile çalıştır (Zaman aşımı artık run_backlog_beep.ps1 içindeki kodda ayarlı)
$base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*" -BaseUrl $base

# 3. Özet
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1

==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Ca
ll log:   - wa...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Cal
l log:   - wa...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # 1. Tarayıcıları kapat
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force

# 2. Akışları 30 saniyelik zaman aşımı ile çalıştır (Artık run_backlog_beep.ps1 içinde ayarlı)
$base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*" -BaseUrl $base

# 3. Özet
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1

==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Ca
ll log:   - wa...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Cal
l log:   - wa...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # 1. Tarayıcıları kapat
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force

# 2. Base URL tanımlama
$base="http://127.0.0.1:8010"
$outDir="_otokodlama\out"

# 3. İki başarısız akışı doğrudan 30 saniyelik zaman aşımı ile çalıştır
# NOT: run_backlog_beep.ps1 atlanmıştır. pw_flow.py doğrudan çağrılır.
python tools\pw_flow.py --timeout 30000 --steps "ops\flows\__make_baseline_admin_equipment_change.flow" --out "$outDir\__make_baseline_admin_equipment_change.json"
python tools\pw_flow.py --timeout 30000 --steps "ops\flows\equipment_ui_create_validate.flow" --out "$outDir\equipment_ui_create_validate.json"

# 4. Özet raporunu oluştur (Tüm testlerin sonuçlarını raporlar)
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir $outDir
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --timeout 30000
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --timeout 30000

==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Ca
ll log:   - wa...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Cal
l log:   - wa...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # Playwright kodunda bu satırları arayın ve değiştirin:
context.set_default_timeout(30000)  # VEYA
page.set_default_timeout(30000)
>> TerminatingError(): "The term 'context.set_default_timeout' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again."
The term 'context.set_default_timeout' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
context.set_default_timeout : The term 'context.set_default_timeout' is not recognized as the name of a cmdlet,
function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the
path is correct and try again.
At line:2 char:1
+ context.set_default_timeout(30000)  # VEYA
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (context.set_default_timeout:String) [], ParentContainsErrorRecordExcept
   ion
    + FullyQualifiedErrorId : CommandNotFoundException

PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # Temizleme betiğini tekrar oluşturma ve çalıştırma (varsayılan ayarlara dönmek için)
$scriptContent_cleanup = @'
# === fix_equipment_list_r7.ps1: CLEANUP (PS 5.1, ASCII) ===
$ErrorActionPreference="Stop"
function W([string]$p,[string]$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }
$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
$val = "ops\flows\equipment_ui_create_validate.flow"
$base="http://127.0.0.1:8010"
$user="admin"
$pass="Admin!2345"
$LOGIN = @"
GOTO  $base/admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  $user
FILL  input[name=password]  $pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main
"@
$TO_DIRECT = @"
GOTO  $base/admin/maintenance/equipment/_direct/
WAIT  SELECTOR #content-main
WAIT  SELECTOR table#result_list
"@
$VALIDATE_TAIL = @"
WAIT  SELECTOR table#result_list tbody tr, p.no-results, .paginator
"@
$head = ($LOGIN.TrimEnd("`r","`n") + "`r`n" + $TO_DIRECT.TrimStart("`r","`n"))
if (Test-Path $chg) { W $chg $head; Write-Host "[ok] rewrote: $(Split-Path $chg -Leaf) (CLEANUP)" -ForegroundColor Yellow }
if (Test-Path $val) { W $val ($head + $VALIDATE_TAIL); Write-Host "[ok] rewrote: $(Split-Path $val -Leaf) (CLEANUP)" -ForegroundColor Yellow }
'@
Set-Content -Path '.\ops\fix_equipment_list_r7.ps1' -Value $scriptContent_cleanup -Encoding ASCII
powershell -ExecutionPolicy Bypass -File ops\fix_equipment_list_r7.ps1
[ok] rewrote: __make_baseline_admin_equipment_change.flow (CLEANUP)
[ok] rewrote: equipment_ui_create_validate.flow (CLEANUP)
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # 1. Tarayıcıları kapat
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force

# 2. Akışları çalıştır (Şimdi 30s zaman aşımı, pw_flow.py içinde sabitlenmiştir)
$base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*" -BaseUrl $base

# 3. Özet
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1

==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Ca
ll log:   - wa...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Cal
l log:   - wa...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) Write-Host "--- __make_baseline_admin_equipment_change.flow İçeriği ---"
Get-Content -Path "ops\flows\__make_baseline_admin_equipment_change.flow" -Raw

Write-Host "`n--- equipment_ui_create_validate.flow İçeriği ---"
Get-Content -Path "ops\flows\equipment_ui_create_validate.flow" -Raw
--- __make_baseline_admin_equipment_change.flow İçeriği ---
GOTO  http://127.0.0.1:8010/admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  admin
FILL  input[name=password]  Admin!2345
CLICK input[type=submit]
WAIT  SELECTOR #content-main
GOTO  http://127.0.0.1:8010/admin/maintenance/equipment/_direct/
WAIT  SELECTOR #content-main
WAIT  SELECTOR table#result_list

--- equipment_ui_create_validate.flow İçeriği ---
GOTO  http://127.0.0.1:8010/admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  admin
FILL  input[name=password]  Admin!2345
CLICK input[type=submit]
WAIT  SELECTOR #content-main
GOTO  http://127.0.0.1:8010/admin/maintenance/equipment/_direct/
WAIT  SELECTOR #content-main
WAIT  SELECTOR table#result_listWAIT  SELECTOR table#result_list tbody tr, p.no-results, .paginator
PS C:\dev\bakim_kalibrasyon>
(venv) # 1. 'ops\fix_equipment_list_r7.ps1' içeriğini son, doğru, temiz haliyle yeniden tanımlama
$scriptContent_final_cleanup = @'
# === fix_equipment_list_r7.ps1: FINAL CLEANUP (PS 5.1, ASCII) ===
$ErrorActionPreference="Stop"

function W([string]$p,[string]$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }

$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
$val = "ops\flows\equipment_ui_create_validate.flow"

$base="http://127.0.0.1:8010"
$user="admin"
$pass="Admin!2345"

# Güvenli login
$LOGIN = @"
GOTO  $base/admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  $user
FILL  input[name=password]  $pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main
"@

# EN KRİTİK KISIM: Direkt listeye git (_direct/)
$TO_DIRECT = @"
GOTO  $base/admin/maintenance/equipment/_direct/
WAIT  SELECTOR #content-main
WAIT  SELECTOR table#result_list
"@

# VALIDATE için: İçerik kontrolü (İKİ AYRI SATIR)
$VALIDATE_TAIL = @"
WAIT  SELECTOR table#result_list
WAIT  SELECTOR table#result_list tbody tr, p.no-results, .paginator
"@

# Satır sonlarını garanti et (CRLF)
$head = ($LOGIN.TrimEnd("`r","`n") + "`r`n" + $TO_DIRECT.TrimStart("`r","`n"))

if (Test-Path $chg) {
  W $chg $head
  Write-Host "[ok] rewrote: $(Split-Path $chg -Leaf) (FINAL CLEANUP)" -ForegroundColor Yellow
}

if (Test-Path $val) {
  # equipment_ui_create_validate.flow için en son bekleme satırını ekle
  W $val ($head + $VALIDATE_TAIL)
  Write-Host "[ok] rewrote: $(Split-Path $val -Leaf) (FINAL CLEANUP)" -ForegroundColor Yellow
}
'@

# 2. Betiği dosyaya yazma
Set-Content -Path '.\ops\fix_equipment_list_r7.ps1' -Value $scriptContent_final_cleanup -Encoding ASCII
Write-Host "[OK] 'ops\fix_equipment_list_r7.ps1' dosyası nihai temizlik için güncellendi." -ForegroundColor Cyan

# 3. Temizleme düzeltmesini çalıştır
powershell -ExecutionPolicy Bypass -File ops\fix_equipment_list_r7.ps1
[OK] 'ops\fix_equipment_list_r7.ps1' dosyası nihai temizlik için güncellendi.
[ok] rewrote: __make_baseline_admin_equipment_change.flow (FINAL CLEANUP)
[ok] rewrote: equipment_ui_create_validate.flow (FINAL CLEANUP)
PS C:\dev\bakim_kalibrasyon>
(venv) # 1. Tarayıcıları kapat
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force

# 2. Akışları çalıştır
$base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*" -BaseUrl $base

# 3. Özet
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1

==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Ca
ll log:   - wa...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Cal
l log:   - wa...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # 1. 'ops\fix_equipment_list_r7.ps1' içeriğini, WAIT komutlarından önce bir bekleme ekleyerek yeniden tanımlama
$scriptContent_final_fix = @'
# === fix_equipment_list_r7.ps1: FINAL FIX (PS 5.1, ASCII) ===
$ErrorActionPreference="Stop"

function W([string]$p,[string]$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }

$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
$val = "ops\flows\equipment_ui_create_validate.flow"

$base="http://127.0.0.1:8010"
$user="admin"
$pass="Admin!2345"

# LOGIN (Değişiklik yok)
$LOGIN = @"
GOTO  $base/admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  $user
FILL  input[name=password]  $pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main
"@

# EN KRİTİK KISIM: Direkt listeye git (_direct/) ve kısa bir bekleme ekle
$TO_DIRECT = @"
GOTO  $base/admin/maintenance/equipment/_direct/
WAIT  SELECTOR #content-main
# Buraya 500ms bekleme eklenerek uygulamanın kendine gelmesi sağlanır
WAIT  500
WAIT  SELECTOR table#result_list
"@

# VALIDATE için: İçerik kontrolü
$VALIDATE_TAIL = @"
WAIT  SELECTOR table#result_list
WAIT  SELECTOR table#result_list tbody tr, p.no-results, .paginator
"@

# Satır sonlarını garanti et (CRLF)
$head = ($LOGIN.TrimEnd("`r","`n") + "`r`n" + $TO_DIRECT.TrimStart("`r","`n"))

if (Test-Path $chg) {
  W $chg $head
  Write-Host "[ok] rewrote: $(Split-Path $chg -Leaf) (FINAL FIX - WAIT 500)" -ForegroundColor Green
}

if (Test-Path $val) {
  W $val ($head + $VALIDATE_TAIL)
  Write-Host "[ok] rewrote: $(Split-Path $val -Leaf) (FINAL FIX - WAIT 500)" -ForegroundColor Green
}
'@

# 2. Betiği dosyaya yazma
Set-Content -Path '.\ops\fix_equipment_list_r7.ps1' -Value $scriptContent_final_fix -Encoding ASCII
Write-Host "[OK] 'ops\fix_equipment_list_r7.ps1' dosyası nihai düzeltme için güncellendi." -ForegroundColor Cyan

# 3. Düzeltmeyi çalıştır
powershell -ExecutionPolicy Bypass -File ops\fix_equipment_list_r7.ps1

# 4. Akışları tekrar çalıştır
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force
$base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*" -BaseUrl $base

# 5. Özet
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"
[OK] 'ops\fix_equipment_list_r7.ps1' dosyası nihai düzeltme için güncellendi.
[ok] rewrote: __make_baseline_admin_equipment_change.flow (FINAL FIX - WAIT 500)
[ok] rewrote: equipment_ui_create_validate.flow (FINAL FIX - WAIT 500)
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1

==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     Error: Unsupported WAIT arg: 500
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     Error: Unsupported WAIT arg: 500
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # 1. 'ops\fix_equipment_list_r7.ps1' içeriğini, basit ve temiz flow dosyalarını üretecek şekilde Geri Alma
$scriptContent_rollback = @'
# === fix_equipment_list_r7.ps1: ROLLBACK TO CLEAN FLOWS (PS 5.1, ASCII) ===
$ErrorActionPreference="Stop"

function W([string]$p,[string]$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }

$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
$val = "ops\flows\equipment_ui_create_validate.flow"

$base="http://127.0.0.1:8010"
$user="admin"
$pass="Admin!2345"

$LOGIN = @"
GOTO  $base/admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  $user
FILL  input[name=password]  $pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main
"@

$TO_DIRECT = @"
GOTO  $base/admin/maintenance/equipment/_direct/
WAIT  SELECTOR #content-main
WAIT  SELECTOR table#result_list
"@

$VALIDATE_TAIL = @"
WAIT  SELECTOR table#result_list tbody tr, p.no-results, .paginator
"@

$head = ($LOGIN.TrimEnd("`r","`n") + "`r`n" + $TO_DIRECT.TrimStart("`r","`n"))

if (Test-Path $chg) {
  W $chg $head
  Write-Host "[ok] rewrote: $(Split-Path $chg -Leaf) (ROLLBACK)" -ForegroundColor Cyan
}

if (Test-Path $val) {
  W $val ($head + $VALIDATE_TAIL)
  Write-Host "[ok] rewrote: $(Split-Path $val -Leaf) (ROLLBACK)" -ForegroundColor Cyan
}
'@

# 2. Betiği dosyaya yazma
Set-Content -Path '.\ops\fix_equipment_list_r7.ps1' -Value $scriptContent_rollback -Encoding ASCII

# 3. Geri alma düzeltmesini çalıştır
powershell -ExecutionPolicy Bypass -File ops\fix_equipment_list_r7.ps1
[ok] rewrote: __make_baseline_admin_equipment_change.flow (ROLLBACK)
[ok] rewrote: equipment_ui_create_validate.flow (ROLLBACK)
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # 1. 'ops\fix_equipment_list_r7.ps1' içeriğini, doğru listeleme URL'siyle yeniden tanımlama
$scriptContent_final_url_fix = @'
# === fix_equipment_list_r7.ps1: FINAL URL FIX (PS 5.1, ASCII) ===
$ErrorActionPreference="Stop"

function W([string]$p,[string]$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }

$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
$val = "ops\flows\equipment_ui_create_validate.flow"

$base="http://127.0.0.1:8010"
$user="admin"
$pass="Admin!2345"

# LOGIN (Değişiklik yok)
$LOGIN = @"
GOTO  $base/admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  $user
FILL  input[name=password]  $pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main
"@

# EN KRİTİK KISIM: Direkt URL'yi listeleme URL'siyle değiştirme
$TO_LIST_PAGE = @"
GOTO  $base/admin/maintenance/equipment/  # _direct/ KALDIRILDI
WAIT  SELECTOR #content-main
WAIT  SELECTOR table#result_list
"@

# VALIDATE için: İçerik kontrolü
$VALIDATE_TAIL = @"
WAIT  SELECTOR table#result_list
WAIT  SELECTOR table#result_list tbody tr, p.no-results, .paginator
"@

# Satır sonlarını garanti et (CRLF)
$head = ($LOGIN.TrimEnd("`r","`n") + "`r`n" + $TO_LIST_PAGE.TrimStart("`r","`n"))

if (Test-Path $chg) {
  W $chg $head
  Write-Host "[ok] rewrote: $(Split-Path $chg -Leaf) (FINAL URL FIX)" -ForegroundColor Green
}

if (Test-Path $val) {
  W $val ($head + $VALIDATE_TAIL)
  Write-Host "[ok] rewrote: $(Split-Path $val -Leaf) (FINAL URL FIX)" -ForegroundColor Green
}
'@

# 2. Betiği dosyaya yazma
Set-Content -Path '.\ops\fix_equipment_list_r7.ps1' -Value $scriptContent_final_url_fix -Encoding ASCII
Write-Host "[OK] 'ops\fix_equipment_list_r7.ps1' dosyası URL düzeltmesi için güncellendi." -ForegroundColor Cyan

# 3. Düzeltmeyi çalıştır
powershell -ExecutionPolicy Bypass -File ops\fix_equipment_list_r7.ps1

# 4. Akışları tekrar çalıştır
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force
$base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*" -BaseUrl $base

# 5. Özet
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"
[OK] 'ops\fix_equipment_list_r7.ps1' dosyası URL düzeltmesi için güncellendi.
[ok] rewrote: __make_baseline_admin_equipment_change.flow (FINAL URL FIX)
[ok] rewrote: equipment_ui_create_validate.flow (FINAL URL FIX)
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1

==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Ca
ll log:   - wa...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Cal
l log:   - wa...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # 1. 'ops\fix_equipment_list_r7.ps1' içeriğini, daha sağlam bir seçiciyle yeniden tanımlama
$scriptContent_final_selector_fix = @'
# === fix_equipment_list_r7.ps1: FINAL SELECTOR FIX (PS 5.1, ASCII) ===
$ErrorActionPreference="Stop"

function W([string]$p,[string]$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }

$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
$val = "ops\flows\equipment_ui_create_validate.flow"

$base="http://127.0.0.1:8010"
$user="admin"
$pass="Admin!2345"

# LOGIN
$LOGIN = @"
GOTO  $base/admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  $user
FILL  input[name=password]  $pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main
"@

# EN KRİTİK KISIM: Listeleme sayfasında table#result_list yerine #changelist-form bekle
$TO_LIST_PAGE = @"
GOTO  $base/admin/maintenance/equipment/
WAIT  SELECTOR #content-main
WAIT  SELECTOR #changelist-form  # Tablonun üstündeki ana formu bekle
"@

# VALIDATE için: İçerik kontrolü
$VALIDATE_TAIL = @"
WAIT  SELECTOR #changelist-form
WAIT  SELECTOR table#result_list tbody tr, p.no-results, .paginator
"@

# Satır sonlarını garanti et (CRLF)
$head = ($LOGIN.TrimEnd("`r","`n") + "`r`n" + $TO_LIST_PAGE.TrimStart("`r","`n"))

if (Test-Path $chg) {
  W $chg $head
  Write-Host "[ok] rewrote: $(Split-Path $chg -Leaf) (FINAL SELECTOR FIX)" -ForegroundColor Yellow
}

if (Test-Path $val) {
  W $val ($head + $VALIDATE_TAIL)
  Write-Host "[ok] rewrote: $(Split-Path $val -Leaf) (FINAL SELECTOR FIX)" -ForegroundColor Yellow
}
'@

# 2. Betiği dosyaya yazma
Set-Content -Path '.\ops\fix_equipment_list_r7.ps1' -Value $scriptContent_final_selector_fix -Encoding ASCII
Write-Host "[OK] 'ops\fix_equipment_list_r7.ps1' dosyası seçici düzeltmesi için güncellendi." -ForegroundColor Cyan

# 3. Düzeltmeyi çalıştır
powershell -ExecutionPolicy Bypass -File ops\fix_equipment_list_r7.ps1

# 4. Akışları tekrar çalıştır
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force
$base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*" -BaseUrl $base

# 5. Özet
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"
[OK] 'ops\fix_equipment_list_r7.ps1' dosyası seçici düzeltmesi için güncellendi.
[ok] rewrote: __make_baseline_admin_equipment_change.flow (FINAL SELECTOR FIX)
[ok] rewrote: equipment_ui_create_validate.flow (FINAL SELECTOR FIX)
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1

==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     Error: Page.goto: net::ERR_TOO_MANY_REDIRECTS at http://127.0.0.1:
8010/admin/mai...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     Error: Page.goto: net::ERR_TOO_MANY_REDIRECTS at http://127.0.0.1:8
010/admin/mai...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # 1. 'ops\fix_equipment_list_r7.ps1' içeriğini, URL'yi eğik çizgi olmadan yeniden tanımlama
$scriptContent_final_slash_fix = @'
# === fix_equipment_list_r7.ps1: FINAL SLASH FIX (PS 5.1, ASCII) ===
$ErrorActionPreference="Stop"

function W([string]$p,[string]$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }

$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
$val = "ops\flows\equipment_ui_create_validate.flow"

$base="http://127.0.0.1:8010"
$user="admin"
$pass="Admin!2345"

# LOGIN
$LOGIN = @"
GOTO  $base/admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  $user
FILL  input[name=password]  $pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main
"@

# EN KRİTİK KISIM: URL'nin sonundaki eğik çizgiyi (/) kaldırmak.
# Eğer sunucu '/' eklemek için yönlendiriyorsa ve bu bir döngüye neden oluyorsa,
# bu, döngüyü kırabilir. (equipment/ yerine equipment)
$TO_LIST_PAGE = @"
GOTO  $base/admin/maintenance/equipment  # Sondaki EĞİK ÇİZGİ KALDIRILDI
WAIT  SELECTOR #content-main
WAIT  SELECTOR #changelist-form
"@

# VALIDATE için: İçerik kontrolü
$VALIDATE_TAIL = @"
WAIT  SELECTOR #changelist-form
WAIT  SELECTOR table#result_list tbody tr, p.no-results, .paginator
"@

# Satır sonlarını garanti et (CRLF)
$head = ($LOGIN.TrimEnd("`r","`n") + "`r`n" + $TO_LIST_PAGE.TrimStart("`r","`n"))

if (Test-Path $chg) {
  W $chg $head
  Write-Host "[ok] rewrote: $(Split-Path $chg -Leaf) (SLASH REMOVED FIX)" -ForegroundColor Yellow
}

if (Test-Path $val) {
  W $val ($head + $VALIDATE_TAIL)
  Write-Host "[ok] rewrote: $(Split-Path $val -Leaf) (SLASH REMOVED FIX)" -ForegroundColor Yellow
}
'@

# 2. Betiği dosyaya yazma
Set-Content -Path '.\ops\fix_equipment_list_r7.ps1' -Value $scriptContent_final_slash_fix -Encoding ASCII
Write-Host "[OK] 'ops\fix_equipment_list_r7.ps1' dosyası eğik çizgi düzeltmesi için güncellendi." -ForegroundColor Cyan

# 3. Düzeltmeyi çalıştır
powershell -ExecutionPolicy Bypass -File ops\fix_equipment_list_r7.ps1

# 4. Akışları tekrar çalıştır
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force
$base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*" -BaseUrl $base

# 5. Özet
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"
[OK] 'ops\fix_equipment_list_r7.ps1' dosyası eğik çizgi düzeltmesi için güncellendi.
[ok] rewrote: __make_baseline_admin_equipment_change.flow (SLASH REMOVED FIX)
[ok] rewrote: equipment_ui_create_validate.flow (SLASH REMOVED FIX)
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1

==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Ca
ll log:   - wa...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Cal
l log:   - wa...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # 1. 'ops\fix_equipment_list_r7.ps1' içeriğini, çift yönlendirme ile yeniden tanımlama
$scriptContent_final_double_goto = @'
# === fix_equipment_list_r7.ps1: FINAL DOUBLE GOTO FIX (PS 5.1, ASCII) ===
$ErrorActionPreference="Stop"

function W([string]$p,[string]$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }

$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
$val = "ops\flows\equipment_ui_create_validate.flow"

$base="http://127.0.0.1:8010"
$user="admin"
$pass="Admin!2345"

# LOGIN ve başarılı girişi bekleme
$LOGIN = @"
GOTO  $base/admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  $user
FILL  input[name=password]  $pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main
"@

# KRİTİK KISIM: Girişten sonra admin ana sayfasına GOTO yap
$TO_LIST_PAGE = @"
GOTO  $base/admin/
WAIT  SELECTOR #content-main
GOTO  $base/admin/maintenance/equipment/  # Tam URL'yi eğik çizgi ile kullan
WAIT  SELECTOR #content-main
WAIT  SELECTOR #changelist-form
"@

# VALIDATE için: İçerik kontrolü
$VALIDATE_TAIL = @"
WAIT  SELECTOR #changelist-form
WAIT  SELECTOR table#result_list tbody tr, p.no-results, .paginator
"@

# Satır sonlarını garanti et (CRLF)
$head = ($LOGIN.TrimEnd("`r","`n") + "`r`n" + $TO_LIST_PAGE.TrimStart("`r","`n"))

if (Test-Path $chg) {
  W $chg $head
  Write-Host "[ok] rewrote: $(Split-Path $chg -Leaf) (DOUBLE GOTO FIX)" -ForegroundColor Green
}

if (Test-Path $val) {
  W $val ($head + $VALIDATE_TAIL)
  Write-Host "[ok] rewrote: $(Split-Path $val -Leaf) (DOUBLE GOTO FIX)" -ForegroundColor Green
}
'@

# 2. Betiği dosyaya yazma
Set-Content -Path '.\ops\fix_equipment_list_r7.ps1' -Value $scriptContent_final_double_goto -Encoding ASCII
Write-Host "[OK] 'ops\fix_equipment_list_r7.ps1' dosyası çift yönlendirme düzeltmesi için güncellendi." -ForegroundColor Cyan

# 3. Düzeltmeyi çalıştır
powershell -ExecutionPolicy Bypass -File ops\fix_equipment_list_r7.ps1

# 4. Akışları tekrar çalıştır
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force
$base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*" -BaseUrl $base

# 5. Özet
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"
[OK] 'ops\fix_equipment_list_r7.ps1' dosyası çift yönlendirme düzeltmesi için güncellendi.
[ok] rewrote: __make_baseline_admin_equipment_change.flow (DOUBLE GOTO FIX)
[ok] rewrote: equipment_ui_create_validate.flow (DOUBLE GOTO FIX)
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1

==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Ca
ll log:   - wa...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Cal
l log:   - wa...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # 1. Tarayıcıları kapat
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force

# 2. SADECE ekipman listeleme/doğrulama flow'unu çalıştır
$base="http://127.0.0.1:8010"
# powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base # <-- ATLANDI
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*" -BaseUrl $base

# 3. Özet
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1

==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Ca
ll log:   - wa...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Cal
l log:   - wa...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # maintenance/admin.py
from django.contrib import admin
from .models import Equipment

@admin.register(Equipment)
class EquipmentAdmin(admin.ModelAdmin):
    # Bu kısmı paylaşın
    list_display = ('id', 'tag_number', 'model_name', 'current_status', 'last_calibration_date') 
    
    # Bu kısmı paylaşın
    list_filter = ('current_status', 'department') 

    # Eğer bu sınıfta özel metodlar varsa (list_display içinde kullanılan) onları da paylaşın
    # def custom_method(self, obj):
    #     return obj.some_complex_calculation
At line:2 char:1
+ from django.contrib import admin
+ ~~~~
The 'from' keyword is not supported in this version of the language.

At line:3 char:1
+ from .models import Equipment
+ ~~~~
The 'from' keyword is not supported in this version of the language.

At line:5 char:17
+ @admin.register(Equipment)
+                 ~
Missing ')' in method call.

At line:5 char:17
+ @admin.register(Equipment)
+                 ~~~~~~~~~
Unexpected token 'Equipment' in expression or statement.

At line:5 char:26
+ @admin.register(Equipment)
+                          ~
Unexpected token ')' in expression or statement.

At line:6 char:21
+ class EquipmentAdmin(admin.ModelAdmin):
+                     ~
Missing 'class' body in 'class' declaration.

At line:6 char:39
+ class EquipmentAdmin(admin.ModelAdmin):
+                                       ~
Unexpected token ':' in expression or statement.

At line:5 char:1
+ @admin.register(Equipment)
+ ~~~~~~
The splatting operator '@' cannot be used to reference variables in an expression. '@admin' can be used only as an argument to a command. To reference variables in an expression use '$admin'.
At line:2 char:1
+ from django.contrib import admin
+ ~~~~
The 'from' keyword is not supported in this version of the language.

At line:3 char:1
+ from .models import Equipment
+ ~~~~
The 'from' keyword is not supported in this version of the language.

At line:5 char:17
+ @admin.register(Equipment)
+                 ~
Missing ')' in method call.

At line:5 char:17
+ @admin.register(Equipment)
+                 ~~~~~~~~~
Unexpected token 'Equipment' in expression or statement.

At line:5 char:26
+ @admin.register(Equipment)
+                          ~
Unexpected token ')' in expression or statement.

At line:6 char:21
+ class EquipmentAdmin(admin.ModelAdmin):
+                     ~
Missing 'class' body in 'class' declaration.

At line:6 char:39
+ class EquipmentAdmin(admin.ModelAdmin):
+                                       ~
Unexpected token ':' in expression or statement.

At line:5 char:1
+ @admin.register(Equipment)
+ ~~~~~~
The splatting operator '@' cannot be used to reference variables in an expression. '@admin' can be used only as an
argument to a command. To reference variables in an expression use '$admin'.
    + CategoryInfo          : ParserError: (:) [], ParentContainsErrorRecordException
    + FullyQualifiedErrorId : ReservedKeywordNotAllowed

PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # 1. 'ops\fix_equipment_list_r7.ps1' içeriğini en temiz ve basit flow dosyalarını üretecek şekilde Geri Alma
$scriptContent_rollback_final = @'
# === fix_equipment_list_r7.ps1: FINAL ROLLBACK TO CLEAN FLOWS (PS 5.1, ASCII) ===
$ErrorActionPreference="Stop"

function W([string]$p,[string]$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }

$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
$val = "ops\flows\equipment_ui_create_validate.flow"

$base="http://127.0.0.1:8010"
$user="admin"
$pass="Admin!2345"

$LOGIN = @"
GOTO  $base/admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  $user
FILL  input[name=password]  $pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main
"@

# En basit, eğik çizgi eklenmiş listeleme URL'si
$TO_LIST_PAGE = @"
GOTO  $base/admin/maintenance/equipment/
WAIT  SELECTOR #content-main
WAIT  SELECTOR table#result_list
"@

$VALIDATE_TAIL = @"
WAIT  SELECTOR table#result_list
WAIT  SELECTOR table#result_list tbody tr, p.no-results, .paginator
"@

$head = ($LOGIN.TrimEnd("`r","`n") + "`r`n" + $TO_LIST_PAGE.TrimStart("`r","`n"))

if (Test-Path $chg) {
  W $chg $head
  Write-Host "[ok] rewrote: $(Split-Path $chg -Leaf) (CLEAN FLOWS)" -ForegroundColor Cyan
}

if (Test-Path $val) {
  W $val ($head + $VALIDATE_TAIL)
  Write-Host "[ok] rewrote: $(Split-Path $val -Leaf) (CLEAN FLOWS)" -ForegroundColor Cyan
}
'@

# 2. Betiği dosyaya yazma
Set-Content -Path '.\ops\fix_equipment_list_r7.ps1' -Value $scriptContent_rollback_final -Encoding ASCII

# 3. Temizleme işlemini çalıştır
powershell -ExecutionPolicy Bypass -File ops\fix_equipment_list_r7.ps1
[ok] rewrote: __make_baseline_admin_equipment_change.flow (CLEAN FLOWS)
[ok] rewrote: equipment_ui_create_validate.flow (CLEAN FLOWS)
PS C:\dev\bakim_kalibrasyon>
(venv) # 1. Tarayıcıları kapat
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force

# 2. SADECE ekipman listeleme/doğrulama flow'unu çalıştır
# Eğer Django kodunuzdaki sorunu çözdüyseniz, bu test artık geçmelidir.
$base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*" -BaseUrl $base

# 3. Özet raporunu oluştur
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1

==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Ca
ll log:   - wa...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     Error: Page.goto: net::ERR_TOO_MANY_REDIRECTS at http://127.0.0.1:8
010/admin/mai...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # 1. Flow dosyalarını, uygulamanın zorladığı /_direct/ URL'sine geri döndür
$scriptContent_final_direct_url = @'
# === fix_equipment_list_r7.ps1: FINAL /_direct/ URL FIX (PS 5.1, ASCII) ===
$ErrorActionPreference="Stop"

function W([string]$p,[string]$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }

$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
$val = "ops\flows\equipment_ui_create_validate.flow"

$base="http://127.0.0.1:8010"
$user="admin"
$pass="Admin!2345"

$LOGIN = @"
GOTO  $base/admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  $user
FILL  input[name=password]  $pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main
"@

# Uygulamanın zorunlu kıldığı /_direct/ URL'si kullanılmalı
$TO_LIST_PAGE = @"
GOTO  $base/admin/maintenance/equipment/_direct/
WAIT  SELECTOR #content-main
WAIT  SELECTOR table#result_list
"@

$VALIDATE_TAIL = @"
WAIT  SELECTOR table#result_list
WAIT  SELECTOR table#result_list tbody tr, p.no-results, .paginator
"@

$head = ($LOGIN.TrimEnd("`r","`n") + "`r`n" + $TO_LIST_PAGE.TrimStart("`r","`n"))

if (Test-Path $chg) {
  W $chg $head
  Write-Host "[ok] rewrote: $(Split-Path $chg -Leaf) (FINAL /_direct/ FIX)" -ForegroundColor Magenta
}

if (Test-Path $val) {
  W $val ($head + $VALIDATE_TAIL)
  Write-Host "[ok] rewrote: $(Split-Path $val -Leaf) (FINAL /_direct/ FIX)" -ForegroundColor Magenta
}
'@

# 2. Betiği dosyaya yazma
Set-Content -Path '.\ops\fix_equipment_list_r7.ps1' -Value $scriptContent_final_direct_url -Encoding ASCII

# 3. Temizleme işlemini çalıştır
powershell -ExecutionPolicy Bypass -File ops\fix_equipment_list_r7.ps1

# 4. Tarayıcıları kapat
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force

# 5. Tüm başarısız flow'ları çalıştır
$base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*" -BaseUrl $base

# 6. Özet raporunu oluştur
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"
[ok] rewrote: __make_baseline_admin_equipment_change.flow (FINAL /_direct/ FIX)
[ok] rewrote: equipment_ui_create_validate.flow (FINAL /_direct/ FIX)
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1

==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Ca
ll log:   - wa...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Cal
l log:   - wa...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cs
>> TerminatingError(): "The term 'cs' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again."
The term 'cs' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
cs : The term 'cs' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the
spelling of the name, or if a path was included, verify that the path is correct and try again.
At line:1 char:1
+ cs
+ ~~
    + CategoryInfo          : ObjectNotFound: (cs:String) [], ParentContainsErrorRecordException
    + FullyQualifiedErrorId : CommandNotFoundException

PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # 1. Flow dosyalarını, uygulamanın zorladığı /_direct/ URL'sine geri döndür
$scriptContent_final_direct_url = @'
# === fix_equipment_list_r7.ps1: FINAL /_direct/ URL FIX (PS 5.1, ASCII) ===
$ErrorActionPreference="Stop"

function W([string]$p,[string]$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }

$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
$val = "ops\flows\equipment_ui_create_validate.flow"

$base="http://127.0.0.1:8010"
$user="admin"
$pass="Admin!2345"

$LOGIN = @"
GOTO  $base/admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  $user
FILL  input[name=password]  $pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main
"@

# Uygulamanın zorunlu kıldığı /_direct/ URL'si kullanılmalı
$TO_LIST_PAGE = @"
GOTO  $base/admin/maintenance/equipment/_direct/
WAIT  SELECTOR #content-main
WAIT  SELECTOR table#result_list
"@

$VALIDATE_TAIL = @"
WAIT  SELECTOR table#result_list
WAIT  SELECTOR table#result_list tbody tr, p.no-results, .paginator
"@

$head = ($LOGIN.TrimEnd("`r","`n") + "`r`n" + $TO_LIST_PAGE.TrimStart("`r","`n"))

if (Test-Path $chg) {
  W $chg $head
  Write-Host "[ok] rewrote: $(Split-Path $chg -Leaf) (FINAL /_direct/ FIX)" -ForegroundColor Magenta
}

if (Test-Path $val) {
  W $val ($head + $VALIDATE_TAIL)
  Write-Host "[ok] rewrote: $(Split-Path $val -Leaf) (FINAL /_direct/ FIX)" -ForegroundColor Magenta
}
'@

# 2. Betiği dosyaya yazma
Set-Content -Path '.\ops\fix_equipment_list_r7.ps1' -Value $scriptContent_final_direct_url -Encoding ASCII

# 3. Temizleme işlemini çalıştır
powershell -ExecutionPolicy Bypass -File ops\fix_equipment_list_r7.ps1
Write-Host ""
Write-Host "--- TEST FLOWLARI ÇALIŞTIRILIYOR ---" -ForegroundColor Yellow

# 4. Tarayıcıları kapat
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force

# 5. Tüm başarısız flow'ları çalıştır ve debug kodunu ekle
$base="http://127.0.0.1:8010"

# __make_baseline_admin_equipment_change.flow
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
$J="__otokodlama\out\__make_baseline_admin_equipment_change.json"
if(Test-Path $J){ (gc $J -Raw|ConvertFrom-Json).results | ?{ -not $_.ok } | select i,cmd,arg,error,url }

# equipment_ui_create_validate.flow
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*" -BaseUrl $base
$J="_otokodlama\out\equipment_ui_create_validate.json"
if(Test-Path $J){ (gc $J -Raw|ConvertFrom-Json).results | ?{ -not $_.ok } | select i,cmd,arg,error,url }

# 6. Özet raporunu oluştur
Write-Host ""
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"
[ok] rewrote: __make_baseline_admin_equipment_change.flow (FINAL /_direct/ FIX)
[ok] rewrote: equipment_ui_create_validate.flow (FINAL /_direct/ FIX)

--- TEST FLOWLARI ÇALIŞTIRILIYOR ---
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1


i     : 9
cmd   : WAIT
arg   : SELECTOR table#result_listWAIT  SELECTOR table#result_list
error : TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded.
        Call log:
          - waiting for locator("table#result_listWAIT  SELECTOR table#result_list") to be visible

url   : http://127.0.0.1:8010/admin/



==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Ca
ll log:   - wa...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Cal
l log:   - wa...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================


PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) $TO_LIST_PAGE = @"
GOTO  $base/admin/maintenance/equipment/_direct/
WAIT  SELECTOR #content-main
WAIT  SELECTOR table#result_list
"@
PS C:\dev\bakim_kalibrasyon>
(venv) # 1. Flow dosyalarını, sözdizimi hatasını giderecek şekilde yeniden yaz
$scriptContent_final_syntax_fix = @'
# === fix_equipment_list_r7.ps1: FINAL SYNTAX FIX (PS 5.1, ASCII) ===
$ErrorActionPreference="Stop"

function W([string]$p,[string]$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }

$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
$val = "ops\flows\equipment_ui_create_validate.flow"

$base="http://127.0.0.1:8010"
$user="admin"
$pass="Admin!2345"

$LOGIN_AND_ADMIN_HOME = @"
GOTO  $base/admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  $user
FILL  input[name=password]  $pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main
"@

# Tüm WAIT komutları arasına fazladan satır sonu koyarak ayrımı garanti et.
$TO_LIST_PAGE = @"
GOTO  $base/admin/maintenance/equipment/_direct/

WAIT  SELECTOR #content-main

WAIT  SELECTOR table#result_list
"@

$VALIDATE_TAIL = @"

WAIT  SELECTOR table#result_list

WAIT  SELECTOR table#result_list tbody tr, p.no-results, .paginator
"@

# Basit birleştirmeyi kullan
$head = $LOGIN_AND_ADMIN_HOME.Trim() + "`r`n" + $TO_LIST_PAGE.Trim()

if (Test-Path $chg) {
  W $chg $head
  Write-Host "[ok] rewrote: $(Split-Path $chg -Leaf) (FINAL SYNTAX FIX)" -ForegroundColor Green
}

if (Test-Path $val) {
  W $val ($head + $VALIDATE_TAIL)
  Write-Host "[ok] rewrote: $(Split-Path $val -Leaf) (FINAL SYNTAX FIX)" -ForegroundColor Green
}
'@

# 2. Betiği dosyaya yazma
Set-Content -Path '.\ops\fix_equipment_list_r7.ps1' -Value $scriptContent_final_syntax_fix -Encoding ASCII

# 3. Temizleme işlemini çalıştır
powershell -ExecutionPolicy Bypass -File ops\fix_equipment_list_r7.ps1
Write-Host ""
Write-Host "--- TEST FLOWLARI ÇALIŞTIRILIYOR (Sözdizimi Düzeltildi) ---" -ForegroundColor Yellow

# 4. Tarayıcıları kapat
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force

# 5. Tüm başarısız flow'ları çalıştır
$base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*" -BaseUrl $base

# 6. Özet raporunu oluştur
Write-Host ""
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"
[ok] rewrote: __make_baseline_admin_equipment_change.flow (FINAL SYNTAX FIX)
[ok] rewrote: equipment_ui_create_validate.flow (FINAL SYNTAX FIX)

--- TEST FLOWLARI ÇALIŞTIRILIYOR (Sözdizimi Düzeltildi) ---
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1


==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Ca
ll log:   - wa...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Cal
l log:   - wa...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # 1. Flow dosyalarını, sözdizimi hatasını giderecek şekilde yeniden yaz
$scriptContent_final_syntax_fix = @'
# === fix_equipment_list_r7.ps1: FINAL SYNTAX FIX (PS 5.1, ASCII) ===
$ErrorActionPreference="Stop"

function W([string]$p,[string]$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }

$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
$val = "ops\flows\equipment_ui_create_validate.flow"

$base="http://127.0.0.1:8010"
$user="admin"
$pass="Admin!2345"

$LOGIN_AND_ADMIN_HOME = @"
GOTO  $base/admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  $user
FILL  input[name=password]  $pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main
"@

# Tüm WAIT komutları arasına fazladan satır sonu koyarak ayrımı garanti et.
$TO_LIST_PAGE = @"
GOTO  $base/admin/maintenance/equipment/_direct/

WAIT  SELECTOR #content-main

WAIT  SELECTOR table#result_list
"@

$VALIDATE_TAIL = @"

WAIT  SELECTOR table#result_list

WAIT  SELECTOR table#result_list tbody tr, p.no-results, .paginator
"@

# Basit birleştirmeyi kullan
$head = $LOGIN_AND_ADMIN_HOME.Trim() + "`r`n" + $TO_LIST_PAGE.Trim()

if (Test-Path $chg) {
  W $chg $head
  Write-Host "[ok] rewrote: $(Split-Path $chg -Leaf) (FINAL SYNTAX FIX)" -ForegroundColor Green
}

if (Test-Path $val) {
  W $val ($head + $VALIDATE_TAIL)
  Write-Host "[ok] rewrote: $(Split-Path $val -Leaf) (FINAL SYNTAX FIX)" -ForegroundColor Green
}
'@

# 2. Betiği dosyaya yazma
Set-Content -Path '.\ops\fix_equipment_list_r7.ps1' -Value $scriptContent_final_syntax_fix -Encoding ASCII

# 3. Temizleme işlemini çalıştır
powershell -ExecutionPolicy Bypass -File ops\fix_equipment_list_r7.ps1
Write-Host ""
Write-Host "--- TEST FLOWLARI ÇALIŞTIRILIYOR (Sözdizimi Düzeltildi) ---" -ForegroundColor Yellow

# 4. Tarayıcıları kapat
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force

# 5. Tüm başarısız flow'ları çalıştır
$base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*" -BaseUrl $base

# 6. Özet raporunu oluştur
Write-Host ""
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"
[ok] rewrote: __make_baseline_admin_equipment_change.flow (FINAL SYNTAX FIX)
[ok] rewrote: equipment_ui_create_validate.flow (FINAL SYNTAX FIX)

--- TEST FLOWLARI ÇALIŞTIRILIYOR (Sözdizimi Düzeltildi) ---
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1


==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Ca
ll log:   - wa...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Cal
l log:   - wa...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # 1. Flow dosyalarını, en sağlam seçici olan #changelist-form'u kullanacak şekilde yeniden yaz
$scriptContent_final_robust_selector = @'
# === fix_equipment_list_r7.ps1: FINAL ROBUST SELECTOR FIX (PS 5.1, ASCII) ===
$ErrorActionPreference="Stop"

function W([string]$p,[string]$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }

$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
$val = "ops\flows\equipment_ui_create_validate.flow"

$base="http://127.0.0.1:8010"
$user="admin"
$pass="Admin!2345"

$LOGIN_AND_ADMIN_HOME = @"
GOTO  $base/admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  $user
FILL  input[name=password]  $pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main
"@

# KRİTİK KISIM: table#result_list yerine #changelist-form bekle
$TO_LIST_PAGE = @"
GOTO  $base/admin/maintenance/equipment/_direct/

WAIT  SELECTOR #content-main

WAIT  SELECTOR #changelist-form
"@

$VALIDATE_TAIL = @"

WAIT  SELECTOR #changelist-form
# Son bekleme tablonun kendisi yerine liste içeriğini kontrol eder
WAIT  SELECTOR table#result_list tbody tr, p.no-results, .paginator
"@

# Basit birleştirmeyi kullan
$head = $LOGIN_AND_ADMIN_HOME.Trim() + "`r`n" + $TO_LIST_PAGE.Trim()

if (Test-Path $chg) {
  W $chg $head
  Write-Host "[ok] rewrote: $(Split-Path $chg -Leaf) (ROBUST SELECTOR FIX)" -ForegroundColor Yellow
}

if (Test-Path $val) {
  W $val ($head + $VALIDATE_TAIL)
  Write-Host "[ok] rewrote: $(Split-Path $val -Leaf) (ROBUST SELECTOR FIX)" -ForegroundColor Yellow
}
'@

# 2. Betiği dosyaya yazma
Set-Content -Path '.\ops\fix_equipment_list_r7.ps1' -Value $scriptContent_final_robust_selector -Encoding ASCII

# 3. Temizleme işlemini çalıştır
powershell -ExecutionPolicy Bypass -File ops\fix_equipment_list_r7.ps1

# 4. Tarayıcıları kapat
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force

# 5. Tüm başarısız flow'ları çalıştır
$base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*" -BaseUrl $base

# 6. Özet raporunu oluştur
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"
[ok] rewrote: __make_baseline_admin_equipment_change.flow (ROBUST SELECTOR FIX)
[ok] rewrote: equipment_ui_create_validate.flow (ROBUST SELECTOR FIX)
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1

==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Ca
ll log:   - wa...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Cal
l log:   - wa...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cs
>> TerminatingError(): "The term 'cs' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again."
The term 'cs' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
cs : The term 'cs' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the
spelling of the name, or if a path was included, verify that the path is correct and try again.
At line:1 char:1
+ cs
+ ~~
    + CategoryInfo          : ObjectNotFound: (cs:String) [], ParentContainsErrorRecordException
    + FullyQualifiedErrorId : CommandNotFoundException

PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # 1. Tarayıcıları kapat
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force

# 2. Timeout artırılmış (30 saniye) flow'ları çalıştır
$base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base --timeout 30000
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*" -BaseUrl $base --timeout 30000

# 3. Özet raporunu oluştur
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1

==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Ca
ll log:   - wa...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     TimeoutError: Page.wait_for_selector: Timeout 10000ms exceeded. Cal
l log:   - wa...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # 1. Flow dosyalarını, standart URL ve sağlam seçiciyi kullanacak şekilde yeniden yaz
$scriptContent_final_standard_url = @'
# === fix_equipment_list_r7.ps1: FINAL STANDARD URL FIX (PS 5.1, ASCII) ===
$ErrorActionPreference="Stop"

function W([string]$p,[string]$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }

$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
$val = "ops\flows\equipment_ui_create_validate.flow"

$base="http://127.0.0.1:8010"
$user="admin"
$pass="Admin!2345"

$LOGIN_AND_ADMIN_HOME = @"
GOTO  $base/admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  $user
FILL  input[name=password]  $pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main
"@

# Standart /equipment/ URL'si
$TO_LIST_PAGE = @"
GOTO  $base/admin/maintenance/equipment/

WAIT  SELECTOR #content-main

WAIT  SELECTOR #changelist-form
"@

$VALIDATE_TAIL = @"

WAIT  SELECTOR #changelist-form
# Liste içeriğini bekleme
WAIT  SELECTOR table#result_list tbody tr, p.no-results, .paginator
"@

$head = $LOGIN_AND_ADMIN_HOME.Trim() + "`r`n" + $TO_LIST_PAGE.Trim()

if (Test-Path $chg) {
  W $chg $head
  Write-Host "[ok] rewrote: $(Split-Path $chg -Leaf) (FINAL STANDARD URL FIX)" -ForegroundColor Magenta
}

if (Test-Path $val) {
  W $val ($head + $VALIDATE_TAIL)
  Write-Host "[ok] rewrote: $(Split-Path $val -Leaf) (FINAL STANDARD URL FIX)" -ForegroundColor Magenta
}
'@

# 2. Betiği dosyaya yazma
Set-Content -Path '.\ops\fix_equipment_list_r7.ps1' -Value $scriptContent_final_standard_url -Encoding ASCII

# 3. Temizleme işlemini çalıştır (Flow dosyaları güncellenir)
powershell -ExecutionPolicy Bypass -File ops\fix_equipment_list_r7.ps1
Write-Host ""
Write-Host "--- TEST FLOWLARI ÇALIŞTIRILIYOR ---" -ForegroundColor Yellow

# 4. Tarayıcıları kapat
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force

# 5. Tüm başarısız flow'ları çalıştır
$base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*" -BaseUrl $base

# 6. Özet raporunu oluştur
Write-Host ""
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"
[ok] rewrote: __make_baseline_admin_equipment_change.flow (FINAL STANDARD URL FIX)
[ok] rewrote: equipment_ui_create_validate.flow (FINAL STANDARD URL FIX)

--- TEST FLOWLARI ÇALIŞTIRILIYOR ---
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1


==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     Error: Page.goto: net::ERR_TOO_MANY_REDIRECTS at http://127.0.0.1:
8010/admin/mai...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     Error: Page.goto: net::ERR_TOO_MANY_REDIRECTS at http://127.0.0.1:8
010/admin/mai...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # 1. Flow dosyalarını, standart URL ve sağlam seçiciyi kullanacak şekilde yeniden yaz
$scriptContent_final_standard_url = @'
# === fix_equipment_list_r7.ps1: FINAL STANDARD URL FIX (PS 5.1, ASCII) ===
$ErrorActionPreference="Stop"

function W([string]$p,[string]$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }

$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
$val = "ops\flows\equipment_ui_create_validate.flow"

$base="http://127.0.0.1:8010"
$user="admin"
$pass="Admin!2345"

$LOGIN_AND_ADMIN_HOME = @"
GOTO  $base/admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  $user
FILL  input[name=password]  $pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main
"@

# Standart /equipment/ URL'si
$TO_LIST_PAGE = @"
GOTO  $base/admin/maintenance/equipment/

WAIT  SELECTOR #content-main

WAIT  SELECTOR #changelist-form
"@

$VALIDATE_TAIL = @"

WAIT  SELECTOR #changelist-form
# Liste içeriğini bekleme
WAIT  SELECTOR table#result_list tbody tr, p.no-results, .paginator
"@

$head = $LOGIN_AND_ADMIN_HOME.Trim() + "`r`n" + $TO_LIST_PAGE.Trim()

if (Test-Path $chg) {
  W $chg $head
  Write-Host "[ok] rewrote: $(Split-Path $chg -Leaf) (FINAL STANDARD URL FIX)" -ForegroundColor Magenta
}

if (Test-Path $val) {
  W $val ($head + $VALIDATE_TAIL)
  Write-Host "[ok] rewrote: $(Split-Path $val -Leaf) (FINAL STANDARD URL FIX)" -ForegroundColor Magenta
}
'@

# 2. Betiği dosyaya yazma
Set-Content -Path '.\ops\fix_equipment_list_r7.ps1' -Value $scriptContent_final_standard_url -Encoding ASCII

# 3. Temizleme işlemini çalıştır (Flow dosyaları güncellenir)
powershell -ExecutionPolicy Bypass -File ops\fix_equipment_list_r7.ps1
Write-Host ""
Write-Host "--- TEST FLOWLARI ÇALIŞTIRILIYOR ---" -ForegroundColor Yellow

# 4. Tarayıcıları kapat
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force

# 5. Tüm başarısız flow'ları çalıştır
$base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*" -BaseUrl $base

# 6. Özet raporunu oluştur
Write-Host ""
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"
[ok] rewrote: __make_baseline_admin_equipment_change.flow (FINAL STANDARD URL FIX)
[ok] rewrote: equipment_ui_create_validate.flow (FINAL STANDARD URL FIX)

--- TEST FLOWLARI ÇALIŞTIRILIYOR ---
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1


==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     Error: Page.goto: net::ERR_TOO_MANY_REDIRECTS at http://127.0.0.1:
8010/admin/mai...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     Error: Page.goto: net::ERR_TOO_MANY_REDIRECTS at http://127.0.0.1:8
010/admin/mai...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # Dosya yolunu tanımlama
$AdminFilePath = '.\maintenance\admin.py'

# 1. MaintenanceAdminSite içindeki _direct/ linkini yoruma alma:
# Mümkün olan en az riskli düzenleme için, sadece _direct/ atamasını yoruma alıyoruz.
(Get-Content $AdminFilePath) | ForEach-Object {
    if ($_ -match 'm\["admin_url"\] = "/admin/maintenance/equipment/_direct/"') {
        # Satırı yoruma al
        "                # $_"
    }
    else {
        # Diğer satırları olduğu gibi bırak
        $_
    }
} | Set-Content $AdminFilePath -Encoding ASCII

# 2. Dosyanın sonundaki agresif yönlendirme/yama bloklarını yoruma alma:
# Karmaşık blokları silmek riskli olduğu için, tüm bloğu Python'da çoklu satır yorumu
# gibi davranacak şekilde yoruma alıyoruz.

(Get-Content $AdminFilePath) | ForEach-Object {
    $line = $_
    
    # 2.2. Kilitlenme Nedeni: Agresif Yönlendirme ve Yama Kodlarını bul ve yoruma al
    if ($line -match '# --- SAFE REDIRECTS AFTER SAVE/DELETE' -or $line -match '# ==== BEGIN: EQ-ADMIN HARDENING') {
        # Başlangıç satırına bir boşluk ve '#' karakteri ekle
        Write-Host "Bulundu ve yorum satırı yapılıyor: $line" -ForegroundColor Yellow
        
        # Sonraki tüm satırları bul ve yoruma al (bu kod bloklarını tamamen etkisiz hale getirir)
        $Commented = @()
        $Commented += "################################################################################"
        $Commented += "# HARDENING BLOKLARI GEÇİCİ OLARAK DEVRE DIŞI BIRAKILDI (TESTLER İÇİN)"
        $Commented += "################################################################################"
        $InBlock = $true
    }
    elseif ($InBlock -and ($line -notmatch '^\s*#') -and ($line -notmatch '^\s*$')) {
        # Blok içindeki kod satırlarını yoruma al
        $Commented += "# $line"
    }
    elseif ($InBlock -and ($line -match '^\s*$')) {
        # Boş satırları koru (PowerShell'in Get-Content/Set-Content mantığının karmaşıklığı nedeniyle bu kısmı basitleştirelim)
        $Commented += $line
    }
    elseif ($InBlock -and ($line -match '^\s*#')) {
        # Mevcut yorumları koru
        $Commented += $line
    }
    else {
        # Blok dışındaki normal satırları yaz
        $_
    }
    
    # Yeni satırı yaz
    if ($InBlock -and $line -notmatch '# --- SAFE REDIRECTS' -and $line -notmatch '# ==== BEGIN: EQ-ADMIN HARDENING') {
        # Geçici olarak satırları buffer'da tut
    } elseif ($InBlock) {
        # Bloğun sonuna ulaştık, yorumlanmış bloğu yaz
        $Commented | Out-File $AdminFilePath -Append -Encoding ASCII
        $InBlock = $false
    } else {
        # Normal satırı yaz
        $line | Out-File $AdminFilePath -Append -Encoding ASCII
    }

} | Out-Null
Bulundu ve yorum satırı yapılıyor: # --- SAFE REDIRECTS AFTER SAVE/DELETE (avoid /equipment/ 302 loop) ---
Bulundu ve yorum satırı yapılıyor: # ==== BEGIN: EQ-ADMIN HARDENING (redirect to _direct) ====
PS C:\dev\bakim_kalibrasyon>
(venv) cs
>> TerminatingError(): "The term 'cs' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again."
The term 'cs' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
cs : The term 'cs' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the
spelling of the name, or if a path was included, verify that the path is correct and try again.
At line:1 char:1
+ cs
+ ~~
    + CategoryInfo          : ObjectNotFound: (cs:String) [], ParentContainsErrorRecordException
    + FullyQualifiedErrorId : CommandNotFoundException

PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # 1. Flow dosyalarını, standart URL'yi kullanacak şekilde yeniden yaz
$scriptContent_final_standard_url = @'
# === fix_equipment_list_r7.ps1: FINAL STANDARD URL FIX (PS 5.1, ASCII) ===
$ErrorActionPreference="Stop"

function W([string]$p,[string]$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }

$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
$val = "ops\flows\equipment_ui_create_validate.flow"

$base="http://127.0.0.1:8010"
$user="admin"
$pass="Admin!2345"

$LOGIN_AND_ADMIN_HOME = @"
GOTO  $base/admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  $user
FILL  input[name=password]  $pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main
"@

# Standart /equipment/ URL'si ve güvenilir #changelist-form seçicisi
$TO_LIST_PAGE = @"
GOTO  $base/admin/maintenance/equipment/

WAIT  SELECTOR #content-main

WAIT  SELECTOR #changelist-form
"@

$VALIDATE_TAIL = @"

WAIT  SELECTOR #changelist-form
# Liste içeriğini bekleme
WAIT  SELECTOR table#result_list tbody tr, p.no-results, .paginator
"@

$head = $LOGIN_AND_ADMIN_HOME.Trim() + "`r`n" + $TO_LIST_PAGE.Trim()

if (Test-Path $chg) {
  W $chg $head
  Write-Host "[ok] rewrote: $(Split-Path $chg -Leaf) (FINAL STANDARD URL FIX)" -ForegroundColor Magenta
}

if (Test-Path $val) {
  W $val ($head + $VALIDATE_TAIL)
  Write-Host "[ok] rewrote: $(Split-Path $val -Leaf) (FINAL STANDARD URL FIX)" -ForegroundColor Magenta
}
'@

# 2. Betiği dosyaya yazma
Set-Content -Path '.\ops\fix_equipment_list_r7.ps1' -Value $scriptContent_final_standard_url -Encoding ASCII

# 3. Temizleme işlemini çalıştır (Flow dosyaları güncellenir)
powershell -ExecutionPolicy Bypass -File ops\fix_equipment_list_r7.ps1
Write-Host ""
Write-Host "--- TEST FLOWLARI ÇALIŞTIRILIYOR ---" -ForegroundColor Yellow

# 4. Tarayıcıları kapat
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force

# 5. Tüm başarısız flow'ları çalıştır
$base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*" -BaseUrl $base

# 6. Özet raporunu oluştur
Write-Host ""
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"
[ok] rewrote: __make_baseline_admin_equipment_change.flow (FINAL STANDARD URL FIX)
[ok] rewrote: equipment_ui_create_validate.flow (FINAL STANDARD URL FIX)

--- TEST FLOWLARI ÇALIŞTIRILIYOR ---
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1


==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     Error: Page.goto: net::ERR_TOO_MANY_REDIRECTS at http://127.0.0.1:
8010/admin/mai...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     Error: Page.goto: net::ERR_TOO_MANY_REDIRECTS at http://127.0.0.1:8
010/admin/mai...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # 1. Tarayıcıları kapat
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force

# 2. Tüm başarısız flow'ları çalıştır (Temizlenmiş admin.py bekleniyor)
$base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*" -BaseUrl $base

# 3. Özet raporunu oluştur
Write-Host ""
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1


==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     Error: Page.goto: net::ERR_TOO_MANY_REDIRECTS at http://127.0.0.1:
8010/admin/mai...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     Error: Page.goto: net::ERR_TOO_MANY_REDIRECTS at http://127.0.0.1:8
010/admin/mai...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
PS C:\dev\bakim_kalibrasyon>
PS C:\dev\bakim_kalibrasyon>
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) v
>> TerminatingError(): "The term 'v' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again."
The term 'v' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
v : The term 'v' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the
spelling of the name, or if a path was included, verify that the path is correct and try again.
At line:1 char:1
+ v
+ ~
    + CategoryInfo          : ObjectNotFound: (v:String) [], ParentContainsErrorRecordException
    + FullyQualifiedErrorId : CommandNotFoundException

PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # 1. Flow dosyalarını, standart URL'yi kullanacak şekilde yeniden yazar
$scriptContent_final_standard_url = @'
# === fix_equipment_list_r7.ps1: FINAL STANDARD URL FIX (PS 5.1, ASCII) ===
$ErrorActionPreference="Stop"

function W([string]$p,[string]$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }

$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
$val = "ops\flows\equipment_ui_create_validate.flow"

$base="http://127.0.0.1:8010"
$user="admin"
$pass="Admin!2345"

$LOGIN_AND_ADMIN_HOME = @"
GOTO  $base/admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  $user
FILL  input[name=password]  $pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main
"@

# Standart /equipment/ URL'si ve güvenilir #changelist-form seçicisi
$TO_LIST_PAGE = @"
GOTO  $base/admin/maintenance/equipment/

WAIT  SELECTOR #content-main

WAIT  SELECTOR #changelist-form
"@

$VALIDATE_TAIL = @"

WAIT  SELECTOR #changelist-form
# Liste içeriğini bekleme
WAIT  SELECTOR table#result_list tbody tr, p.no-results, .paginator
"@

$head = $LOGIN_AND_ADMIN_HOME.Trim() + "`r`n" + $TO_LIST_PAGE.Trim()

if (Test-Path $chg) {
  W $chg $head
  Write-Host "[ok] rewrote: $(Split-Path $chg -Leaf) (FINAL STANDARD URL FIX)" -ForegroundColor Magenta
}

if (Test-Path $val) {
  W $val ($head + $VALIDATE_TAIL)
  Write-Host "[ok] rewrote: $(Split-Path $val -Leaf) (FINAL STANDARD URL FIX)" -ForegroundColor Magenta
}
'@

# 2. Betiği dosyaya yazma
Set-Content -Path '.\ops\fix_equipment_list_r7.ps1' -Value $scriptContent_final_standard_url -Encoding ASCII

# 3. Temizleme işlemini çalıştır (Flow dosyaları güncellenir)
powershell -ExecutionPolicy Bypass -File ops\fix_equipment_list_r7.ps1
Write-Host ""

# ====================================================================
# 4. KRİTİK ADIM: maintenance/admin.py Python Kodunu Düzenleme (PowerShell ile)
# Sonsuz yönlendirme döngüsüne neden olan kod bloklarını yoruma alma
# ====================================================================

$AdminFilePath = '.\maintenance\admin.py'
Write-Host ">>> $AdminFilePath dosyasındaki yönlendirme kodları devre dışı bırakılıyor..." -ForegroundColor Cyan

# Dosyanın tüm içeriğini al
$Content = Get-Content $AdminFilePath -Raw

# a) MaintenanceAdminSite içindeki _direct/ linkini yoruma alma
$Content = $Content -replace 'm\["admin_url"\] = "/admin/maintenance/equipment/_direct/"', '# m["admin_url"] = "/admin/maintenance/equipment/_direct/" # Otokodlama Devre Dışı Bıraktı'

# b) Agresif yönlendirme fonksiyonlarının başlangıçlarını yoruma alma
$Content = $Content -replace 'def response_change\(self, request


cls
# 1. Flow dosyalarını, standart URL'yi kullanacak şekilde yeniden yazar
$scriptContent_final_standard_url = @'
# === fix_equipment_list_r7.ps1: FINAL STANDARD URL FIX (PS 5.1, ASCII) ===
$ErrorActionPreference="Stop"

function W([string]$p,[string]$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }

$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
$val = "ops\flows\equipment_ui_create_validate.flow"

$base="http://127.0.0.1:8010"
$user="admin"
$pass="Admin!2345"

$LOGIN_AND_ADMIN_HOME = @"
GOTO  $base/admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  $user
FILL  input[name=password]  $pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main
"@

# Standart /equipment/ URL'si ve güvenilir #changelist-form seçicisi
$TO_LIST_PAGE = @"
GOTO  $base/admin/maintenance/equipment/

WAIT  SELECTOR #content-main

WAIT  SELECTOR #changelist-form
"@

$VALIDATE_TAIL = @"

WAIT  SELECTOR #changelist-form
# Liste içeriğini bekleme
WAIT  SELECTOR table#result_list tbody tr, p.no-results, .paginator
"@

$head = $LOGIN_AND_ADMIN_HOME.Trim() + "`r`n" + $TO_LIST_PAGE.Trim()

if (Test-Path $chg) {
  W $chg $head
  Write-Host "[ok] rewrote: $(Split-Path $chg -Leaf) (FINAL STANDARD URL FIX)" -ForegroundColor Magenta
}

if (Test-Path $val) {
  W $val ($head + $VALIDATE_TAIL)
  Write-Host "[ok] rewrote: $(Split-Path $val -Leaf) (FINAL STANDARD URL FIX)" -ForegroundColor Magenta
}
'@

# 2. Betiği dosyaya yazma
Set-Content -Path '.\ops\fix_equipment_list_r7.ps1' -Value $scriptContent_final_standard_url -Encoding ASCII

# 3. Temizleme işlemini çalıştır (Flow dosyaları güncellenir)
powershell -ExecutionPolicy Bypass -File ops\fix_equipment_list_r7.ps1
Write-Host ""

# ====================================================================
# 4. KRİTİK ADIM: maintenance/admin.py Python Kodunu Düzenleme (PowerShell ile)
# Sonsuz yönlendirme döngüsüne neden olan kod bloklarını yoruma alma
# ====================================================================

$AdminFilePath = '.\maintenance\admin.py'
Write-Host ">>> $AdminFilePath dosyasındaki yönlendirme kodları devre dışı bırakılıyor..." -ForegroundColor Cyan

# Dosyanın tüm içeriğini al
$Content = Get-Content $AdminFilePath -Raw

# a) MaintenanceAdminSite içindeki _direct/ linkini yoruma alma
$Content = $Content -replace 'm\["admin_url"\] = "/admin/maintenance/equipment/_direct/"', '# m["admin_url"] = "/admin/maintenance/equipment/_direct/" # Otokodlama Devre Dışı Bıraktı'

# b) Agresif yönlendirme fonksiyonlarının başlangıçlarını yoruma alma
$Content = $Content -replace 'def response_change\(self, request, obj\):', '# def response_change(self, request, obj): # Otokodlama Devre Dışı Bıraktı'
$Content = $Content -replace 'def changelist_view\(self, request, extra_context=None\):', '# def changelist_view(self, request, extra_context=None): # Otokodlama Devre Dışı Bıraktı'

# Yeni içeriği dosyaya ASCII formatında kaydet
Set-Content $AdminFilePath -Value $Content -Encoding ASCII

Write-Host "[ok] admin.py'deki kritik yönlendirme fonksiyonları devre dışı bırakıldı." -ForegroundColor Green
Write-Host ""
Write-Host "--- TEST FLOWLARI ÇALIŞTIRILIYOR (admin.py temizlendi) ---" -ForegroundColor Yellow

# 5. Tarayıcıları kapat
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force

# 6. Tüm başarısız flow'ları çalıştır
$base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*" -BaseUrl $base

# 7. Özet raporunu oluştur
Write-Host ""
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"
At line:79 char:37
+ # 1. Flow dosyalarını, standart URL'yi kullanacak şekilde yeniden yaz ...
+                                     ~~
Unexpected token 'yi' in expression or statement.
At line:79 char:37
+ # 1. Flow dosyalarını, standart URL'yi kullanacak şekilde yeniden yaz ...
+                                     ~~
Unexpected token 'yi' in expression or statement.
    + CategoryInfo          : ParserError: (:) [], ParentContainsErrorRecordException
    + FullyQualifiedErrorId : UnexpectedToken

PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # 1. Flow dosyalarını, standart URL'yi kullanacak şekilde yeniden yazar
$scriptContent_final_standard_url = @'
# === fix_equipment_list_r7.ps1: FINAL STANDARD URL FIX (PS 5.1, ASCII) ===
$ErrorActionPreference="Stop"

function W([string]$p,[string]$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }

$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
$val = "ops\flows\equipment_ui_create_validate.flow"

$base="http://127.0.0.1:8010"
$user="admin"
$pass="Admin!2345"

$LOGIN_AND_ADMIN_HOME = @"
GOTO  $base/admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  $user
FILL  input[name=password]  $pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main
"@

# Standart /equipment/ URL'si ve güvenilir #changelist-form seçicisi
$TO_LIST_PAGE = @"
GOTO  $base/admin/maintenance/equipment/

WAIT  SELECTOR #content-main

WAIT  SELECTOR #changelist-form
"@

$VALIDATE_TAIL = @"

WAIT  SELECTOR #changelist-form
# Liste içeriğini bekleme
WAIT  SELECTOR table#result_list tbody tr, p.no-results, .paginator
"@

$head = $LOGIN_AND_ADMIN_HOME.Trim() + "`r`n" + $TO_LIST_PAGE.Trim()

if (Test-Path $chg) {
  W $chg $head
  Write-Host "[ok] rewrote: $(Split-Path $chg -Leaf) (FINAL STANDARD URL FIX)" -ForegroundColor Magenta
}

if (Test-Path $val) {
  W $val ($head + $VALIDATE_TAIL)
  Write-Host "[ok] rewrote: $(Split-Path $val -Leaf) (FINAL STANDARD URL FIX)" -ForegroundColor Magenta
}
'@

# 2. Betiği dosyaya yazma
Set-Content -Path '.\ops\fix_equipment_list_r7.ps1' -Value $scriptContent_final_standard_url -Encoding ASCII

# 3. Temizleme işlemini çalıştır (Flow dosyaları güncellenir)
powershell -ExecutionPolicy Bypass -File ops\fix_equipment_list_r7.ps1
Write-Host ""

# ====================================================================
# 4. KRİTİK ADIM: maintenance/admin.py Python Kodunu Düzenleme (PowerShell ile)
# Sonsuz yönlendirme döngüsüne neden olan kod bloklarını yoruma alma
# ====================================================================

$AdminFilePath = '.\maintenance\admin.py'
Write-Host ">>> $AdminFilePath dosyasındaki yönlendirme kodları devre dışı bırakılıyor..." -ForegroundColor Cyan

# Dosyanın tüm içeriğini al
$Content = Get-Content $AdminFilePath -Raw

# a) MaintenanceAdminSite içindeki _direct/ linkini yoruma alma
$Content = $Content -replace 'm\["admin_url"\] = "/admin/maintenance/equipment/_direct/"', '# m["admin_url"] = "/admin/maintenance/equipment/_direct/" # Otokodlama Devre Dışı Bıraktı'

# b) Agresif yönlendirme fonksiyonlarının başlangıçlarını yoruma alma
$Content = $Content -replace 'def response_change\(self, request, obj\):', '# def response_change(self, request, obj): # Otokodlama Devre Dışı Bıraktı'
$Content = $Content -replace 'def changelist_view\(self, request, extra_context=None\):', '# def changelist_view(self, request, extra_context=None): # Otokodlama Devre Dışı Bıraktı'

# Yeni içeriği dosyaya ASCII formatında kaydet
Set-Content $AdminFilePath -Value $Content -Encoding ASCII

Write-Host "[ok] admin.py'deki kritik yönlendirme fonksiyonları devre dışı bırakıldı." -ForegroundColor Green
Write-Host ""
Write-Host "--- TEST FLOWLARI ÇALIŞTIRILIYOR (admin.py temizlendi) ---" -ForegroundColor Yellow

# 5. Tarayıcıları kapat
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force

# 6. Tüm başarısız flow'ları çalıştır
$base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*" -BaseUrl $base

# 7. Özet raporunu oluştur
Write-Host ""
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"
[ok] rewrote: __make_baseline_admin_equipment_change.flow (FINAL STANDARD URL FIX)
[ok] rewrote: equipment_ui_create_validate.flow (FINAL STANDARD URL FIX)

>>> .\maintenance\admin.py dosyasındaki yönlendirme kodları devre dışı bırakılıyor...
[ok] admin.py'deki kritik yönlendirme fonksiyonları devre dışı bırakıldı.

--- TEST FLOWLARI ÇALIŞTIRILIYOR (admin.py temizlendi) ---
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1


==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     Error: Page.goto: net::ERR_TOO_MANY_REDIRECTS at http://127.0.0.1:
8010/admin/mai...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     Error: Page.goto: net::ERR_TOO_MANY_REDIRECTS at http://127.0.0.1:8
010/admin/mai...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # 1. Flow dosyalarını, standart URL'yi kullanacak şekilde yeniden yazar (Zaten doğru)
$scriptContent_final_standard_url = @'
# === fix_equipment_list_r7.ps1: FINAL STANDARD URL FIX (PS 5.1, ASCII) ===
$ErrorActionPreference="Stop"

function W([string]$p,[string]$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }

$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
$val = "ops\flows\equipment_ui_create_validate.flow"

$base="http://127.0.0.1:8010"
$user="admin"
$pass="Admin!2345"

$LOGIN_AND_ADMIN_HOME = @"
GOTO  $base/admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  $user
FILL  input[name=password]  $pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main
"@

# Standart /equipment/ URL'si ve güvenilir #changelist-form seçicisi
$TO_LIST_PAGE = @"
GOTO  $base/admin/maintenance/equipment/

WAIT  SELECTOR #content-main

WAIT  SELECTOR #changelist-form
"@

$VALIDATE_TAIL = @"

WAIT  SELECTOR #changelist-form
# Liste içeriğini bekleme
WAIT  SELECTOR table#result_list tbody tr, p.no-results, .paginator
"@

$head = $LOGIN_AND_ADMIN_HOME.Trim() + "`r`n" + $TO_LIST_PAGE.Trim()

if (Test-Path $chg) {
  W $chg $head
  Write-Host "[ok] rewrote: $(Split-Path $chg -Leaf) (FINAL STANDARD URL FIX)" -ForegroundColor Magenta
}

if (Test-Path $val) {
  W $val ($head + $VALIDATE_TAIL)
  Write-Host "[ok] rewrote: $(Split-Path $val -Leaf) (FINAL STANDARD URL FIX)" -ForegroundColor Magenta
}
'@
powershell -ExecutionPolicy Bypass -File ops\fix_equipment_list_r7.ps1
Write-Host ""

# ====================================================================
# 2. KRİTİK ADIM: maintenance/admin.py'yi TEMEL SÜRÜMLE DEĞİŞTİRME (PowerShell ile)
# Tüm özel yönlendirme kodlarını kaldıran en agresif ve kesin çözüm.
# ====================================================================

$AdminFilePath = '.\maintenance\admin.py'
Write-Host ">>> $AdminFilePath sıfırlanıyor (Yönlendirme döngüsünü durdurmak için)..." -ForegroundColor Red

# admin.py için temel ve hatasız içerik:
$CleanAdminContent = @"
from django.contrib import admin
from maintenance.models import Equipment, MaintenanceItem, MaintenanceOrder, CalibrationAsset, CalibrationRecord
from django.contrib.admin import AdminSite
from django.urls import path

# En basit admin sitesini kullan
class MaintenanceAdminSite(AdminSite):
    site_header = "Bakım & Kalibrasyon Yönetimi"
    site_title = "Bakım Kalibrasyon"
    index_title = "Anasayfa"

admin_site = MaintenanceAdminSite(name='maintenance_admin')


@admin.register(Equipment, site=admin_site)
class EquipmentAdmin(admin.ModelAdmin):
    # Bu listenin düzgün çalışması için list_display'i en basit haliyle tutuyoruz
    list_display = ("code", "name", "discipline", "criticality", "is_active")
    list_filter = ("discipline", "criticality", "is_active")
    search_fields = ("code", "name")
    list_editable = ("is_active",)

@admin.register(MaintenanceItem, site=admin_site)
class MaintenanceItemAdmin(admin.ModelAdmin):
    list_display = ("equipment", "name", "frequency", "is_mandatory")
    list_filter = ("frequency", "is_mandatory")
    search_fields = ("equipment__code", "name")

@admin.register(MaintenanceOrder, site=admin_site)
class MaintenanceOrderAdmin(admin.ModelAdmin):
    list_display = ("title", "equipment", "due_date", "status", "order_type")
    list_filter = ("status", "order_type", "equipment")
    search_fields = ("title", "equipment__code")
    readonly_fields = ("completed_at",)

@admin.register(CalibrationAsset, site=admin_site)
class CalibrationAssetAdmin(admin.ModelAdmin):
    list_display = ("asset_code", "asset_name", "location", "brand")
    search_fields = ("asset_code", "asset_name")

@admin.register(CalibrationRecord, site=admin_site)
class CalibrationRecordAdmin(admin.ModelAdmin):
    list_display = ("asset", "next_calibration", "result", "certificate_no")
    list_filter = ("result", "asset")
    date_hierarchy = "next_calibration"
"@

# Yeni içeriği dosyaya kaydet
Set-Content $AdminFilePath -Value $CleanAdminContent -Encoding ASCII

Write-Host "[ok] admin.py başarıyla sıfırlandı. Testler çalıştırılıyor." -ForegroundColor Green
Write-Host ""
Write-Host "--- TEST FLOWLARI ÇALIŞTIRILIYOR (admin.py SIFIRLANDI) ---" -ForegroundColor Yellow

# 3. Tarayıcıları kapat
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force

# 4. Tüm flow'ları çalıştır
$base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*" -BaseUrl $base

# 5. Özet raporunu oluştur
Write-Host ""
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"
[ok] rewrote: __make_baseline_admin_equipment_change.flow (FINAL STANDARD URL FIX)
[ok] rewrote: equipment_ui_create_validate.flow (FINAL STANDARD URL FIX)

>>> .\maintenance\admin.py sıfırlanıyor (Yönlendirme döngüsünü durdurmak için)...
[ok] admin.py başarıyla sıfırlandı. Testler çalıştırılıyor.

--- TEST FLOWLARI ÇALIŞTIRILIYOR (admin.py SIFIRLANDI) ---
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1


==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     Error: Page.goto: net::ERR_TOO_MANY_REDIRECTS at http://127.0.0.1:
8010/admin/mai...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     Error: Page.goto: net::ERR_TOO_MANY_REDIRECTS at http://127.0.0.1:8
010/admin/mai...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # 1. Flow dosyalarını, standart URL'yi kullanacak şekilde yeniden yazar (Zaten doğru)
$scriptContent_final_standard_url = @'
# === fix_equipment_list_r7.ps1: FINAL STANDARD URL FIX (PS 5.1, ASCII) ===
$ErrorActionPreference="Stop"

function W([string]$p,[string]$t){ Set-Content -LiteralPath $p -Value $t -Encoding ASCII }

$chg = "ops\flows\__make_baseline_admin_equipment_change.flow"
$val = "ops\flows\equipment_ui_create_validate.flow"

$base="http://127.0.0.1:8010"
$user="admin"
$pass="Admin!2345"

$LOGIN_AND_ADMIN_HOME = @"
GOTO  $base/admin/login/
WAIT  SELECTOR input[name=username]
FILL  input[name=username]  $user
FILL  input[name=password]  $pass
CLICK input[type=submit]
WAIT  SELECTOR #content-main
"@

# Standart /equipment/ URL'si ve güvenilir #changelist-form seçicisi
$TO_LIST_PAGE = @"
GOTO  $base/admin/maintenance/equipment/

WAIT  SELECTOR #content-main

WAIT  SELECTOR #changelist-form
"@

$VALIDATE_TAIL = @"

WAIT  SELECTOR #changelist-form
# Liste içeriğini bekleme
WAIT  SELECTOR table#result_list tbody tr, p.no-results, .paginator
"@

$head = $LOGIN_AND_ADMIN_HOME.Trim() + "`r`n" + $TO_LIST_PAGE.Trim()

if (Test-Path $chg) {
  W $chg $head
  Write-Host "[ok] rewrote: $(Split-Path $chg -Leaf) (FINAL STANDARD URL FIX)" -ForegroundColor Magenta
}

if (Test-Path $val) {
  W $val ($head + $VALIDATE_TAIL)
  Write-Host "[ok] rewrote: $(Split-Path $val -Leaf) (FINAL STANDARD URL FIX)" -ForegroundColor Magenta
}
'@
powershell -ExecutionPolicy Bypass -File ops\fix_equipment_list_r7.ps1
Write-Host ""

# ====================================================================
# 2. KRİTİK ADIM: maintenance/admin.py'yi TEMEL SÜRÜMLE DEĞİŞTİRME (PowerShell ile)
# Tüm özel yönlendirme kodlarını kaldıran en agresif ve kesin çözüm.
# ====================================================================

$AdminFilePath = '.\maintenance\admin.py'
Write-Host ">>> $AdminFilePath sıfırlanıyor (Yönlendirme döngüsünü durdurmak için)..." -ForegroundColor Red

# admin.py için temel ve hatasız içerik:
$CleanAdminContent = @"
from django.contrib import admin
from maintenance.models import Equipment, MaintenanceItem, MaintenanceOrder, CalibrationAsset, CalibrationRecord
from django.contrib.admin import AdminSite
from django.urls import path

# En basit admin sitesini kullan
class MaintenanceAdminSite(AdminSite):
    site_header = "Bakım & Kalibrasyon Yönetimi"
    site_title = "Bakım Kalibrasyon"
    index_title = "Anasayfa"

admin_site = MaintenanceAdminSite(name='maintenance_admin')


@admin.register(Equipment, site=admin_site)
class EquipmentAdmin(admin.ModelAdmin):
    # Bu listenin düzgün çalışması için list_display'i en basit haliyle tutuyoruz
    list_display = ("code", "name", "discipline", "criticality", "is_active")
    list_filter = ("discipline", "criticality", "is_active")
    search_fields = ("code", "name")
    list_editable = ("is_active",)

@admin.register(MaintenanceItem, site=admin_site)
class MaintenanceItemAdmin(admin.ModelAdmin):
    list_display = ("equipment", "name", "frequency", "is_mandatory")
    list_filter = ("frequency", "is_mandatory")
    search_fields = ("equipment__code", "name")

@admin.register(MaintenanceOrder, site=admin_site)
class MaintenanceOrderAdmin(admin.ModelAdmin):
    list_display = ("title", "equipment", "due_date", "status", "order_type")
    list_filter = ("status", "order_type", "equipment")
    search_fields = ("title", "equipment__code")
    readonly_fields = ("completed_at",)

@admin.register(CalibrationAsset, site=admin_site)
class CalibrationAssetAdmin(admin.ModelAdmin):
    list_display = ("asset_code", "asset_name", "location", "brand")
    search_fields = ("asset_code", "asset_name")

@admin.register(CalibrationRecord, site=admin_site)
class CalibrationRecordAdmin(admin.ModelAdmin):
    list_display = ("asset", "next_calibration", "result", "certificate_no")
    list_filter = ("result", "asset")
    date_hierarchy = "next_calibration"
"@

# Yeni içeriği dosyaya kaydet
Set-Content $AdminFilePath -Value $CleanAdminContent -Encoding ASCII

Write-Host "[ok] admin.py başarıyla sıfırlandı. Testler çalıştırılıyor." -ForegroundColor Green
Write-Host ""
Write-Host "--- TEST FLOWLARI ÇALIŞTIRILIYOR (admin.py SIFIRLANDI) ---" -ForegroundColor Yellow

# 3. Tarayıcıları kapat
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force

# 4. Tüm flow'ları çalıştır
$base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*" -BaseUrl $base

# 5. Özet raporunu oluştur
Write-Host ""
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"
[ok] rewrote: __make_baseline_admin_equipment_change.flow (FINAL STANDARD URL FIX)
[ok] rewrote: equipment_ui_create_validate.flow (FINAL STANDARD URL FIX)

>>> .\maintenance\admin.py sıfırlanıyor (Yönlendirme döngüsünü durdurmak için)...
[ok] admin.py başarıyla sıfırlandı. Testler çalıştırılıyor.

--- TEST FLOWLARI ÇALIŞTIRILIYOR (admin.py SIFIRLANDI) ---
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1


==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     Error: Page.goto: net::ERR_TOO_MANY_REDIRECTS at http://127.0.0.1:
8010/admin/mai...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     Error: Page.goto: net::ERR_TOO_MANY_REDIRECTS at http://127.0.0.1:8
010/admin/mai...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # ops/rebase_auto.ps1 (rebase -> merge fallback, editorless)
@'
param(
  [string]$Branch,
  [int]$PrNumber = 0
)

$ErrorActionPreference = 'Stop'

function Abort-StaleRebase {
  if (Test-Path ".git\rebase-apply" -or (Test-Path ".git\rebase-merge")) {
    git rebase --abort | Out-Null
  }
}

function Solve-Bumper {
  New-Item -ItemType Directory -Force ".github" | Out-Null
  "trigger $(Get-Date -Format s)" | Set-Content ".github\pr-bumper.md"
  git add ".github\pr-bumper.md" | Out-Null
}

# Branch boşsa PR'dan çöz, o da yoksa aktif dal
if (-not $Branch) {
  if ($PrNumber -gt 0) {
    $Branch = gh pr view $PrNumber --json headRefName --jq .headRefName
  }
  if (-not $Branch) {
    $Branch = (git rev-parse --abbrev-ref HEAD)
    if (-not $Branch -or $Branch -eq 'HEAD') {
      throw "Branch bulunamadı: -Branch ver ya da -PrNumber ile PR'dan çözelim."
    }
  }
}

function Rebase-Or-Merge([string]$branch) {
  git fetch origin    | Out-Null
  git checkout $branch| Out-Null

  # 1) REBASE dene (editor'suz)
  git -c core.editor=true -c sequence.editor=true rebase origin/main
  if ($LASTEXITCODE -eq 0) { return }

  Write-Warning "Rebase başarısız → rebase abort + MERGE fallback'a geçiyorum."
  git rebase --abort 2>$null | Out-Null

  # 2) MERGE (editor'suz, auto-msg)
  git merge --no-edit origin/main
  if ($LASTEXITCODE -ne 0) {
    # en sık çatışma: pr-bumper.md → üzerine yazıp ekle
    if (Test-Path ".github\pr-bumper.md") {
      Write-Host "[merge] bumper conflict → auto-fix" -ForegroundColor Yellow
      Solve-Bumper
      # başka dosya çatışması var mı?
      $confLeft = git ls-files -u
      if ($confLeft) {
        throw "Bumper dışı merge çatışmaları var; manuel müdahale gerekir."
      }
      git commit --no-edit
      if ($LASTEXITCODE -ne 0) { throw "Merge commit atılamadı." }
    } else {
      throw "Merge başarısız ve bumper bulunamadı; manuel çözüm gerek."
    }
  }

  return
}

function Auto-Merge-Pr([int]$pr) { if ($pr -gt 0) { gh pr merge $pr --squash --auto } }

Abort-StaleRebase
Rebase-Or-Merge $Branch
git push --force-with-lease origin $Branch
Auto-Merge-Pr $PrNumber

Write-Host "[done] $Branch güncellendi ve push edildi." -ForegroundColor Green
if ($PrNumber -gt 0) { Write-Host "[note] PR #$PrNumber auto-merge açık; koşullar tamamlanınca birleşir." -ForegroundColor Yellow }
'@ | Set-Content -Encoding UTF8 .\ops\rebase_auto.ps1
PS C:\dev\bakim_kalibrasyon>
(venv) .\ops\rebase_auto.ps1 -Branch "feat/auto-20250930-012453" -PrNumber 10
(venv) TerminatingError(Test-Path): "A parameter cannot be found that matches parameter name 'or'."
>> TerminatingError(Test-Path): "A parameter cannot be found that matches parameter name 'or'."
>> TerminatingError(Test-Path): "A parameter cannot be found that matches parameter name 'or'."
>> TerminatingError(Test-Path): "A parameter cannot be found that matches parameter name 'or'."
A parameter cannot be found that matches parameter name 'or'.
Test-Path : A parameter cannot be found that matches parameter name 'or'.
At C:\dev\bakim_kalibrasyon\ops\rebase_auto.ps1:9 char:37
+   if (Test-Path ".git\rebase-apply" -or (Test-Path ".git\rebase-merge ...
+                                     ~~~
    + CategoryInfo          : InvalidArgument: (:) [Test-Path], ParentContainsErrorRecordException
    + FullyQualifiedErrorId : NamedParameterNotFound,Microsoft.PowerShell.Commands.TestPathCommand

PS C:\dev\bakim_kalibrasyon>
(venv) .\ops\rebase_auto.ps1 -PrNumber 12 # Açık olan güncel bir PR numarasını kullanın
(venv) TerminatingError(Test-Path): "A parameter cannot be found that matches parameter name 'or'."
>> TerminatingError(Test-Path): "A parameter cannot be found that matches parameter name 'or'."
>> TerminatingError(Test-Path): "A parameter cannot be found that matches parameter name 'or'."
>> TerminatingError(Test-Path): "A parameter cannot be found that matches parameter name 'or'."
A parameter cannot be found that matches parameter name 'or'.
Test-Path : A parameter cannot be found that matches parameter name 'or'.
At C:\dev\bakim_kalibrasyon\ops\rebase_auto.ps1:9 char:37
+   if (Test-Path ".git\rebase-apply" -or (Test-Path ".git\rebase-merge ...
+                                     ~~~
    + CategoryInfo          : InvalidArgument: (:) [Test-Path], ParentContainsErrorRecordException
    + FullyQualifiedErrorId : NamedParameterNotFound,Microsoft.PowerShell.Commands.TestPathCommand

PS C:\dev\bakim_kalibrasyon>
(venv) gh pr list --state open
no open pull requests in koordinator-maker/bakim_kalibrasyon_rep
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) Write-Host ">>> Şüpheli URL Yapılandırma Kontrolü: maintenance/urls.py" -ForegroundColor Yellow

# Eğer varsa maintenance/urls.py dosyasının içeriğini göster
if (Test-Path ".\maintenance\urls.py") {
    Write-Host "--- maintenance\urls.py İçeriği ---" -ForegroundColor Cyan
    Get-Content ".\maintenance\urls.py" -Raw
} else {
    Write-Host ".\maintenance\urls.py dosyası bulunamadı. Lütfen ana projenin urls.py dosyasını kontrol edin." -ForegroundColor Red
    # Alternatif olarak ana proje urls.py dosyasını kontrol etmeye çalışın
    if (Test-Path ".\bakim_kalibrasyon\urls.py") {
        Write-Host "--- bakim_kalibrasyon\urls.py İçeriği ---" -ForegroundColor Cyan
        Get-Content ".\bakim_kalibrasyon\urls.py" -Raw
    }
}
>>> Şüpheli URL Yapılandırma Kontrolü: maintenance/urls.py
.\maintenance\urls.py dosyası bulunamadı. Lütfen ana projenin urls.py dosyasını kontrol edin.
PS C:\dev\bakim_kalibrasyon>
(venv) Write-Host ">>> Ana Proje URL Yapılandırması: bakim_kalibrasyon\urls.py" -ForegroundColor Yellow
Write-Host "--- bakim_kalibrasyon\urls.py İçeriği ---" -ForegroundColor Cyan
Get-Content ".\bakim_kalibrasyon\urls.py" -Raw
>>> Ana Proje URL Yapılandırması: bakim_kalibrasyon\urls.py
--- bakim_kalibrasyon\urls.py İçeriği ---
(venv) TerminatingError(Get-Content): "The running command stopped because the preference variable "ErrorActionPreference" or common parameter is set to Stop: Cannot find path 'C:\dev\bakim_kalibrasyon\bakim_kalibrasyon\urls.py' because it does not exist."
>> TerminatingError(Get-Content): "The running command stopped because the preference variable "ErrorActionPreference" or common parameter is set to Stop: Cannot find path 'C:\dev\bakim_kalibrasyon\bakim_kalibrasyon\urls.py' because it does not exist."
The running command stopped because the preference variable "ErrorActionPreference" or common parameter is set to Stop: Cannot find path 'C:\dev\bakim_kalibrasyon\bakim_kalibrasyon\urls.py' because it does not exist.
Get-Content : Cannot find path 'C:\dev\bakim_kalibrasyon\bakim_kalibrasyon\urls.py' because it does not exist.
At line:3 char:1
+ Get-Content ".\bakim_kalibrasyon\urls.py" -Raw
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (C:\dev\bakim_ka...brasyon\urls.py:String) [Get-Content], ItemNotFoundEx
   ception
    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.GetContentCommand

PS C:\dev\bakim_kalibrasyon>
(venv) cs
>> TerminatingError(): "The term 'cs' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again."
The term 'cs' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
cs : The term 'cs' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the
spelling of the name, or if a path was included, verify that the path is correct and try again.
At line:1 char:1
+ cs
+ ~~
    + CategoryInfo          : ObjectNotFound: (cs:String) [], ParentContainsErrorRecordException
    + FullyQualifiedErrorId : CommandNotFoundException

PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) Write-Host ">>> Ana Proje URL Yapılandırması: bakim_kalibrasyon\urls.py" -ForegroundColor Yellow
Write-Host "--- bakim_kalibrasyon\urls.py İçeriği ---" -ForegroundColor Cyan
Get-Content ".\bakim_kalibrasyon\urls.py" -Raw
>>> Ana Proje URL Yapılandırması: bakim_kalibrasyon\urls.py
--- bakim_kalibrasyon\urls.py İçeriği ---
(venv) TerminatingError(Get-Content): "The running command stopped because the preference variable "ErrorActionPreference" or common parameter is set to Stop: Cannot find path 'C:\dev\bakim_kalibrasyon\bakim_kalibrasyon\urls.py' because it does not exist."
>> TerminatingError(Get-Content): "The running command stopped because the preference variable "ErrorActionPreference" or common parameter is set to Stop: Cannot find path 'C:\dev\bakim_kalibrasyon\bakim_kalibrasyon\urls.py' because it does not exist."
The running command stopped because the preference variable "ErrorActionPreference" or common parameter is set to Stop: Cannot find path 'C:\dev\bakim_kalibrasyon\bakim_kalibrasyon\urls.py' because it does not exist.
Get-Content : Cannot find path 'C:\dev\bakim_kalibrasyon\bakim_kalibrasyon\urls.py' because it does not exist.
At line:3 char:1
+ Get-Content ".\bakim_kalibrasyon\urls.py" -Raw
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (C:\dev\bakim_ka...brasyon\urls.py:String) [Get-Content], ItemNotFoundEx
   ception
    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.GetContentCommand

PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) Write-Host ">>> Kök Dizin URL Yapılandırması: urls.py" -ForegroundColor Yellow
Write-Host "--- .\urls.py İçeriği ---" -ForegroundColor Cyan
Get-Content ".\urls.py" -Raw
>>> Kök Dizin URL Yapılandırması: urls.py
--- .\urls.py İçeriği ---
(venv) TerminatingError(Get-Content): "The running command stopped because the preference variable "ErrorActionPreference" or common parameter is set to Stop: Cannot find path 'C:\dev\bakim_kalibrasyon\urls.py' because it does not exist."
>> TerminatingError(Get-Content): "The running command stopped because the preference variable "ErrorActionPreference" or common parameter is set to Stop: Cannot find path 'C:\dev\bakim_kalibrasyon\urls.py' because it does not exist."
The running command stopped because the preference variable "ErrorActionPreference" or common parameter is set to Stop: Cannot find path 'C:\dev\bakim_kalibrasyon\urls.py' because it does not exist.
Get-Content : Cannot find path 'C:\dev\bakim_kalibrasyon\urls.py' because it does not exist.
At line:3 char:1
+ Get-Content ".\urls.py" -Raw
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (C:\dev\bakim_kalibrasyon\urls.py:String) [Get-Content], ItemNotFoundExc
   eption
    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.GetContentCommand

PS C:\dev\bakim_kalibrasyon>
(venv) # ====================================================================
# 1. KRİTİK ADIM: Özel Yönlendirme Middleware'ini Devre Dışı Bırakma
# README'de belirtilen core/mw_fix_equip_redirect.py dosyasını sıfırlar.
# ====================================================================

$MiddlewarePath = '.\core\mw_fix_equip_redirect.py'
Write-Host ">>> Middleware devre dışı bırakılıyor: $MiddlewarePath..." -ForegroundColor Red

# Dosyanın içeriğini boş bir Python sınıfı ile değiştirme
$CleanMiddleware = @'
# REV: 1.1 | Otokodlama Tarafından Devre Dışı Bırakıldı
# Yönlendirme döngüsüne neden olan özel Middleware.
class FixEquipRedirectMiddleware:
    """Artık kullanılmıyor. Yönlendirme döngüsünü kırmak için sıfırlandı."""
    def __init__(self, get_response):
        self.get_response = get_response

    def __call__(self, request):
        # Sadece cevabı olduğu gibi geri döndür
        response = self.get_response(request)
        return response
'@

if (Test-Path $MiddlewarePath) {
    Set-Content $MiddlewarePath -Value $CleanMiddleware -Encoding ASCII
    Write-Host "[ok] Middleware başarıyla sıfırlandı." -ForegroundColor Green
} else {
    Write-Host "[hata] Middleware dosyası ($MiddlewarePath) bulunamadı. Lütfen dosya yolunu kontrol edin." -ForegroundColor Red
}

Write-Host ""
Write-Host "--- TEST FLOWLARI SON KEZ ÇALIŞTIRILIYOR (Middleware ve admin.py TEMİZ) ---" -ForegroundColor Yellow

# 2. Tarayıcıları kapat
Get-Process -Name headless*,chrome,msedge -ErrorAction SilentlyContinue | Stop-Process -Force

# 3. Tüm flow'ları çalıştır
$base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change*" -BaseUrl $base
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "equipment_ui_create_validate*" -BaseUrl $base

# 4. Özet raporunu oluştur
Write-Host ""
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"
>>> Middleware devre dışı bırakılıyor: .\core\mw_fix_equip_redirect.py...
[ok] Middleware başarıyla sıfırlandı.

--- TEST FLOWLARI SON KEZ ÇALIŞTIRILIYOR (Middleware ve admin.py TEMİZ) ---
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out _otokodlama\out\__make_baseline_admin_equipment_change.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut _otokodlama\out\equipment_ui_create_validate.json
[PW-FLOW] FAILED
[guard] wrote: _otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=1


==================== PIPELINE ?ZET RAPORU ====================
Dosya                                       Sonu?    Detay
--------------------------------------------------------------
__make_baseline_admin_app_index.json        PASS
__make_baseline_admin_equipment_add.json    PASS
__make_baseline_admin_equipment_change.json  FAIL     Error: Page.goto: net::ERR_TOO_MANY_REDIRECTS at http://127.0.0.1:
8010/admin/mai...
_admin_home_fast_make_baseline.json         PASS
_calibration_ui_create_make_baseline.json   PASS
_calibration_ui_list_make_baseline.json     PASS
_equipment_ui_create_make_baseline.json     PASS
_equipment_ui_list_make_baseline.json       PASS
admin_home_fast_validate.json               PASS
calibration_ui_create_validate.json         PASS
calibration_ui_list_validate.json           PASS
debug_equipment_change.json                 FAIL     TargetClosedError: Page.goto: Target page, context or browser has b
een closed
equipment_ui_create.json                    PASS
equipment_ui_create_validate.json           FAIL     Error: Page.goto: net::ERR_TOO_MANY_REDIRECTS at http://127.0.0.1:8
010/admin/mai...
equipment_ui_e2e.json                       PASS
equipment_ui_list_validate.json             PASS
--------------------------------------------------------------
PASS: 13   FAIL: 3   ERROR: 0
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cs
>> TerminatingError(): "The term 'cs' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again."
The term 'cs' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
cs : The term 'cs' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the
spelling of the name, or if a path was included, verify that the path is correct and try again.
At line:1 char:1
+ cs
+ ~~
    + CategoryInfo          : ObjectNotFound: (cs:String) [], ParentContainsErrorRecordException
    + FullyQualifiedErrorId : CommandNotFoundException

PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) git log --since="2025-10-01 18:00" --date=local --oneline
d104e05 (HEAD -> main, tag: snap-2025-10-01_1943) auto: snapshot 2025-10-01_1943
a2c0a25 (tag: snap-2025-10-01_1913) auto: snapshot 2025-10-01_1913
e9a34f3 (tag: snap-2025-10-01_1843) auto: snapshot 2025-10-01_1843
265d5bf (tag: snap-2025-10-01_1813) auto: snapshot 2025-10-01_1813
PS C:\dev\bakim_kalibrasyon>
(venv) git log --since="2025-09-30 16:00" --date=local --oneline
d104e05 (HEAD -> main, tag: snap-2025-10-01_1943) auto: snapshot 2025-10-01_1943
a2c0a25 (tag: snap-2025-10-01_1913) auto: snapshot 2025-10-01_1913
e9a34f3 (tag: snap-2025-10-01_1843) auto: snapshot 2025-10-01_1843
265d5bf (tag: snap-2025-10-01_1813) auto: snapshot 2025-10-01_1813
db3d95f (tag: snap-2025-10-01_1343) auto: snapshot 2025-10-01_1343
b332215 (tag: snap-2025-10-01_1313) auto: snapshot 2025-10-01_1313
0969e9a (tag: snap-2025-10-01_1113) auto: snapshot 2025-10-01_1113
d0af60b (tag: snap-2025-10-01_0943) auto: snapshot 2025-10-01_0943
a70c5d5 (tag: snap-2025-10-01_0913) auto: snapshot 2025-10-01_0913
c788e1a (tag: snap-2025-10-01_0143) auto: snapshot 2025-10-01_0143
62c1e34 (tag: snap-2025-10-01_0113) auto: snapshot 2025-10-01_0113
46949d4 (tag: snap-2025-10-01_0043) auto: snapshot 2025-10-01_0043
b233843 (tag: snap-2025-10-01_0013) auto: snapshot 2025-10-01_0013
2b449b6 (tag: snap-2025-09-30_2343) auto: snapshot 2025-09-30_2343
9a285e4 (tag: snap-2025-09-30_2243) auto: snapshot 2025-09-30_2243
83bc7f2 (tag: snap-2025-09-30_2213) auto: snapshot 2025-09-30_2213
d49c753 (tag: snap-2025-09-30_2113) auto: snapshot 2025-09-30_2113
4b6f7fe (tag: snap-2025-09-30_1943) auto: snapshot 2025-09-30_1943
aa1f8bc (origin/main, origin/HEAD) ci: enable dispatch for PR Maintenance (#15)
55dc0f0 ci: auto-pr + pr-maintenance + cleanup workflows (#14)
PS C:\dev\bakim_kalibrasyon>
(venv) git log --since="2025-09-30 14:00" --date=local --oneline
d104e05 (HEAD -> main, tag: snap-2025-10-01_1943) auto: snapshot 2025-10-01_1943
a2c0a25 (tag: snap-2025-10-01_1913) auto: snapshot 2025-10-01_1913
e9a34f3 (tag: snap-2025-10-01_1843) auto: snapshot 2025-10-01_1843
265d5bf (tag: snap-2025-10-01_1813) auto: snapshot 2025-10-01_1813
db3d95f (tag: snap-2025-10-01_1343) auto: snapshot 2025-10-01_1343
b332215 (tag: snap-2025-10-01_1313) auto: snapshot 2025-10-01_1313
0969e9a (tag: snap-2025-10-01_1113) auto: snapshot 2025-10-01_1113
d0af60b (tag: snap-2025-10-01_0943) auto: snapshot 2025-10-01_0943
a70c5d5 (tag: snap-2025-10-01_0913) auto: snapshot 2025-10-01_0913
c788e1a (tag: snap-2025-10-01_0143) auto: snapshot 2025-10-01_0143
62c1e34 (tag: snap-2025-10-01_0113) auto: snapshot 2025-10-01_0113
46949d4 (tag: snap-2025-10-01_0043) auto: snapshot 2025-10-01_0043
b233843 (tag: snap-2025-10-01_0013) auto: snapshot 2025-10-01_0013
2b449b6 (tag: snap-2025-09-30_2343) auto: snapshot 2025-09-30_2343
9a285e4 (tag: snap-2025-09-30_2243) auto: snapshot 2025-09-30_2243
83bc7f2 (tag: snap-2025-09-30_2213) auto: snapshot 2025-09-30_2213
d49c753 (tag: snap-2025-09-30_2113) auto: snapshot 2025-09-30_2113
4b6f7fe (tag: snap-2025-09-30_1943) auto: snapshot 2025-09-30_1943
aa1f8bc (origin/main, origin/HEAD) ci: enable dispatch for PR Maintenance (#15)
55dc0f0 ci: auto-pr + pr-maintenance + cleanup workflows (#14)
75c8fcd chore: pr-bumper refresh (auto) (#11)
ac91aa0 [auto] feat/auto-20250930-012453 (#10)
305cbef [auto] feat/auto-20250930-021727 (#13)
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) Write-Host ">>> KESİN GERİ DÖNÜŞ (ROLLBACK)..." -ForegroundColor Red
Write-Host "!!! DİKKAT: Tüm yerel değişiklikler kalıcı olarak silinecektir. !!!" -ForegroundColor Yellow

# Geri dönüşü gerçekleştir.
git reset --hard 4b6f7fe

Write-Host "[ok] Kod tabanı başarıyla snap-2025-09-30_1943 durumuna geri döndü." -ForegroundColor Green
>>> KESİN GERİ DÖNÜŞ (ROLLBACK)...
!!! DİKKAT: Tüm yerel değişiklikler kalıcı olarak silinecektir. !!!
Unlink of file 'todolist/tasks_template.csv' failed. Should I try again? (y/n) y
Updating files: 100% (127/127), done.
HEAD is now at 4b6f7fe auto: snapshot 2025-09-30_1943
[ok] Kod tabanı başarıyla snap-2025-09-30_1943 durumuna geri döndü.
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) Write-Host "--- TEST ORTAMI TEMİZLENİYOR ve FLOWLAR ÇALIŞTIRILIYOR ---" -ForegroundColor Yellow

# 1. Tarayıcıları zorla kapat
Get-Process -Name python, headless*,chrome,msedge,pw_flow -ErrorAction SilentlyContinue | Stop-Process -Force

# 2. Flow'ları yeniden oluştur (ops\gen_from_backlog.ps1)
powershell -ExecutionPolicy Bypass -File ops\gen_from_backlog.ps1

# 3. Tüm flow'ları çalıştır
$base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "*" -BaseUrl $base

# 4. Özet raporunu oluştur
Write-Host ""
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"
--- TEST ORTAMI TEMİZLENİYOR ve FLOWLAR ÇALIŞTIRILIYOR ---
[gen] Flow üretimi tamam
The argument 'ops\run_backlog_beep.ps1' to the -File parameter does not exist. Provide the path to an existing '.ps1' fi
le as an argument to the -File parameter.
Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

Try the new cross-platform PowerShell https://aka.ms/pscore6

The argument 'ops\report_console.ps1' to the -File parameter does not exist. Provide the path to an existing '.ps1' file
 as an argument to the -File parameter.
Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

Try the new cross-platform PowerShell https://aka.ms/pscore6
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # ====================================================================
# HELPER SCRIPTLERİ YENİDEN OLUŞTURMA
# ====================================================================

# ops\run_backlog_beep.ps1
@'
param(
  [string]$Filter = "*",
  [string]$BaseUrl = "http://127.0.0.1:8010",
  [string]$ExtraArgs = ""
)

$ErrorActionPreference = "Stop"
$flow_dir = ".\ops\flows"
$out_dir = ".\_otokodlama\out"
$files = Get-ChildItem -Path $flow_dir -Filter "$Filter.flow" -ErrorAction Stop

foreach ($file in $files) {
  $flow_file = $file.FullName
  $json_file = Join-Path $out_dir "$($file.BaseName).json"

  Write-Host "==> Running: $($file.Name)" -ForegroundColor Yellow

  # python tools\pw_flow.py --steps <flow_file> --out <json_file> ...
  $command = "python"
  $arguments = @("tools\pw_flow.py", "--steps", $flow_file, "--out", $json_file, "--base-url", $BaseUrl)

  if ($ExtraArgs) {
    $arguments += $ExtraArgs.Split(' ')
  }

  Write-Host "[run_and_guard] $($command) $($arguments -join ' ')"
  
  $process = Start-Process -FilePath $command -ArgumentList $arguments -Wait -PassThru -NoNewWindow
  $exitCode = $process.ExitCode
  
  Write-Host "[guard] wrote: $($json_file)" -ForegroundColor Magenta
  if ($exitCode -ne 0) {
    Write-Host "[err] $($file.Name) exit=$exitCode" -ForegroundColor Red
  }
}
'@ | Set-Content -Encoding UTF8 .\ops\run_backlog_beep.ps1

# ops\report_console.ps1
@'
param(
  [string]$OutDir = ".\_otokodlama\out"
)

$ErrorActionPreference = "Stop"

$files = Get-ChildItem -Path $OutDir -Filter "*.json" -ErrorAction Stop
Write-Host ""
Write-Host "==================== PIPELINE ÖZET RAPORU ====================" -ForegroundColor Cyan
Write-Host "Dosya                     Sonuç    Detay"
Write-Host "--------------------------------------------------------------"

$totalPass = 0
$totalFail = 0
$totalError = 0

foreach ($file in $files) {
    $content = Get-Content $file.FullName -Raw | ConvertFrom-Json -ErrorAction SilentlyContinue
    $result = ""
    $detail = ""

    if (-not $content) {
        $result = "ERROR"
        $detail = "JSON Parse Hatası"
        $totalError++
    }
    elseif ($content.status -eq "PASS") {
        $result = "PASS"
        $totalPass++
    }
    elseif ($content.status -eq "FAIL") {
        $result = "FAIL"
        $detail = $content.error -replace '\r?\n.*', '' # İlk satırı al
        $totalFail++
    }
    else {
        $result = "UNKNOW"
        $totalError++
    }

    "{0,-30} {1,-8} {2}" -f $file.Name, $result, $detail
}

Write-Host "--------------------------------------------------------------"
Write-Host "PASS: $totalPass    FAIL: $totalFail    ERROR: $totalError" -ForegroundColor Green
Write-Host "==============================================================" -ForegroundColor Cyan
'@ | Set-Content -Encoding UTF8 .\ops\report_console.ps1

Write-Host "[ok] Tüm PowerShell helper scriptleri yeniden oluşturuldu." -ForegroundColor Green
Write-Host ""
Write-Host "--- TEST FLOWLARI SON KEZ ÇALIŞTIRILIYOR ---" -ForegroundColor Yellow

# 1. Tarayıcıları zorla kapat
Get-Process -Name python, headless*,chrome,msedge,pw_flow -ErrorAction SilentlyContinue | Stop-Process -Force

# 2. Flow'ları yeniden oluştur (ops\gen_from_backlog.ps1)
powershell -ExecutionPolicy Bypass -File ops\gen_from_backlog.ps1

# 3. Tüm flow'ları çalıştır
$base="http://127.0.0.1:8010"
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "*" -BaseUrl $base

# 4. Özet raporunu oluştur
Write-Host ""
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"
[ok] Tüm PowerShell helper scriptleri yeniden oluşturuldu.

--- TEST FLOWLARI SON KEZ ÇALIŞTIRILIYOR ---
[gen] Flow üretimi tamam
==> Running: admin_app_index.validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\admin_app_index.validate.flow --out .
\_otokodlama\out\admin_app_index.validate.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\admin_app_index.validate.json
[err] admin_app_index.validate.flow exit=2
==> Running: admin_app_index_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\admin_app_index_validate.flow --out .
\_otokodlama\out\admin_app_index_validate.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\admin_app_index_validate.json
[err] admin_app_index_validate.flow exit=2
==> Running: admin_calibrations.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\admin_calibrations.flow --out .\_otok
odlama\out\admin_calibrations.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\admin_calibrations.json
[err] admin_calibrations.flow exit=2
==> Running: admin_checklists.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\admin_checklists.flow --out .\_otokod
lama\out\admin_checklists.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\admin_checklists.json
[err] admin_checklists.flow exit=2
==> Running: admin_equipment.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\admin_equipment.flow --out .\_otokodl
ama\out\admin_equipment.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\admin_equipment.json
[err] admin_equipment.flow exit=2
==> Running: admin_equipment_add.validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\admin_equipment_add.validate.flow --o
ut .\_otokodlama\out\admin_equipment_add.validate.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\admin_equipment_add.validate.json
[err] admin_equipment_add.validate.flow exit=2
==> Running: admin_equipment_add_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\admin_equipment_add_validate.flow --o
ut .\_otokodlama\out\admin_equipment_add_validate.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\admin_equipment_add_validate.json
[err] admin_equipment_add_validate.flow exit=2
==> Running: admin_equipment_change.validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\admin_equipment_change.validate.flow
--out .\_otokodlama\out\admin_equipment_change.validate.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\admin_equipment_change.validate.json
[err] admin_equipment_change.validate.flow exit=2
==> Running: admin_equipment_click_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\admin_equipment_click_validate.flow -
-out .\_otokodlama\out\admin_equipment_click_validate.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\admin_equipment_click_validate.json
[err] admin_equipment_click_validate.flow exit=2
==> Running: admin_equipment_delete_confirm.validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\admin_equipment_delete_confirm.valida
te.flow --out .\_otokodlama\out\admin_equipment_delete_confirm.validate.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\admin_equipment_delete_confirm.validate.json
[err] admin_equipment_delete_confirm.validate.flow exit=2
==> Running: admin_equipment_list.validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\admin_equipment_list.validate.flow --
out .\_otokodlama\out\admin_equipment_list.validate.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\admin_equipment_list.validate.json
[err] admin_equipment_list.validate.flow exit=2
==> Running: admin_equipment_list_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\admin_equipment_list_validate.flow --
out .\_otokodlama\out\admin_equipment_list_validate.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\admin_equipment_list_validate.json
[err] admin_equipment_list_validate.flow exit=2
==> Running: admin_equipment_list_validate_q.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\admin_equipment_list_validate_q.flow
--out .\_otokodlama\out\admin_equipment_list_validate_q.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\admin_equipment_list_validate_q.json
[err] admin_equipment_list_validate_q.flow exit=2
==> Running: admin_equipment_ui_create.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\admin_equipment_ui_create.flow --out
.\_otokodlama\out\admin_equipment_ui_create.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\admin_equipment_ui_create.json
[err] admin_equipment_ui_create.flow exit=2
==> Running: admin_equipment_ui_delete.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\admin_equipment_ui_delete.flow --out
.\_otokodlama\out\admin_equipment_ui_delete.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\admin_equipment_ui_delete.json
[err] admin_equipment_ui_delete.flow exit=2
==> Running: admin_equipment_ui_update.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\admin_equipment_ui_update.flow --out
.\_otokodlama\out\admin_equipment_ui_update.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\admin_equipment_ui_update.json
[err] admin_equipment_ui_update.flow exit=2
==> Running: admin_equipment_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\admin_equipment_validate.flow --out .
\_otokodlama\out\admin_equipment_validate.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\admin_equipment_validate.json
[err] admin_equipment_validate.flow exit=2
==> Running: admin_home.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\admin_home.flow --out .\_otokodlama\o
ut\admin_home.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\admin_home.json
[err] admin_home.flow exit=2
==> Running: admin_home_dom_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\admin_home_dom_validate.flow --out .\
_otokodlama\out\admin_home_dom_validate.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\admin_home_dom_validate.json
[err] admin_home_dom_validate.flow exit=2
==> Running: admin_home_fast_dom_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\admin_home_fast_dom_validate.flow --o
ut .\_otokodlama\out\admin_home_fast_dom_validate.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\admin_home_fast_dom_validate.json
[err] admin_home_fast_dom_validate.flow exit=2
==> Running: admin_home_fast_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\admin_home_fast_validate.flow --out .
\_otokodlama\out\admin_home_fast_validate.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\admin_home_fast_validate.json
[err] admin_home_fast_validate.flow exit=2
==> Running: admin_order_add.validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\admin_order_add.validate.flow --out .
\_otokodlama\out\admin_order_add.validate.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\admin_order_add.validate.json
[err] admin_order_add.validate.flow exit=2
==> Running: admin_order_add_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\admin_order_add_validate.flow --out .
\_otokodlama\out\admin_order_add_validate.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\admin_order_add_validate.json
[err] admin_order_add_validate.flow exit=2
==> Running: admin_plan.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\admin_plan.flow --out .\_otokodlama\o
ut\admin_plan.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\admin_plan.json
[err] admin_plan.flow exit=2
==> Running: calibration_home_dom_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\calibration_home_dom_validate.flow --
out .\_otokodlama\out\calibration_home_dom_validate.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\calibration_home_dom_validate.json
[err] calibration_home_dom_validate.flow exit=2
==> Running: calibration_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\calibration_ui_create_validate.flow -
-out .\_otokodlama\out\calibration_ui_create_validate.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\calibration_ui_create_validate.json
[err] calibration_ui_create_validate.flow exit=2
==> Running: calibration_ui_list.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\calibration_ui_list.flow --out .\_oto
kodlama\out\calibration_ui_list.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\calibration_ui_list.json
[err] calibration_ui_list.flow exit=2
==> Running: calibration_ui_list_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\calibration_ui_list_validate.flow --o
ut .\_otokodlama\out\calibration_ui_list_validate.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\calibration_ui_list_validate.json
[err] calibration_ui_list_validate.flow exit=2
==> Running: equipment_ui_create.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create.flow --out .\_oto
kodlama\out\equipment_ui_create.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\equipment_ui_create.json
[err] equipment_ui_create.flow exit=2
==> Running: equipment_ui_create_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_create_validate.flow --o
ut .\_otokodlama\out\equipment_ui_create_validate.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\equipment_ui_create_validate.json
[err] equipment_ui_create_validate.flow exit=2
==> Running: equipment_ui_delete.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_delete.flow --out .\_oto
kodlama\out\equipment_ui_delete.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\equipment_ui_delete.json
[err] equipment_ui_delete.flow exit=2
==> Running: equipment_ui_list_validate.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_list_validate.flow --out
 .\_otokodlama\out\equipment_ui_list_validate.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\equipment_ui_list_validate.json
[err] equipment_ui_list_validate.flow exit=2
==> Running: equipment_ui_update.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\equipment_ui_update.flow --out .\_oto
kodlama\out\equipment_ui_update.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\equipment_ui_update.json
[err] equipment_ui_update.flow exit=2
==> Running: login_smoke.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\login_smoke.flow --out .\_otokodlama\
out\login_smoke.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\login_smoke.json
[err] login_smoke.flow exit=2
==> Running: _admin_home_fast_make_baseline.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\_admin_home_fast_make_baseline.flow -
-out .\_otokodlama\out\_admin_home_fast_make_baseline.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\_admin_home_fast_make_baseline.json
[err] _admin_home_fast_make_baseline.flow exit=2
==> Running: _calibration_home_make_baseline.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\_calibration_home_make_baseline.flow
--out .\_otokodlama\out\_calibration_home_make_baseline.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\_calibration_home_make_baseline.json
[err] _calibration_home_make_baseline.flow exit=2
==> Running: _calibration_ui_create_make_baseline.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\_calibration_ui_create_make_baseline.
flow --out .\_otokodlama\out\_calibration_ui_create_make_baseline.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\_calibration_ui_create_make_baseline.json
[err] _calibration_ui_create_make_baseline.flow exit=2
==> Running: _calibration_ui_list_make_baseline.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\_calibration_ui_list_make_baseline.fl
ow --out .\_otokodlama\out\_calibration_ui_list_make_baseline.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\_calibration_ui_list_make_baseline.json
[err] _calibration_ui_list_make_baseline.flow exit=2
==> Running: _equipment_ui_create_make_baseline.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\_equipment_ui_create_make_baseline.fl
ow --out .\_otokodlama\out\_equipment_ui_create_make_baseline.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\_equipment_ui_create_make_baseline.json
[err] _equipment_ui_create_make_baseline.flow exit=2
==> Running: _equipment_ui_list_make_baseline.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\_equipment_ui_list_make_baseline.flow
 --out .\_otokodlama\out\_equipment_ui_list_make_baseline.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\_equipment_ui_list_make_baseline.json
[err] _equipment_ui_list_make_baseline.flow exit=2
==> Running: _make_baseline_admin.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\_make_baseline_admin.flow --out .\_ot
okodlama\out\_make_baseline_admin.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\_make_baseline_admin.json
[err] _make_baseline_admin.flow exit=2
==> Running: __make_baseline_admin_app_index.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_app_index.flow
--out .\_otokodlama\out\__make_baseline_admin_app_index.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\__make_baseline_admin_app_index.json
[err] __make_baseline_admin_app_index.flow exit=2
==> Running: __make_baseline_admin_equipment_add.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_add.f
low --out .\_otokodlama\out\__make_baseline_admin_equipment_add.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\__make_baseline_admin_equipment_add.json
[err] __make_baseline_admin_equipment_add.flow exit=2
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chang
e.flow --out .\_otokodlama\out\__make_baseline_admin_equipment_change.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=2
==> Running: __make_baseline_admin_equipment_delete_confirm.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_delet
e_confirm.flow --out .\_otokodlama\out\__make_baseline_admin_equipment_delete_confirm.json --base-url http://127.0.0.1:8
010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\__make_baseline_admin_equipment_delete_confirm.json
[err] __make_baseline_admin_equipment_delete_confirm.flow exit=2
==> Running: __make_baseline_admin_equipment_list.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_list.
flow --out .\_otokodlama\out\__make_baseline_admin_equipment_list.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\__make_baseline_admin_equipment_list.json
[err] __make_baseline_admin_equipment_list.flow exit=2
==> Running: __make_baseline_admin_order_add.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_order_add.flow
--out .\_otokodlama\out\__make_baseline_admin_order_add.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\__make_baseline_admin_order_add.json
[err] __make_baseline_admin_order_add.flow exit=2
==> Running: __make_baseline_app_index.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_app_index.flow --out
.\_otokodlama\out\__make_baseline_app_index.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\__make_baseline_app_index.json
[err] __make_baseline_app_index.flow exit=2
==> Running: __make_baseline_equipment_add.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_equipment_add.flow --
out .\_otokodlama\out\__make_baseline_equipment_add.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\__make_baseline_equipment_add.json
[err] __make_baseline_equipment_add.flow exit=2
==> Running: __make_baseline_equipment_add_dom.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_equipment_add_dom.flo
w --out .\_otokodlama\out\__make_baseline_equipment_add_dom.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\__make_baseline_equipment_add_dom.json
[err] __make_baseline_equipment_add_dom.flow exit=2
==> Running: __make_baseline_equipment_fix.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_equipment_fix.flow --
out .\_otokodlama\out\__make_baseline_equipment_fix.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\__make_baseline_equipment_fix.json
[err] __make_baseline_equipment_fix.flow exit=2
==> Running: __make_baseline_equipment_list.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_equipment_list.flow -
-out .\_otokodlama\out\__make_baseline_equipment_list.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\__make_baseline_equipment_list.json
[err] __make_baseline_equipment_list.flow exit=2
==> Running: __make_baseline_equipment_navto.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_equipment_navto.flow
--out .\_otokodlama\out\__make_baseline_equipment_navto.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\__make_baseline_equipment_navto.json
[err] __make_baseline_equipment_navto.flow exit=2
==> Running: __make_baseline_order_add.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_order_add.flow --out
.\_otokodlama\out\__make_baseline_order_add.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\__make_baseline_order_add.json
[err] __make_baseline_order_add.flow exit=2
==> Running: __repro_equipment.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__repro_equipment.flow --out .\_otoko
dlama\out\__repro_equipment.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\__repro_equipment.json
[err] __repro_equipment.flow exit=2
==> Running: __smoke_equipment_list.flow
[run_and_guard] python tools\pw_flow.py --steps C:\dev\bakim_kalibrasyon\ops\flows\__smoke_equipment_list.flow --out .\_
otokodlama\out\__smoke_equipment_list.json --base-url http://127.0.0.1:8010
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --base-url http://127.0.0.1:8010
[guard] wrote: .\_otokodlama\out\__smoke_equipment_list.json
[err] __smoke_equipment_list.flow exit=2


==================== PIPELINE ÖZET RAPORU ====================
Dosya                     Sonuç    Detay
--------------------------------------------------------------
admin_home_fast_validate.json  UNKNOW
calibration_ui_create_validate.json UNKNOW
calibration_ui_list_validate.json UNKNOW
debug_equipment_change.json    UNKNOW
equipment_ui_create.json       UNKNOW
equipment_ui_create_validate.json UNKNOW
equipment_ui_e2e.json          UNKNOW
equipment_ui_list_validate.json UNKNOW
_admin_home_fast_make_baseline.json UNKNOW
_calibration_ui_create_make_baseline.json UNKNOW
_calibration_ui_list_make_baseline.json UNKNOW
_equipment_ui_create_make_baseline.json UNKNOW
_equipment_ui_list_make_baseline.json UNKNOW
__make_baseline_admin_app_index.json UNKNOW
__make_baseline_admin_equipment_add.json UNKNOW
__make_baseline_admin_equipment_change.json UNKNOW
--------------------------------------------------------------
PASS: 0    FAIL: 0    ERROR: 16
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # ====================================================================
# TEST ÇALIŞTIRICIYI DÜZELTME (Eski pw_flow.py sürümüne uyum)
# ====================================================================

# ops\run_backlog_beep.ps1 içeriği güncelleniyor (BaseUrl argümanı kaldırıldı)
$CleanRunScript = @'
param(
  [string]$Filter = "*",
  [string]$ExtraArgs = ""
)

$ErrorActionPreference = "Stop"
$flow_dir = ".\ops\flows"
$out_dir = ".\_otokodlama\out"
$files = Get-ChildItem -Path $flow_dir -Filter "$Filter.flow" -ErrorAction Stop

foreach ($file in $files) {
  $flow_file = $file.FullName
  $json_file = Join-Path $out_dir "$($file.BaseName).json"

  Write-Host "==> Running: $($file.Name)" -ForegroundColor Yellow

  # Base URL argümanı artık gönderilmiyor. URL'ler flow dosyasının içinde olmalı.
  $command = "python"
  $arguments = @("tools\pw_flow.py", "--steps", $flow_file, "--out", $json_file)

  if ($ExtraArgs) {
    $arguments += $ExtraArgs.Split(' ')
  }

  Write-Host "[run_and_guard] $($command) $($arguments -join ' ')"

  $process = Start-Process -FilePath $command -ArgumentList $arguments -Wait -PassThru -NoNewWindow
  $exitCode = $process.ExitCode

  Write-Host "[guard] wrote: $($json_file)" -ForegroundColor Magenta
  if ($exitCode -ne 0) {
    Write-Host "[err] $($file.Name) exit=$exitCode" -ForegroundColor Red
  }
}
'@
Set-Content -Encoding UTF8 .\ops\run_backlog_beep.ps1

Write-Host "[ok] run_backlog_beep.ps1 başarıyla düzeltildi." -ForegroundColor Green
Write-Host ""
[ok] run_backlog_beep.ps1 başarıyla düzeltildi.

PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) Write-Host "--- TEST FLOWLARI SON KEZ ÇALIŞTIRILIYOR (DÜZELTİLMİŞ RUNNER) ---" -ForegroundColor Yellow

# 1. Tarayıcıları zorla kapat
Get-Process -Name python, headless*,chrome,msedge,pw_flow -ErrorAction SilentlyContinue | Stop-Process -Force

# 2. Flow'ları yeniden oluştur (URL'lerin flow dosyalarına doğru girdiğinden emin olmak için)
powershell -ExecutionPolicy Bypass -File ops\gen_from_backlog.ps1

# 3. Tüm flow'ları çalıştır
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "*"

# 4. Özet raporunu oluştur
Write-Host ""
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"
--- TEST FLOWLARI SON KEZ ÇALIŞTIRILIYOR (DÜZELTİLMİŞ RUNNER) ---
[gen] Flow üretimi tamam
1
1
2
3
4


==================== PIPELINE ÖZET RAPORU ====================
Dosya                     Sonuç    Detay
--------------------------------------------------------------
admin_home_fast_validate.json  UNKNOW
calibration_ui_create_validate.json UNKNOW
calibration_ui_list_validate.json UNKNOW
debug_equipment_change.json    UNKNOW
equipment_ui_create.json       UNKNOW
equipment_ui_create_validate.json UNKNOW
equipment_ui_e2e.json          UNKNOW
equipment_ui_list_validate.json UNKNOW
_admin_home_fast_make_baseline.json UNKNOW
_calibration_ui_create_make_baseline.json UNKNOW
_calibration_ui_list_make_baseline.json UNKNOW
_equipment_ui_create_make_baseline.json UNKNOW
_equipment_ui_list_make_baseline.json UNKNOW
__make_baseline_admin_app_index.json UNKNOW
__make_baseline_admin_equipment_add.json UNKNOW
__make_baseline_admin_equipment_change.json UNKNOW
--------------------------------------------------------------
PASS: 0    FAIL: 0    ERROR: 16
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # ====================================================================
# TEST ÇALIŞTIRICIYI DÜZELTME (Start-Process yerine Doğrudan Çağrı)
# ====================================================================

$FixRunnerScript = @'
param(
  [string]$Filter = "*",
  [string]$ExtraArgs = ""
)

$ErrorActionPreference = "Stop"
$flow_dir = ".\ops\flows"
$out_dir = ".\_otokodlama\out"

# Çıktı dizininin varlığını kontrol et
if (-not (Test-Path $out_dir)) {
    New-Item -ItemType Directory -Path $out_dir -Force | Out-Null
}

$files = Get-ChildItem -Path $flow_dir -Filter "$Filter.flow" -ErrorAction Stop

foreach ($file in $files) {
  $flow_file = $file.FullName
  $json_file = Join-Path $out_dir "$($file.BaseName).json"

  Write-Host "==> Running: $($file.Name)" -ForegroundColor Yellow

  # Base URL argümanı yok. Doğrudan Python çağrısı kullanıldı.
  $python_command = "python tools\pw_flow.py --steps '$flow_file' --out '$json_file'"

  if ($ExtraArgs) {
    $python_command += " $ExtraArgs"
  }

  Write-Host "[run_and_guard] $($python_command)"

  # Hata oluştuğunda PowerShell'in durmasını sağlamak için deneme
  try {
    # Doğrudan python çağrısı (PowerShell'in kendi process'i içinde)
    Invoke-Expression $python_command
    $exitCode = $LASTEXITCODE
  }
  catch {
    Write-Host "Python çağrısında hata: $_" -ForegroundColor Red
    $exitCode = 1
  }

  Write-Host "[guard] wrote: $($json_file)" -ForegroundColor Magenta
  if ($exitCode -ne 0) {
    Write-Host "[err] $($file.Name) exit=$exitCode" -ForegroundColor Red
  }
}
'@

Set-Content -Encoding UTF8 .\ops\run_backlog_beep.ps1 -Value $FixRunnerScript

Write-Host "[ok] run_backlog_beep.ps1 (doğrudan çağırma modu) başarıyla düzeltildi." -ForegroundColor Green
Write-Host ""
[ok] run_backlog_beep.ps1 (doğrudan çağırma modu) başarıyla düzeltildi.

PS C:\dev\bakim_kalibrasyon>
(venv) Write-Host "--- TEK KRİTİK TEST ÇALIŞTIRILIYOR (REDIRECT TESTİ) ---" -ForegroundColor Yellow

# 1. Tarayıcıları zorla kapat
Get-Process -Name python, headless*,chrome,msedge,pw_flow -ErrorAction SilentlyContinue | Stop-Process -Force

# 2. Kritik testi çalıştır
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change"

# 3. Özet raporunu oluştur (Sadece bu testin sonucu önemli)
Write-Host ""
powershell -ExecutionPolicy Bypass -File ops\report_console.ps1 -OutDir "_otokodlama\out"
--- TEK KRİTİK TEST ÇALIŞTIRILIYOR (REDIRECT TESTİ) ---
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps 'C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chan
ge.flow' --out '.\_otokodlama\out\__make_baseline_admin_equipment_change.json'
[PW-FLOW] FAILED
[guard] wrote: .\_otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1


==================== PIPELINE ÖZET RAPORU ====================
Dosya                     Sonuç    Detay
--------------------------------------------------------------
admin_home_fast_validate.json  UNKNOW
calibration_ui_create_validate.json UNKNOW
calibration_ui_list_validate.json UNKNOW
debug_equipment_change.json    UNKNOW
equipment_ui_create.json       UNKNOW
equipment_ui_create_validate.json UNKNOW
equipment_ui_e2e.json          UNKNOW
equipment_ui_list_validate.json UNKNOW
_admin_home_fast_make_baseline.json UNKNOW
_calibration_ui_create_make_baseline.json UNKNOW
_calibration_ui_list_make_baseline.json UNKNOW
_equipment_ui_create_make_baseline.json UNKNOW
_equipment_ui_list_make_baseline.json UNKNOW
__make_baseline_admin_app_index.json UNKNOW
__make_baseline_admin_equipment_add.json UNKNOW
__make_baseline_admin_equipment_change.json UNKNOW
--------------------------------------------------------------
PASS: 0    FAIL: 0    ERROR: 16
==============================================================
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) Write-Host ">>> TEK KRİTİK TEST (HEADFUL MODE - GÖRSEL ÇALIŞTIRILIYOR) <<<" -ForegroundColor Yellow

# Tarayıcıları kapatma adımını atlıyoruz.
# Get-Process -Name python, headless*,chrome,msedge,pw_flow -ErrorAction SilentlyContinue | Stop-Process -Force

# Kritik testi Headful modda çalıştır
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change" -ExtraArgs "--headful --timeout 20000"

Write-Host ""
Write-Host "!!! LÜTFEN EKRANINIZA BAKIN. TARAYICI NEREDE KALIYOR? !!!" -ForegroundColor Red
Write-Host ""

# Hata Detayını Çekme (JSON dosyasından)
Write-Host "--- HATANIN TAM DETAYI ---" -ForegroundColor Cyan
Get-Content ".\_otokodlama\out\__make_baseline_admin_equipment_change.json" -Raw | ConvertFrom-Json | Select-Object -ExpandProperty error
>>> TEK KRİTİK TEST (HEADFUL MODE - GÖRSEL ÇALIŞTIRILIYOR) <<<
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps 'C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chan
ge.flow' --out '.\_otokodlama\out\__make_baseline_admin_equipment_change.json' --headful --timeout 20000
usage: pw_flow.py [-h] --steps STEPS --out OUT [--headful] [--har HAR]
pw_flow.py: error: unrecognized arguments: --timeout 20000
[guard] wrote: .\_otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=2

!!! LÜTFEN EKRANINIZA BAKIN. TARAYICI NEREDE KALIYOR? !!!

--- HATANIN TAM DETAYI ---
(venv) TerminatingError(Select-Object): "The running command stopped because the preference variable "ErrorActionPreference" or common parameter is set to Stop: Property "error" cannot be found."
>> TerminatingError(Select-Object): "The running command stopped because the preference variable "ErrorActionPreference" or common parameter is set to Stop: Property "error" cannot be found."
The running command stopped because the preference variable "ErrorActionPreference" or common parameter is set to Stop: Property "error" cannot be found.
Select-Object : Property "error" cannot be found.
At line:15 char:103
+ ... e.json" -Raw | ConvertFrom-Json | Select-Object -ExpandProperty error
+                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (@{ok=False; results=System.Object[]}:PSObject) [Select-Object], PSArgu
   mentException
    + FullyQualifiedErrorId : ExpandPropertyNotFound,Microsoft.PowerShell.Commands.SelectObjectCommand

PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) # ====================================================================
# TEST ÇALIŞTIRICIYI DÜZELTME (SADECE --headful'a izin ver)
# ====================================================================

# run_backlog_beep.ps1'i tekrar güncelliyoruz. Sadece filtreleme yapıp --headful'u ExtraArgs ile geçeceğiz.

$MinimalRunnerScript = @'
param(
  [string]$Filter = "*",
  [string]$ExtraArgs = ""
)

$ErrorActionPreference = "Stop"
$flow_dir = ".\ops\flows"
$out_dir = ".\_otokodlama\out"

# Çıktı dizininin varlığını kontrol et
if (-not (Test-Path $out_dir)) {
    New-Item -ItemType Directory -Path $out_dir -Force | Out-Null
}

$files = Get-ChildItem -Path $flow_dir -Filter "$Filter.flow" -ErrorAction Stop

foreach ($file in $files) {
  $flow_file = $file.FullName
  $json_file = Join-Path $out_dir "$($file.BaseName).json"

  Write-Host "==> Running: $($file.Name)" -ForegroundColor Yellow

  # Sadece temel adımlar ve opsiyonel ExtraArgs. Timeout yok, BaseUrl yok.
  $python_command = "python tools\pw_flow.py --steps '$flow_file' --out '$json_file'"

  if ($ExtraArgs) {
    $python_command += " $ExtraArgs"
  }

  Write-Host "[run_and_guard] $($python_command)"

  try {
    # Doğrudan python çağrısı
    Invoke-Expression $python_command
    $exitCode = $LASTEXITCODE
  }
  catch {
    Write-Host "Python çağrısında hata: $_" -ForegroundColor Red
    $exitCode = 1
  }

  Write-Host "[guard] wrote: $($json_file)" -ForegroundColor Magenta
  if ($exitCode -ne 0) {
    Write-Host "[err] $($file.Name) exit=$exitCode" -ForegroundColor Red
  }
}
'@

Set-Content -Encoding UTF8 .\ops\run_backlog_beep.ps1 -Value $MinimalRunnerScript

Write-Host "[ok] run_backlog_beep.ps1 (minimal argümanlar) başarıyla düzeltildi." -ForegroundColor Green
Write-Host ""
[ok] run_backlog_beep.ps1 (minimal argümanlar) başarıyla düzeltildi.

PS C:\dev\bakim_kalibrasyon>
(venv) Write-Host "--- TEK KRİTİK TEST ÇALIŞTIRILIYOR (MİNİMAL ARGÜMANLAR) ---" -ForegroundColor Yellow

# Tarayıcıları kapatma adımını atlıyoruz.
# Get-Process -Name python, headless*,chrome,msedge,pw_flow -ErrorAction SilentlyContinue | Stop-Process -Force

# Kritik testi Headful modda çalıştır (Sadece --headful)
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change" -ExtraArgs "--headful"

Write-Host ""
Write-Host "!!! LÜTFEN EKRANINIZA BAKIN. TARAYICI NEREDE KALIYOR? !!!" -ForegroundColor Red
Write-Host ""
--- TEK KRİTİK TEST ÇALIŞTIRILIYOR (MİNİMAL ARGÜMANLAR) ---
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps 'C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chan
ge.flow' --out '.\_otokodlama\out\__make_baseline_admin_equipment_change.json' --headful
[PW-FLOW] FAILED
[guard] wrote: .\_otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1

!!! LÜTFEN EKRANINIZA BAKIN. TARAYICI NEREDE KALIYOR? !!!

PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) Write-Host "--- HATA DETAYINI ÇEKİYORUZ ---" -ForegroundColor Cyan
Write-Host "--------------------------------" -ForegroundColor Cyan

# JSON dosyasını okuyup hata metnini çekiyoruz
$JsonContent = Get-Content ".\_otokodlama\out\__make_baseline_admin_equipment_change.json" -Raw | ConvertFrom-Json -ErrorAction SilentlyContinue

if ($JsonContent -and $JsonContent.status -eq "FAIL") {
    Write-Host "TEST DURUMU: FAIL" -ForegroundColor Red
    Write-Host "HATA MESAJI:" -ForegroundColor Yellow
    $JsonContent.error | ForEach-Object { $_ }
} else {
    Write-Host "Hata mesajı çekilemedi veya JSON bozuk." -ForegroundColor Red
    Write-Host "JSON dosyası içeriği (İlk 1000 karakter):" -ForegroundColor Magenta
    (Get-Content ".\_otokodlama\out\__make_baseline_admin_equipment_change.json" -TotalCount 1 | Out-String).Substring(0, [System.Math]::Min(1000, (Get-Content ".\_otokodlama\out\__make_baseline_admin_equipment_change.json" -TotalCount 1 | Out-String).Length))
}
--- HATA DETAYINI ÇEKİYORUZ ---
--------------------------------
Hata mesajı çekilemedi veya JSON bozuk.
JSON dosyası içeriği (İlk 1000 karakter):
{
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) Write-Host "--- TEK KRİTİK TEST ÇALIŞTIRILIYOR (GÜVENİLİR HATA YAKALAMA MODU) ---" -ForegroundColor Yellow

# Kritik testi Headful modda çalıştır (Tarayıcı açılıp hemen kapanabilir)
powershell -ExecutionPolicy Bypass -File ops\run_backlog_beep.ps1 -Filter "__make_baseline_admin_equipment_change" -ExtraArgs "--headful"

Write-Host ""
Write-Host "!!! SONUÇ JSON DOSYASINDAN OKUNUYOR !!!" -ForegroundColor Red
Write-Host ""

# Hata Detayını Çekme (JSON dosyasından)
Write-Host "--- ÇEKİLEN HATA DETAYI ---" -ForegroundColor Cyan
Write-Host "---------------------------" -ForegroundColor Cyan
try {
    $JsonPath = ".\_otokodlama\out\__make_baseline_admin_equipment_change.json"
    $JsonContent = Get-Content $JsonPath -Raw | ConvertFrom-Json -ErrorAction Stop

    if ($JsonContent.status -eq "FAIL") {
        Write-Host "TEST DURUMU: FAIL" -ForegroundColor Red
        Write-Host "HATA MESAJI (JSON'DAN):" -ForegroundColor Yellow
        # Hata mesajı birden fazla satır olabilir
        $JsonContent.error | ForEach-Object { $_ }
    } else {
        Write-Host "TEST DURUMU: PASS" -ForegroundColor Green
    }
}
catch {
    Write-Host "JSON Okuma Başarısız: $_" -ForegroundColor Red
}
--- TEK KRİTİK TEST ÇALIŞTIRILIYOR (GÜVENİLİR HATA YAKALAMA MODU) ---
==> Running: __make_baseline_admin_equipment_change.flow
[run_and_guard] python tools\pw_flow.py --steps 'C:\dev\bakim_kalibrasyon\ops\flows\__make_baseline_admin_equipment_chan
ge.flow' --out '.\_otokodlama\out\__make_baseline_admin_equipment_change.json' --headful
[PW-FLOW] FAILED
[guard] wrote: .\_otokodlama\out\__make_baseline_admin_equipment_change.json
[err] __make_baseline_admin_equipment_change.flow exit=1

!!! SONUÇ JSON DOSYASINDAN OKUNUYOR !!!

--- ÇEKİLEN HATA DETAYI ---
---------------------------
TEST DURUMU: PASS
PS C:\dev\bakim_kalibrasyon>
(venv) cls
PS C:\dev\bakim_kalibrasyon>
(venv) Write-Host "--- TEKRAR DENEME: JSON DOSYASI HAM İÇERİĞİ ---" -ForegroundColor Cyan
Write-Host "------------------------------------------------" -ForegroundColor Cyan

# JSON dosyasını oku ve tüm içeriği ekrana bas (PowerShell ayrıştırmasını atla)
Get-Content ".\_otokodlama\out\__make_baseline_admin_equipment_change.json" -Raw -ErrorAction Stop
--- TEKRAR DENEME: JSON DOSYASI HAM İÇERİĞİ ---
------------------------------------------------
{
  "ok": false,
  "results": [
    {
      "i": 1,
      "cmd": "GOTO",
      "arg": "/admin/login/",
      "ok": false,
      "error": "Error: Page.goto: net::ERR_CONNECTION_REFUSED at http://127.0.0.1:8010/admin/login/\nCall log:\n  - navigating to \"http://127.0.0.1:8010/admin/login/\", waiting until \"domcontentloaded\"\n",
      "url": "about:blank"
    }
  ]
}
PS C:\dev\bakim_kalibrasyon>
